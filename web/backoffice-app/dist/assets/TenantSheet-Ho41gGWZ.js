import{r as o,j as e,X as G,N as u,R as J,w as K,x as Q,B as A,C as W}from"./index-CfoPWh9S.js";import{R as Y,P as Z,C as k,f as _,g as E,h as T,O as D}from"./dialog-C06rURw4.js";import{I as h,S as R,a as I,b as P,d as F,e as f,C as U}from"./badge-BAzsu3vk.js";import{a as j}from"./client-D6wYOnK2.js";const ee=Y,se=Z,H=o.forwardRef(({className:i,...n},m)=>e.jsx(D,{className:u("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",i),...n,ref:m}));H.displayName=D.displayName;const ae=J("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-md"}},defaultVariants:{side:"right"}}),L=o.forwardRef(({side:i="right",className:n,children:m,...d},s)=>e.jsxs(se,{children:[e.jsx(H,{}),e.jsxs(k,{ref:s,className:u(ae({side:i}),n),...d,children:[e.jsxs(_,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),m]})]}));L.displayName=k.displayName;const V=({className:i,...n})=>e.jsx("div",{className:u("flex flex-col space-y-2 text-center sm:text-left",i),...n});V.displayName="SheetHeader";const z=({className:i,...n})=>e.jsx("div",{className:u("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",i),...n});z.displayName="SheetFooter";const B=o.forwardRef(({className:i,...n},m)=>e.jsx(E,{ref:m,className:u("text-lg font-semibold text-foreground",i),...n}));B.displayName=E.displayName;const q=o.forwardRef(({className:i,...n},m)=>e.jsx(T,{ref:m,className:u("text-sm text-muted-foreground",i),...n}));q.displayName=T.displayName;function de({open:i,onOpenChange:n,onSuccess:m,tenant:d}){const{t:s}=K("tenants"),[r,v]=o.useState(!1),[b,g]=o.useState(null),[p,N]=o.useState([]),[$,M]=o.useState(!0),[l,c]=o.useState({name:"",slug:"",domain:"",planId:"",isActive:!0,maxUsers:10,allowRegistration:!0,enableApi:!1}),x=!!d;o.useEffect(()=>{async function a(){try{const t=await j.get("/admin/plans");N(t)}catch(t){console.error("Failed to load plans:",t),N([{id:"free",name:"Free",slug:"free"},{id:"starter",name:"Starter",slug:"starter"},{id:"pro",name:"Pro",slug:"pro"},{id:"enterprise",name:"Enterprise",slug:"enterprise"}])}finally{M(!1)}}i&&a()},[i]),o.useEffect(()=>{var a,t,w,S,C;i&&d?c({name:d.name,slug:d.slug,domain:d.domain||"",planId:((a=d.plan)==null?void 0:a.id)||"",isActive:d.isActive,maxUsers:((t=d.settings)==null?void 0:t.maxUsers)||10,allowRegistration:((w=d.settings)==null?void 0:w.allowRegistration)??!0,enableApi:((S=d.settings)==null?void 0:S.enableApi)??!1}):i&&c({name:"",slug:"",domain:"",planId:((C=p[0])==null?void 0:C.id)||"",isActive:!0,maxUsers:10,allowRegistration:!0,enableApi:!1}),g(null)},[i,d,p]);const y=a=>a.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),O=a=>{c(t=>({...t,name:a,slug:!x&&t.slug===y(t.name)?y(a):t.slug}))},X=async a=>{a.preventDefault(),g(null),v(!0);try{const t={name:l.name,slug:l.slug,domain:l.domain||void 0,planId:l.planId||void 0,isActive:l.isActive,settings:{maxUsers:l.maxUsers,allowRegistration:l.allowRegistration,enableApi:l.enableApi}};x&&d?await j.patch(`/admin/tenants/${d.id}`,t):await j.post("/admin/tenants",t),m(),n(!1)}catch(t){g(t instanceof Error?t.message:"An error occurred")}finally{v(!1)}};return e.jsx(ee,{open:i,onOpenChange:n,children:e.jsxs(L,{className:"sm:max-w-lg overflow-y-auto",children:[e.jsx(V,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10",children:e.jsx(Q,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx(B,{children:s(x?"sheet.editTitle":"sheet.createTitle")}),e.jsx(q,{children:s(x?"sheet.editDescription":"sheet.createDescription")})]})]})}),e.jsxs("form",{onSubmit:X,className:"mt-6 space-y-6",children:[b&&e.jsx("div",{className:"rounded-md bg-destructive/10 p-3 text-sm text-destructive",children:b}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:s("sheet.basicInfo")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"name",className:"text-sm font-medium",children:[s("fields.name")," *"]}),e.jsx(h,{id:"name",value:l.name,onChange:a=>O(a.target.value),placeholder:s("fields.namePlaceholder"),required:!0,disabled:r})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"slug",className:"text-sm font-medium",children:[s("fields.slug")," *"]}),e.jsx(h,{id:"slug",value:l.slug,onChange:a=>c(t=>({...t,slug:a.target.value})),placeholder:s("fields.slugPlaceholder"),required:!0,disabled:r||x}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("fields.slugHint")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"domain",className:"text-sm font-medium",children:s("fields.domain")}),e.jsx(h,{id:"domain",value:l.domain,onChange:a=>c(t=>({...t,domain:a.target.value})),placeholder:s("fields.domainPlaceholder"),disabled:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("fields.domainHint")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:s("sheet.subscription")}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"plan",className:"text-sm font-medium",children:s("fields.plan")}),e.jsxs(R,{value:l.planId,onValueChange:a=>c(t=>({...t,planId:a})),disabled:r||$,children:[e.jsx(I,{children:e.jsx(P,{placeholder:s("fields.planPlaceholder")})}),e.jsxs(F,{children:[e.jsx(f,{value:"",children:s("fields.noPlan")}),p.map(a=>e.jsx(f,{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:s("fields.status")}),e.jsxs(R,{value:l.isActive?"active":"inactive",onValueChange:a=>c(t=>({...t,isActive:a==="active"})),disabled:r,children:[e.jsx(I,{children:e.jsx(P,{})}),e.jsxs(F,{children:[e.jsx(f,{value:"active",children:s("status.active")}),e.jsx(f,{value:"inactive",children:s("status.inactive")})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:s("sheet.settings")}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx(U,{checked:l.allowRegistration,onCheckedChange:a=>c(t=>({...t,allowRegistration:!!a})),disabled:r}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s("settings.allowRegistration")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("settings.allowRegistrationHint")})]})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx(U,{checked:l.enableApi,onCheckedChange:a=>c(t=>({...t,enableApi:!!a})),disabled:r}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:s("settings.enableApi")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("settings.enableApiHint")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"maxUsers",className:"text-sm font-medium",children:s("settings.maxUsers")}),e.jsx(h,{id:"maxUsers",type:"number",min:1,max:1e4,value:l.maxUsers,onChange:a=>c(t=>({...t,maxUsers:parseInt(a.target.value,10)||10})),disabled:r})]})]}),e.jsxs(z,{className:"pt-4",children:[e.jsx(A,{type:"button",variant:"outline",onClick:()=>n(!1),disabled:r,children:s("actions.cancel")}),e.jsx(A,{type:"submit",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"me-2 h-4 w-4 animate-spin"}),s(x?"actions.saving":"actions.creating")]}):s(x?"actions.save":"actions.create")})]})]})]})})}export{de as T};
//# sourceMappingURL=TenantSheet-Ho41gGWZ.js.map
