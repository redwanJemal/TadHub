import{c as z,s as j,t as N,r as t,j as e,S as U,B as x,A as M,h as E,i as F}from"./index-DHujyevu.js";import{u as ee,a as C,I as L,S as se}from"./skeleton-Cykrd9Vb.js";import{S as re,T as ae,a as ne,b as R,c as d,d as ie,e as c,B as q,D as te,f as le,E as de,g as ce,h as f,i as oe,A as me,j as ue,k as xe,l as he,m as je,n as pe,o as ge,p as ve}from"./alert-dialog-CJk1K280.js";import{D as P,a as I,b as Q,c as H,d as fe,e as Ae}from"./dialog-CFYWBCGn.js";import{C as A,a as ye,c as Ne,b as y}from"./card-WDYENHZD.js";import{C as Ce}from"./checkbox-OxaHLpGK.js";import{L as B}from"./label-D0Jg16Q3.js";import{E as Se}from"./eye-KHjMckgF.js";import{T as be}from"./trash-2-CmWGCf1K.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=z("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=z("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);async function De(r){return j.get("/admin/users",r)}async function ke(r){return j.post("/admin/users",r)}async function Te(r,n){return j.patch(`/admin/users/${r}`,n)}async function Ue(r){return j.delete(`/admin/users/${r}`)}const p="admin-users";function Me(r){return ee({queryKey:[p,r],queryFn:()=>De(r)})}function Ee(){const r=N();return C({mutationFn:n=>ke(n),onSuccess:()=>{r.invalidateQueries({queryKey:[p]})}})}function Fe(){const r=N();return C({mutationFn:({id:n,data:i})=>Te(n,i),onSuccess:()=>{r.invalidateQueries({queryKey:[p]})}})}function Le(){const r=N();return C({mutationFn:n=>Ue(n),onSuccess:()=>{r.invalidateQueries({queryKey:[p]})}})}function O(r,n){const i=(r==null?void 0:r[0])||"",l=(n==null?void 0:n[0])||"";return(i+l).toUpperCase()||"?"}function h(r){return r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}function ze(){const[r,n]=t.useState(""),[i,l]=t.useState(null),[a,S]=t.useState(null),[V,o]=t.useState(!1),[m,b]=t.useState(""),[w,D]=t.useState(!1),[k,T]=t.useState(null),{data:Y,isLoading:_,error:$}=Me({q:r||void 0}),g=Ee(),G=Fe(),J=Le(),W=async()=>{if(i)try{await J.mutateAsync(i.id),l(null)}catch(s){console.error("Failed to remove admin:",s)}},X=async s=>{try{await G.mutateAsync({id:s.id,data:{isSuperAdmin:!s.isSuperAdmin}})}catch(v){console.error("Failed to update admin:",v)}},Z=async()=>{if(m.trim()){T(null);try{await g.mutateAsync({email:m.trim(),isSuperAdmin:w}),o(!1),b(""),D(!1)}catch(s){T(s.message||"Failed to add admin")}}},u=Y||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(U,{className:"h-6 w-6"}),"Platform Team"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users who have access to this admin panel."})]}),e.jsxs(A,{children:[e.jsx(ye,{className:"pb-2",children:e.jsx(Ne,{className:"text-sm font-medium text-muted-foreground",children:"Team Members"})}),e.jsx(y,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl font-bold",children:u.length}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[u.filter(s=>s.isSuperAdmin).length," super admins"]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-80",children:[e.jsx(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(L,{placeholder:"Search by name or email...",value:r,onChange:s=>n(s.target.value),className:"pl-10"})]}),e.jsxs(x,{onClick:()=>o(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Add Admin"]})]}),_?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,v)=>e.jsx(se,{className:"h-16 w-full"},v))}):$?e.jsx(A,{children:e.jsx(y,{className:"py-10 text-center text-muted-foreground",children:"Failed to load platform team members. Please try again."})}):u.length===0?e.jsx(A,{children:e.jsx(y,{className:"py-10 text-center text-muted-foreground",children:r?"No admins match your search.":"No platform admins yet."})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs(R,{children:[e.jsx(d,{children:"User"}),e.jsx(d,{children:"Role"}),e.jsx(d,{children:"Last Login"}),e.jsx(d,{children:"Added"}),e.jsx(d,{className:"w-[70px]"})]})}),e.jsx(ie,{children:u.map(s=>e.jsxs(R,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(M,{className:"h-9 w-9",children:[e.jsx(E,{src:s.user.avatarUrl}),e.jsx(F,{className:"bg-primary/10 text-primary",children:O(s.user.firstName,s.user.lastName)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.user.email})]})]})}),e.jsx(c,{children:s.isSuperAdmin?e.jsxs(q,{className:"bg-amber-500 hover:bg-amber-600",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Super Admin"]}):e.jsxs(q,{variant:"secondary",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"Admin"]})}),e.jsx(c,{className:"text-muted-foreground",children:h(s.user.lastLoginAt)}),e.jsx(c,{className:"text-muted-foreground",children:h(s.createdAt)}),e.jsx(c,{children:e.jsxs(te,{children:[e.jsx(le,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx(de,{className:"h-4 w-4"})})}),e.jsxs(ce,{align:"end",children:[e.jsxs(f,{onClick:()=>S(s),children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(f,{onClick:()=>X(s),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),s.isSuperAdmin?"Remove Super Admin":"Make Super Admin"]}),e.jsx(oe,{}),e.jsxs(f,{className:"text-destructive",onClick:()=>l(s),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Remove Admin"]})]})]})})]},s.id))})]})}),e.jsx(P,{open:V,onOpenChange:o,children:e.jsxs(I,{children:[e.jsxs(Q,{children:[e.jsx(H,{children:"Add Platform Admin"}),e.jsx(fe,{children:"Add an existing user as a platform admin. The user must have logged in at least once."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[k&&e.jsx("div",{className:"text-sm text-destructive bg-destructive/10 p-3 rounded-md",children:k}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"email",children:"Email Address"}),e.jsx(L,{id:"email",type:"email",placeholder:"user@example.com",value:m,onChange:s=>b(s.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ce,{id:"superAdmin",checked:w,onCheckedChange:s=>D(s===!0)}),e.jsx(B,{htmlFor:"superAdmin",className:"cursor-pointer",children:"Grant super admin privileges"})]})]}),e.jsxs(Ae,{children:[e.jsx(x,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(x,{onClick:Z,disabled:!m.trim()||g.isPending,children:g.isPending?"Adding...":"Add Admin"})]})]})}),e.jsx(me,{open:!!i,onOpenChange:()=>l(null),children:e.jsxs(ue,{children:[e.jsxs(xe,{children:[e.jsx(he,{children:"Remove Admin Access"}),e.jsxs(je,{children:["Are you sure you want to remove admin access from"," ",e.jsxs("strong",{children:[i==null?void 0:i.user.firstName," ",i==null?void 0:i.user.lastName]}),"? They will no longer be able to access this admin panel."]})]}),e.jsxs(pe,{children:[e.jsx(ge,{children:"Cancel"}),e.jsx(ve,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remove Admin"})]})]})}),e.jsx(P,{open:!!a,onOpenChange:()=>S(null),children:e.jsxs(I,{children:[e.jsx(Q,{children:e.jsx(H,{children:"Admin Details"})}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(M,{className:"h-16 w-16",children:[e.jsx(E,{src:a.user.avatarUrl}),e.jsx(F,{className:"bg-primary/10 text-primary text-xl",children:O(a.user.firstName,a.user.lastName)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold",children:[a.user.firstName," ",a.user.lastName]}),e.jsx("div",{className:"text-muted-foreground",children:a.user.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Role"}),e.jsx("div",{children:a.isSuperAdmin?"Super Admin":"Admin"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{children:a.user.isActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Phone"}),e.jsx("div",{children:a.user.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Locale"}),e.jsx("div",{children:a.user.locale||"en"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Last Login"}),e.jsx("div",{children:h(a.user.lastLoginAt)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Admin Since"}),e.jsx("div",{children:h(a.createdAt)})]})]})]})]})})]})}export{ze as PlatformTeamPage};
//# sourceMappingURL=PlatformTeamPage-D5Sg9p7T.js.map
