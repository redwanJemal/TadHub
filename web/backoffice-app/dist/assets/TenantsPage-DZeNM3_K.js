import{w as J,u as K,r as a,j as t,x as Q,B as l,C as U}from"./index-CfoPWh9S.js";import{B as C}from"./badge-BAzsu3vk.js";import{D as X}from"./DataTableAdvanced-tUYlkAy3.js";import{S as Y,T as Z,D as _,a as ee,b as te,c as se,d as ae,e as ne}from"./dialog-C06rURw4.js";import{T as le}from"./TenantSheet-Ho41gGWZ.js";import{a as D}from"./client-D6wYOnK2.js";import{E as ie}from"./eye-D2jw_eyj.js";import{P as ce}from"./plus-DWiWKduL.js";function fe(){const{t:s}=J("tenants"),y=K(),[N,P]=a.useState([]),[k,f]=a.useState(!0),[i,T]=a.useState(""),[r,b]=a.useState(),[m,d]=a.useState(1),[h,w]=a.useState(20),[E,F]=a.useState(0),[A,O]=a.useState(1),[B,I]=a.useState([]),[L,x]=a.useState(!1),[z,p]=a.useState(null),[q,u]=a.useState(!1),[c,j]=a.useState(null),[g,v]=a.useState(!1),o=a.useCallback(async()=>{f(!0);try{const e={page:String(m),perPage:String(h)};i&&(e.q=i),r&&(e.status=r);const n=await D.getWithMeta("/admin/tenants",e);P(n.data),n.meta&&(F(n.meta.total??0),O(n.meta.totalPages??1))}catch(e){console.error("Failed to fetch tenants:",e)}finally{f(!1)}},[m,h,i,r]);a.useEffect(()=>{o()},[o]),a.useEffect(()=>{const e=setTimeout(()=>{d(1)},300);return()=>clearTimeout(e)},[i]);const S=e=>{y(`/tenants/${e.id}`)},R=e=>{p(e),x(!0)},V=()=>{p(null),x(!0)},$=e=>{j(e),u(!0)},H=async()=>{if(c){v(!0);try{await D.delete(`/admin/tenants/${c.id}`),o(),u(!1),j(null)}catch(e){console.error("Failed to delete tenant:",e)}finally{v(!1)}}},M=[{key:"name",header:s("columns.name"),cell:e=>t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10",children:t.jsx(Q,{className:"h-4 w-4 text-primary"})}),t.jsxs("div",{children:[t.jsx("button",{onClick:()=>S(e),className:"font-medium hover:text-primary hover:underline text-left",children:e.name}),t.jsx("p",{className:"text-xs text-muted-foreground",children:e.slug})]})]})},{key:"domain",header:s("columns.domain"),cell:e=>e.domain||"-"},{key:"plan",header:s("columns.plan"),cell:e=>{var n;return t.jsx(C,{variant:e.plan?"default":"outline",children:((n=e.plan)==null?void 0:n.name)||s("noPlan")})}},{key:"usersCount",header:s("columns.users"),cell:e=>e.usersCount,className:"text-center"},{key:"isActive",header:s("columns.status"),cell:e=>t.jsx(C,{variant:e.isActive?"success":"secondary",children:e.isActive?s("status.active"):s("status.inactive")})},{key:"createdAt",header:s("columns.createdAt"),cell:e=>new Date(e.createdAt).toLocaleDateString()},{key:"actions",header:s("columns.actions"),cell:e=>t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(l,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>S(e),title:s("actions.view"),children:t.jsx(ie,{className:"h-4 w-4"})}),t.jsx(l,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>R(e),title:s("actions.edit"),children:t.jsx(Y,{className:"h-4 w-4"})}),t.jsx(l,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>$(e),title:s("actions.delete"),children:t.jsx(Z,{className:"h-4 w-4"})})]}),className:"w-[100px]"}],W=[{key:"status",label:s("filters.status"),value:r,options:[{label:s("status.active"),value:"active"},{label:s("status.inactive"),value:"inactive"}]}],G=(e,n)=>{e==="status"&&(b(n),d(1))};return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold md:text-3xl",children:s("title")}),t.jsx("p",{className:"text-muted-foreground",children:s("subtitle")})]})}),t.jsx(X,{columns:M,data:N,isLoading:k,searchValue:i,onSearchChange:T,searchPlaceholder:s("searchPlaceholder"),filters:W,onFilterChange:G,page:m,totalPages:A,total:E,perPage:h,onPageChange:d,onPerPageChange:e=>{w(e),d(1)},selectable:!0,selectedIds:B,onSelectionChange:I,onRefresh:o,actions:t.jsxs(l,{onClick:V,children:[t.jsx(ce,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline ms-2",children:s("addTenant")})]})}),t.jsx(le,{open:L,onOpenChange:x,onSuccess:o,tenant:z}),t.jsx(_,{open:q,onOpenChange:u,children:t.jsxs(ee,{children:[t.jsxs(te,{children:[t.jsx(se,{children:s("deleteDialog.title")}),t.jsx(ae,{children:s("deleteDialog.description",{name:c==null?void 0:c.name})})]}),t.jsxs(ne,{children:[t.jsx(l,{variant:"outline",onClick:()=>u(!1),disabled:g,children:s("actions.cancel")}),t.jsx(l,{variant:"destructive",onClick:H,disabled:g,children:g?t.jsxs(t.Fragment,{children:[t.jsx(U,{className:"me-2 h-4 w-4 animate-spin"}),s("actions.deleting")]}):s("actions.delete")})]})]})})]})}export{fe as TenantsPage};
//# sourceMappingURL=TenantsPage-DZeNM3_K.js.map
