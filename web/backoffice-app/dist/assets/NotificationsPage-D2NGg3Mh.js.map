{"version":3,"file":"NotificationsPage-D2NGg3Mh.js","sources":["../../src/features/notifications/pages/NotificationsPage.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Bell, Send, Info, AlertTriangle, CheckCircle, XCircle } from 'lucide-react';\nimport { useTranslation } from 'react-i18next';\nimport { useAdminNotifications } from '../hooks';\nimport { useTenants } from '@/features/tenants/hooks';\nimport { Button } from '@/shared/components/ui/button';\nimport { Badge } from '@/shared/components/ui/badge';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '@/shared/components/ui/table';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/shared/components/ui/select';\nimport { Skeleton } from '@/shared/components/ui/skeleton';\n\nconst typeIcons: Record<string, typeof Info> = {\n  info: Info,\n  warning: AlertTriangle,\n  success: CheckCircle,\n  error: XCircle,\n};\n\nconst typeBadgeVariants: Record<string, 'default' | 'secondary' | 'destructive' | 'outline'> = {\n  info: 'default',\n  warning: 'secondary',\n  success: 'default',\n  error: 'destructive',\n};\n\nconst typeBadgeColors: Record<string, string> = {\n  info: 'bg-blue-500',\n  warning: 'bg-yellow-500 text-white',\n  success: 'bg-green-500',\n  error: '',\n};\n\nfunction formatDate(dateString: string) {\n  return new Date(dateString).toLocaleDateString('en-US', {\n    year: 'numeric',\n    month: 'short',\n    day: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\nexport function NotificationsPage() {\n  const { t } = useTranslation('notifications');\n  const [page, setPage] = useState(1);\n  const [typeFilter, setTypeFilter] = useState<string>('');\n  const [tenantFilter, setTenantFilter] = useState<string>('');\n\n  const { data: tenants } = useTenants({ pageSize: 100 });\n\n  const filter: Record<string, string> = {};\n  if (typeFilter) filter['type'] = typeFilter;\n  if (tenantFilter) filter['tenantId'] = tenantFilter;\n\n  const { data, isLoading } = useAdminNotifications({\n    page,\n    pageSize: 20,\n    sort: '-createdAt',\n    ...(Object.keys(filter).length > 0 ? { filter } : {}),\n  });\n\n  const notifications = data?.items ?? [];\n  const totalCount = data?.totalCount ?? 0;\n  const totalPages = data?.totalPages ?? 1;\n\n  // Build a map of tenant names for display\n  const tenantMap = new Map(\n    tenants?.items?.map((t) => [t.id, t.name]) ?? [],\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold tracking-tight flex items-center gap-2\">\n            <Bell className=\"h-6 w-6\" />\n            {t('history.title')}\n          </h1>\n          <p className=\"text-muted-foreground\">{t('history.description')}</p>\n        </div>\n        <Link to=\"/notifications/send\">\n          <Button>\n            <Send className=\"h-4 w-4 me-2\" />\n            {t('sendNotification')}\n          </Button>\n        </Link>\n      </div>\n\n      {/* Filters */}\n      <div className=\"flex items-center gap-3\">\n        <Select value={typeFilter} onValueChange={(v) => { setTypeFilter(v === 'all' ? '' : v); setPage(1); }}>\n          <SelectTrigger className=\"w-[180px]\">\n            <SelectValue placeholder={t('history.filterByType')} />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">{t('history.allTypes')}</SelectItem>\n            <SelectItem value=\"info\">{t('types.info')}</SelectItem>\n            <SelectItem value=\"warning\">{t('types.warning')}</SelectItem>\n            <SelectItem value=\"success\">{t('types.success')}</SelectItem>\n            <SelectItem value=\"error\">{t('types.error')}</SelectItem>\n          </SelectContent>\n        </Select>\n\n        <Select value={tenantFilter} onValueChange={(v) => { setTenantFilter(v === 'all' ? '' : v); setPage(1); }}>\n          <SelectTrigger className=\"w-[220px]\">\n            <SelectValue placeholder={t('history.filterByTenant')} />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">{t('history.allTenants')}</SelectItem>\n            {tenants?.items?.map((tenant) => (\n              <SelectItem key={tenant.id} value={tenant.id}>\n                {tenant.name}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n\n        <div className=\"ms-auto text-sm text-muted-foreground\">\n          {totalCount > 0 && t('pagination.showing', {\n            from: (page - 1) * 20 + 1,\n            to: Math.min(page * 20, totalCount),\n            total: totalCount,\n          })}\n        </div>\n      </div>\n\n      {/* Table */}\n      <div className=\"rounded-md border\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>{t('fields.type')}</TableHead>\n              <TableHead>{t('fields.title')}</TableHead>\n              <TableHead>{t('fields.tenant')}</TableHead>\n              <TableHead>{t('fields.status')}</TableHead>\n              <TableHead>{t('fields.createdAt')}</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {isLoading ? (\n              Array.from({ length: 5 }).map((_, i) => (\n                <TableRow key={i}>\n                  <TableCell><Skeleton className=\"h-5 w-16\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-5 w-48\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-5 w-24\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-5 w-16\" /></TableCell>\n                  <TableCell><Skeleton className=\"h-5 w-32\" /></TableCell>\n                </TableRow>\n              ))\n            ) : notifications.length === 0 ? (\n              <TableRow>\n                <TableCell colSpan={5} className=\"h-32 text-center\">\n                  <div className=\"flex flex-col items-center gap-2\">\n                    <Bell className=\"h-8 w-8 text-muted-foreground\" />\n                    <p className=\"font-medium\">{t('history.noNotifications')}</p>\n                    <p className=\"text-sm text-muted-foreground\">\n                      {t('history.noNotificationsDescription')}\n                    </p>\n                    <Link to=\"/notifications/send\">\n                      <Button variant=\"outline\" size=\"sm\" className=\"mt-2\">\n                        <Send className=\"h-4 w-4 me-2\" />\n                        {t('sendNotification')}\n                      </Button>\n                    </Link>\n                  </div>\n                </TableCell>\n              </TableRow>\n            ) : (\n              notifications.map((notification) => {\n                const TypeIcon = typeIcons[notification.type] ?? Info;\n                return (\n                  <TableRow key={notification.id}>\n                    <TableCell>\n                      <Badge\n                        variant={typeBadgeVariants[notification.type] ?? 'outline'}\n                        className={typeBadgeColors[notification.type] ?? ''}\n                      >\n                        <TypeIcon className=\"h-3 w-3 me-1\" />\n                        {t(`types.${notification.type}`)}\n                      </Badge>\n                    </TableCell>\n                    <TableCell>\n                      <div>\n                        <p className=\"font-medium\">{notification.title}</p>\n                        <p className=\"text-sm text-muted-foreground line-clamp-1\">\n                          {notification.body}\n                        </p>\n                      </div>\n                    </TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {tenantMap.get(notification.tenantId) ?? notification.tenantId.slice(0, 8)}\n                    </TableCell>\n                    <TableCell>\n                      {notification.isRead ? (\n                        <Badge variant=\"outline\">{t('history.read')}</Badge>\n                      ) : (\n                        <Badge variant=\"secondary\">{t('history.unread')}</Badge>\n                      )}\n                    </TableCell>\n                    <TableCell className=\"text-muted-foreground\">\n                      {formatDate(notification.createdAt)}\n                    </TableCell>\n                  </TableRow>\n                );\n              })\n            )}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-center gap-2\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setPage((p) => Math.max(1, p - 1))}\n            disabled={page <= 1}\n          >\n            Previous\n          </Button>\n          <span className=\"text-sm text-muted-foreground\">\n            {page} / {totalPages}\n          </span>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setPage((p) => Math.min(totalPages, p + 1))}\n            disabled={page >= totalPages}\n          >\n            Next\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["typeIcons","Info","AlertTriangle","CheckCircle","XCircle","typeBadgeVariants","typeBadgeColors","formatDate","dateString","NotificationsPage","useTranslation","page","setPage","useState","typeFilter","setTypeFilter","tenantFilter","setTenantFilter","tenants","useTenants","filter","data","isLoading","useAdminNotifications","notifications","totalCount","totalPages","tenantMap","_a","t","jsxs","jsx","Bell","Link","Button","Send","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","_b","tenant","Table","TableHeader","TableRow","TableHead","TableBody","_","i","TableCell","Skeleton","notification","TypeIcon","Badge","p"],"mappings":"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"}