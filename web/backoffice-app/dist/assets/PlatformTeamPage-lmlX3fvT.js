import{c as _,v as j,w as A,r as l,j as e,S as T,B as h,A as E,q as F,s as L}from"./index-CCoXuS_m.js";import{u as te,a as C}from"./useMutation-D4ruvC8T.js";import{I as M}from"./utils-BsSPZJCQ.js";import{B as q,S as re,a as ne,b as le,c as ie,d}from"./select-BZ45kTqf.js";import{T as de,a as ce,b as U,c,d as oe,e as o}from"./table-Dq4jZVvF.js";import{S as me,D as ue,a as xe,E as he,b as fe,c as y,d as je,A as pe,e as ge,f as ve,g as ye,h as Se,i as Ne,j as Ae,k as Ce}from"./alert-dialog-B4CueXV2.js";import{D as I,a as Q,b as B,c as H,d as we,e as De}from"./dialog-BK5jEfDu.js";import{S as be}from"./skeleton-D-5V38zq.js";import{C as S,a as ke,c as Pe,b as N}from"./card-cTG8WLyc.js";import{L as O}from"./label-BimSXq2B.js";import{E as Re}from"./eye-D5eqw0ls.js";import{T as Te}from"./trash-2-DcfkCzOD.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=_("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=_("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);async function Fe(a){return j.get("/platform/staff",a)}async function Le(a){return j.post("/platform/staff",a)}async function Me(a,r){return j.patch(`/platform/staff/${a}`,r)}async function qe(a){return j.delete(`/platform/staff/${a}`)}const p="platform-staff";function Ue(a){return te({queryKey:[p,a],queryFn:()=>Fe(a)})}function Ie(){const a=A();return C({mutationFn:r=>Le(r),onSuccess:()=>{a.invalidateQueries({queryKey:[p]})}})}function Qe(){const a=A();return C({mutationFn:({id:r,data:n})=>Me(r,n),onSuccess:()=>{a.invalidateQueries({queryKey:[p]})}})}function Be(){const a=A();return C({mutationFn:r=>qe(r),onSuccess:()=>{a.invalidateQueries({queryKey:[p]})}})}function V(a,r){const n=(a==null?void 0:a[0])||"",i=(r==null?void 0:r[0])||"";return(n+i).toUpperCase()||"?"}function f(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}const He={"super-admin":"Super Admin",admin:"Admin",finance:"Finance",sales:"Sales",support:"Support"};function z(a){return He[a]||a}function es(){const[a,r]=l.useState(""),[n,i]=l.useState(null),[t,w]=l.useState(null),[Y,m]=l.useState(!1),[u,D]=l.useState(""),[b,k]=l.useState("admin"),[P,R]=l.useState(null),{data:$,isLoading:G,error:J}=Ue({search:a||void 0}),g=Ie(),W=Qe(),X=Be(),Z=async()=>{if(n)try{await X.mutateAsync(n.id),i(null)}catch(s){console.error("Failed to remove staff:",s)}},ee=async s=>{const v=s.role==="super-admin"?"admin":"super-admin";try{await W.mutateAsync({id:s.id,data:{role:v}})}catch(ae){console.error("Failed to update staff:",ae)}},se=async()=>{if(u.trim()){R(null);try{await g.mutateAsync({email:u.trim(),role:b}),m(!1),D(""),k("admin")}catch(s){R(s.message||"Failed to add staff member")}}},x=$||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(T,{className:"h-6 w-6"}),"Platform Team"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users who have access to this admin panel."})]}),e.jsxs(S,{children:[e.jsx(ke,{className:"pb-2",children:e.jsx(Pe,{className:"text-sm font-medium text-muted-foreground",children:"Team Members"})}),e.jsx(N,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"text-3xl font-bold",children:x.length}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[x.filter(s=>s.role==="super-admin").length," super admins"]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-80",children:[e.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(M,{placeholder:"Search by name or email...",value:a,onChange:s=>r(s.target.value),className:"pl-10"})]}),e.jsxs(h,{onClick:()=>m(!0),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Add Staff"]})]}),G?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,v)=>e.jsx(be,{className:"h-16 w-full"},v))}):J?e.jsx(S,{children:e.jsx(N,{className:"py-10 text-center text-muted-foreground",children:"Failed to load platform team members. Please try again."})}):x.length===0?e.jsx(S,{children:e.jsx(N,{className:"py-10 text-center text-muted-foreground",children:a?"No staff match your search.":"No platform staff yet. Add your first team member above."})}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(de,{children:[e.jsx(ce,{children:e.jsxs(U,{children:[e.jsx(c,{children:"User"}),e.jsx(c,{children:"Role"}),e.jsx(c,{children:"Last Login"}),e.jsx(c,{children:"Added"}),e.jsx(c,{className:"w-[70px]"})]})}),e.jsx(oe,{children:x.map(s=>e.jsxs(U,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(E,{className:"h-9 w-9",children:[e.jsx(F,{src:s.user.avatarUrl}),e.jsx(L,{className:"bg-primary/10 text-primary",children:V(s.user.firstName,s.user.lastName)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.user.firstName," ",s.user.lastName]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.user.email})]})]})}),e.jsx(o,{children:s.role==="super-admin"?e.jsxs(q,{className:"bg-amber-500 hover:bg-amber-600",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Super Admin"]}):e.jsxs(q,{variant:"secondary",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),z(s.role)]})}),e.jsx(o,{className:"text-muted-foreground",children:f(s.user.lastLoginAt)}),e.jsx(o,{className:"text-muted-foreground",children:f(s.createdAt)}),e.jsx(o,{children:e.jsxs(ue,{children:[e.jsx(xe,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(fe,{align:"end",children:[e.jsxs(y,{onClick:()=>w(s),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(y,{onClick:()=>ee(s),children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),s.role==="super-admin"?"Remove Super Admin":"Make Super Admin"]}),e.jsx(je,{}),e.jsxs(y,{className:"text-destructive",onClick:()=>i(s),children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Remove Staff"]})]})]})})]},s.id))})]})}),e.jsx(I,{open:Y,onOpenChange:m,children:e.jsxs(Q,{children:[e.jsxs(B,{children:[e.jsx(H,{children:"Add Platform Staff"}),e.jsx(we,{children:"Add an existing user as a platform staff member. The user must have logged in at least once."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[P&&e.jsx("div",{className:"text-sm text-destructive bg-destructive/10 p-3 rounded-md",children:P}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"email",children:"Email Address"}),e.jsx(M,{id:"email",type:"email",placeholder:"user@example.com",value:u,onChange:s=>D(s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{htmlFor:"role",children:"Role"}),e.jsxs(re,{value:b,onValueChange:s=>k(s),children:[e.jsx(ne,{id:"role",children:e.jsx(le,{placeholder:"Select role"})}),e.jsxs(ie,{children:[e.jsx(d,{value:"super-admin",children:"Super Admin"}),e.jsx(d,{value:"admin",children:"Admin"}),e.jsx(d,{value:"finance",children:"Finance"}),e.jsx(d,{value:"sales",children:"Sales"}),e.jsx(d,{value:"support",children:"Support"})]})]})]})]}),e.jsxs(De,{children:[e.jsx(h,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(h,{onClick:se,disabled:!u.trim()||g.isPending,children:g.isPending?"Adding...":"Add Staff"})]})]})}),e.jsx(pe,{open:!!n,onOpenChange:()=>i(null),children:e.jsxs(ge,{children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Remove Staff Access"}),e.jsxs(Se,{children:["Are you sure you want to remove staff access from"," ",e.jsxs("strong",{children:[n==null?void 0:n.user.firstName," ",n==null?void 0:n.user.lastName]}),"? They will no longer be able to access this admin panel."]})]}),e.jsxs(Ne,{children:[e.jsx(Ae,{children:"Cancel"}),e.jsx(Ce,{onClick:Z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Remove Staff"})]})]})}),e.jsx(I,{open:!!t,onOpenChange:()=>w(null),children:e.jsxs(Q,{children:[e.jsx(B,{children:e.jsx(H,{children:"Staff Details"})}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(E,{className:"h-16 w-16",children:[e.jsx(F,{src:t.user.avatarUrl}),e.jsx(L,{className:"bg-primary/10 text-primary text-xl",children:V(t.user.firstName,t.user.lastName)})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold",children:[t.user.firstName," ",t.user.lastName]}),e.jsx("div",{className:"text-muted-foreground",children:t.user.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Role"}),e.jsx("div",{children:z(t.role)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Department"}),e.jsx("div",{children:t.department||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{children:t.user.isActive?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Phone"}),e.jsx("div",{children:t.user.phone||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Last Login"}),e.jsx("div",{children:f(t.user.lastLoginAt)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Staff Since"}),e.jsx("div",{children:f(t.createdAt)})]})]})]})]})})]})}export{es as PlatformTeamPage};
//# sourceMappingURL=PlatformTeamPage-lmlX3fvT.js.map
