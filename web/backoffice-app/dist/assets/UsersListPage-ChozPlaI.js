import{c as P,v as A,w as F,r as h,j as e,U as R,A as I,q as T,s as q,B as D}from"./index-DmWLXBqc.js";import{u as V,a as Q,I as _,S as o}from"./skeleton-FuQFzEjM.js";import{S as O,a as X,b as $,c as G,d as J,e as b,T as W,f as Y,g as u,h as m,i as Z,j as l,B as j,D as ee,k as se,E as ae,l as te,m as C,n as le,A as ie,o as re,p as ne,q as ce,r as de,s as oe,t as xe,v as me}from"./select-BYhGx2AP.js";import{D as he,a as ue,b as je,c as ge,d as ve}from"./dialog-lQRpD5d5.js";import{C as g,a as v,c as p,b as f}from"./card-fR48R4nC.js";import{E as pe}from"./eye-BR3aKKrn.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=P("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=P("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);async function ye(s){return A.get("/users",s)}async function we(s){return A.post(`/users/${s}/deactivate`)}async function De(s){return A.post(`/users/${s}/reactivate`)}const c={all:["users"],lists:()=>[...c.all,"list"],list:s=>[...c.lists(),s],details:()=>[...c.all,"detail"],detail:s=>[...c.details(),s]};function be(s){return V({queryKey:c.list(s),queryFn:()=>ye(s)})}function Ce(){const s=F();return Q({mutationFn:i=>we(i),onSuccess:(i,n)=>{s.invalidateQueries({queryKey:c.detail(n)}),s.invalidateQueries({queryKey:c.lists()})},meta:{successMessage:"User deactivated successfully"}})}function Ae(){const s=F();return Q({mutationFn:i=>De(i),onSuccess:(i,n)=>{s.invalidateQueries({queryKey:c.detail(n)}),s.invalidateQueries({queryKey:c.lists()})},meta:{successMessage:"User reactivated successfully"}})}function L(s,i){const n=(s==null?void 0:s[0])||"",y=(i==null?void 0:i[0])||"";return(n+y).toUpperCase()||"?"}function N(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}function qe(){const[s,i]=h.useState(""),[n,y]=h.useState("all"),[d,U]=h.useState(1),[x,w]=h.useState(null),[t,S]=h.useState(null),{data:r,isLoading:E,error:H}=be({page:d,pageSize:20,search:s||void 0,filter:n!=="all"?{isActive:n==="active"?"true":"false"}:void 0}),k=Ce(),M=Ae(),K=async()=>{x&&(await k.mutateAsync(x.id),w(null))},z=async a=>{await M.mutateAsync(a.id)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Users"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage platform user accounts"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(O,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(_,{placeholder:"Search by name or email...",value:s,onChange:a=>i(a.target.value),className:"pl-9"})]}),e.jsxs(X,{value:n,onValueChange:y,children:[e.jsx($,{className:"w-[180px]",children:e.jsx(G,{placeholder:"Filter by status"})}),e.jsxs(J,{children:[e.jsx(b,{value:"all",children:"All Users"}),e.jsx(b,{value:"active",children:"Active"}),e.jsx(b,{value:"inactive",children:"Inactive"})]})]})]}),H&&e.jsx("div",{className:"rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:e.jsx("p",{className:"text-sm text-destructive",children:"Failed to load users. Please try again."})}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(W,{children:[e.jsx(Y,{children:e.jsxs(u,{children:[e.jsx(m,{children:"User"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Last Login"}),e.jsx(m,{children:"Created"}),e.jsx(m,{className:"w-[50px]"})]})}),e.jsx(Z,{children:E?Array.from({length:5}).map((a,B)=>e.jsxs(u,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{className:"h-10 w-10 rounded-full"}),e.jsx(o,{className:"h-4 w-[150px]"})]})}),e.jsx(l,{children:e.jsx(o,{className:"h-4 w-[200px]"})}),e.jsx(l,{children:e.jsx(o,{className:"h-5 w-[70px]"})}),e.jsx(l,{children:e.jsx(o,{className:"h-4 w-[120px]"})}),e.jsx(l,{children:e.jsx(o,{className:"h-4 w-[100px]"})}),e.jsx(l,{children:e.jsx(o,{className:"h-8 w-8"})})]},B)):(r==null?void 0:r.items.length)===0?e.jsx(u,{children:e.jsx(l,{colSpan:6,className:"h-24 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(R,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No users found"})]})})}):r==null?void 0:r.items.map(a=>e.jsxs(u,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{className:"h-10 w-10",children:[e.jsx(T,{src:a.avatarUrl,alt:a.fullName}),e.jsx(q,{className:"bg-primary/10 text-primary",children:L(a.firstName,a.lastName)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.fullName}),a.phone&&e.jsx("div",{className:"text-sm text-muted-foreground",children:a.phone})]})]})}),e.jsx(l,{className:"text-muted-foreground",children:a.email}),e.jsx(l,{children:a.isActive?e.jsx(j,{variant:"default",className:"bg-green-500",children:"Active"}):e.jsx(j,{variant:"secondary",children:"Inactive"})}),e.jsx(l,{className:"text-muted-foreground",children:N(a.lastLoginAt)}),e.jsx(l,{className:"text-muted-foreground",children:N(a.createdAt)}),e.jsx(l,{children:e.jsxs(ee,{children:[e.jsx(se,{asChild:!0,children:e.jsx(D,{variant:"ghost",size:"icon",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs(te,{align:"end",children:[e.jsxs(C,{onClick:()=>S(a),children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"View Details"]}),e.jsx(le,{}),a.isActive?e.jsxs(C,{onClick:()=>w(a),className:"text-destructive focus:text-destructive",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Deactivate"]}):e.jsxs(C,{onClick:()=>z(a),disabled:M.isPending,children:[e.jsx(fe,{className:"mr-2 h-4 w-4"}),"Reactivate"]})]})]})})]},a.id))})]})}),r&&r.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",(d-1)*20+1," to ",Math.min(d*20,r.totalCount)," of ",r.totalCount," users"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{variant:"outline",size:"sm",disabled:d===1,onClick:()=>U(d-1),children:"Previous"}),e.jsx(D,{variant:"outline",size:"sm",disabled:d>=r.totalPages,onClick:()=>U(d+1),children:"Next"})]})]}),e.jsx(ie,{open:!!x,onOpenChange:()=>w(null),children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ce,{children:"Deactivate User"}),e.jsxs(de,{children:["Are you sure you want to deactivate ",e.jsx("strong",{children:x==null?void 0:x.fullName}),"? They will no longer be able to access the platform."]})]}),e.jsxs(oe,{children:[e.jsx(xe,{children:"Cancel"}),e.jsx(me,{onClick:K,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:k.isPending?"Deactivating...":"Deactivate"})]})]})}),e.jsx(he,{open:!!t,onOpenChange:()=>S(null),children:e.jsxs(ue,{className:"sm:max-w-[500px]",children:[e.jsxs(je,{children:[e.jsx(ge,{children:"User Details"}),e.jsx(ve,{children:"Profile information for this user"})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(I,{className:"h-16 w-16",children:[e.jsx(T,{src:t.avatarUrl,alt:t.fullName}),e.jsx(q,{className:"bg-primary/10 text-primary text-xl",children:L(t.firstName,t.lastName)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.fullName}),e.jsx("p",{className:"text-muted-foreground",children:t.email}),t.isActive?e.jsx(j,{variant:"default",className:"bg-green-500 mt-1",children:"Active"}):e.jsx(j,{variant:"secondary",className:"mt-1",children:"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(g,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Phone"})}),e.jsx(f,{children:e.jsx("p",{className:"font-medium",children:t.phone||"Not set"})})]}),e.jsxs(g,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Locale"})}),e.jsx(f,{children:e.jsx("p",{className:"font-medium",children:t.locale||"en"})})]}),e.jsxs(g,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Last Login"})}),e.jsx(f,{children:e.jsx("p",{className:"font-medium",children:N(t.lastLoginAt)})})]}),e.jsxs(g,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(p,{className:"text-sm font-medium text-muted-foreground",children:"Created"})}),e.jsx(f,{children:e.jsx("p",{className:"font-medium",children:N(t.createdAt)})})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User ID:"})," ",t.id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Keycloak ID:"})," ",t.keycloakId]})]})]})]})})]})}export{qe as UsersListPage};
//# sourceMappingURL=UsersListPage-ChozPlaI.js.map
