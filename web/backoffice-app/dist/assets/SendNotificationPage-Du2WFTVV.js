import{T as b,j as e,l as M,u as F,r,B as u,X as G}from"./index-CCoXuS_m.js";import{I as y,T as L,a as C,C as E,b as J,S as K}from"./hooks-CVliGVvY.js";import{u as Q,i as W}from"./hooks-Bj8GK6wO.js";import{I as P}from"./utils-BsSPZJCQ.js";import{T as Y}from"./textarea-Do42QrM7.js";import{S as Z,a as _,b as ee,c as se,d as te,B}from"./select-BZ45kTqf.js";import{C as z,a as $,c as A,b as U}from"./card-cTG8WLyc.js";import{A as ae}from"./arrow-left-IHJV1USF.js";import"./useMutation-D4ruvC8T.js";const ne=[{value:"info",icon:y,colorClass:"text-blue-600 border-blue-200 bg-blue-50"},{value:"warning",icon:L,colorClass:"text-yellow-600 border-yellow-200 bg-yellow-50"},{value:"success",icon:C,colorClass:"text-green-600 border-green-200 bg-green-50"},{value:"error",icon:E,colorClass:"text-red-600 border-red-200 bg-red-50"}];function ie({value:t,onChange:f}){const{t:x}=b("notifications");return e.jsx("div",{className:"flex gap-2",children:ne.map(a=>{const l=a.icon,j=t===a.value;return e.jsxs("button",{type:"button",onClick:()=>f(a.value),className:M("flex items-center gap-2 rounded-lg border px-4 py-2.5 text-sm font-medium transition-all",j?M(a.colorClass,"ring-2 ring-offset-1","ring-current"):"border-border bg-background text-muted-foreground hover:bg-muted"),children:[e.jsx(l,{className:"h-4 w-4"}),x(`types.${a.value}`)]},a.value)})})}const le={info:y,warning:L,success:C,error:E},ce={info:"border-blue-200 bg-blue-50",warning:"border-yellow-200 bg-yellow-50",success:"border-green-200 bg-green-50",error:"border-red-200 bg-red-50"},re={info:"text-blue-600",warning:"text-yellow-600",success:"text-green-600",error:"text-red-600"};function je(){var T,I;const{t}=b("notifications"),{t:f}=b("common"),x=F(),a=J(),[l,j]=r.useState(""),[m,w]=r.useState("all"),[o,N]=r.useState([]),[h,R]=r.useState(""),[p,V]=r.useState(""),[d,X]=r.useState("info"),[g,D]=r.useState(""),{data:v}=Q({pageSize:100}),{data:n}=W(l,{pageSize:100}),S=l&&h.trim()&&p.trim()&&(m==="all"||o.length>0),H=async()=>{S&&(await a.mutateAsync({tenantId:l,title:h.trim(),body:p.trim(),type:d,link:g.trim()||void 0,userIds:m==="specific"?o:void 0}),x("/notifications"))},k=s=>{N(i=>i.includes(s)?i.filter(c=>c!==s):[...i,s])},O=le[d]??y;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>x("/notifications"),children:e.jsx(ae,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t("send.title")}),e.jsx("p",{className:"text-muted-foreground",children:t("send.description")})]})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(z,{children:[e.jsx($,{children:e.jsx(A,{children:t("send.title")})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("fields.tenant")}),e.jsxs(Z,{value:l,onValueChange:s=>{j(s),N([])},children:[e.jsx(_,{children:e.jsx(ee,{placeholder:t("send.selectTenant")})}),e.jsx(se,{children:(T=v==null?void 0:v.items)==null?void 0:T.map(s=>e.jsx(te,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("send.recipientMode")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{type:"button",variant:m==="all"?"default":"outline",size:"sm",onClick:()=>{w("all"),N([])},children:t("send.allMembers")}),e.jsx(u,{type:"button",variant:m==="specific"?"default":"outline",size:"sm",onClick:()=>w("specific"),children:t("send.specificUsers")})]}),m==="specific"&&l&&e.jsxs("div",{className:"mt-3 space-y-2",children:[o.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:o.map(s=>{var c;const i=(c=n==null?void 0:n.items)==null?void 0:c.find(q=>q.userId===s);return e.jsxs(B,{variant:"secondary",className:"gap-1",children:[(i==null?void 0:i.firstName)??s.slice(0,8),e.jsx("button",{type:"button",onClick:()=>k(s),children:e.jsx(G,{className:"h-3 w-3"})})]},s)})}),e.jsxs("div",{className:"border rounded-md max-h-48 overflow-y-auto",children:[(I=n==null?void 0:n.items)==null?void 0:I.map(s=>{var i,c;return e.jsxs("button",{type:"button",onClick:()=>k(s.userId),className:`w-full flex items-center gap-3 px-3 py-2 text-sm hover:bg-muted transition-colors ${o.includes(s.userId)?"bg-primary/5":""}`,children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center text-xs font-medium text-primary shrink-0",children:(((i=s.firstName)==null?void 0:i[0])??"")+(((c=s.lastName)==null?void 0:c[0])??"")}),e.jsxs("div",{className:"text-start",children:[e.jsxs("p",{className:"font-medium",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]}),o.includes(s.userId)&&e.jsx(C,{className:"h-4 w-4 text-primary ms-auto shrink-0"})]},s.userId)}),(!(n!=null&&n.items)||n.items.length===0)&&e.jsx("p",{className:"p-3 text-sm text-muted-foreground text-center",children:t("send.selectMembers")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("send.notificationType")}),e.jsx(ie,{value:d,onChange:X})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("send.notificationTitle")}),e.jsx(P,{value:h,onChange:s=>R(s.target.value),placeholder:t("send.titlePlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("send.notificationBody")}),e.jsx(Y,{value:p,onChange:s=>V(s.target.value),placeholder:t("send.bodyPlaceholder"),rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t("send.linkOptional")}),e.jsx(P,{value:g,onChange:s=>D(s.target.value),placeholder:t("send.linkPlaceholder")})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs(u,{onClick:H,disabled:!S||a.isPending,children:[e.jsx(K,{className:"h-4 w-4 me-2"}),a.isPending?t("send.sending"):t("send.sendButton")]}),e.jsx(u,{variant:"outline",onClick:()=>x("/notifications"),children:f("actions.cancel")})]})]})]})}),e.jsx("div",{children:e.jsxs(z,{className:"sticky top-6",children:[e.jsx($,{children:e.jsx(A,{className:"text-base",children:t("send.preview")})}),e.jsx(U,{children:e.jsxs("div",{className:`rounded-lg border p-4 space-y-2 ${ce[d]??""}`,children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(O,{className:`h-5 w-5 mt-0.5 shrink-0 ${re[d]??""}`}),e.jsxs("div",{className:"space-y-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-sm",children:h||t("send.titlePlaceholder")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p||t("send.bodyPlaceholder")}),g&&e.jsx("p",{className:"text-xs text-primary truncate",children:g})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-current/10",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx(B,{variant:"outline",className:"text-xs",children:t(`types.${d}`)})]})]})})]})})]})]})}export{je as SendNotificationPage};
//# sourceMappingURL=SendNotificationPage-Du2WFTVV.js.map
