{"version":3,"file":"RolesPage-C0xRYWOE.js","sources":["../../src/features/roles/components/RoleFormDialog.tsx","../../src/features/roles/RolesPage.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/shared/components/ui/dialog\";\nimport { Button } from \"@/shared/components/ui/button\";\nimport { Input } from \"@/shared/components/ui/input\";\nimport { Checkbox } from \"@/shared/components/ui/checkbox\";\nimport { Badge } from \"@/shared/components/ui/badge\";\nimport { Loader2 } from \"lucide-react\";\nimport { apiClient } from \"@/shared/api\";\n\ninterface Permission {\n  id: string;\n  name: string;\n  description: string;\n  module: string;\n  action: string;\n}\n\ninterface Role {\n  id: string;\n  name: string;\n  slug: string;\n  description?: string;\n  permissions: Permission[];\n  isSystem: boolean;\n}\n\ninterface RoleFormDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess: () => void;\n  role?: Role | null; // null = create mode, Role = edit mode\n}\n\nexport function RoleFormDialog({\n  open,\n  onOpenChange,\n  onSuccess,\n  role,\n}: RoleFormDialogProps) {\n  const { t } = useTranslation(\"roles\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [permissions, setPermissions] = useState<Permission[]>([]);\n  const [loadingPermissions, setLoadingPermissions] = useState(true);\n\n  const [formData, setFormData] = useState({\n    name: \"\",\n    slug: \"\",\n    description: \"\",\n    permissionIds: [] as string[],\n  });\n\n  const isEditMode = !!role;\n\n  // Load permissions\n  useEffect(() => {\n    async function loadPermissions() {\n      try {\n        const data = await apiClient.get<Permission[]>(\"/admin/permissions\");\n        setPermissions(data);\n      } catch (err) {\n        console.error(\"Failed to load permissions:\", err);\n      } finally {\n        setLoadingPermissions(false);\n      }\n    }\n    if (open) {\n      loadPermissions();\n    }\n  }, [open]);\n\n  // Reset form when dialog opens/closes or role changes\n  useEffect(() => {\n    if (open && role) {\n      setFormData({\n        name: role.name,\n        slug: role.slug,\n        description: role.description || \"\",\n        permissionIds: role.permissions.map((p) => p.id),\n      });\n    } else if (open) {\n      setFormData({\n        name: \"\",\n        slug: \"\",\n        description: \"\",\n        permissionIds: [],\n      });\n    }\n    setError(null);\n  }, [open, role]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    setIsLoading(true);\n\n    try {\n      if (isEditMode && role) {\n        await apiClient.patch(`/admin/roles/${role.id}`, {\n          name: formData.name,\n          description: formData.description || undefined,\n          permissionIds: formData.permissionIds,\n        });\n      } else {\n        await apiClient.post(\"/admin/roles\", {\n          name: formData.name,\n          slug: formData.slug,\n          description: formData.description || undefined,\n          permissionIds: formData.permissionIds,\n        });\n      }\n\n      onSuccess();\n      onOpenChange(false);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"An error occurred\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const generateSlug = (name: string) => {\n    return name\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, \"-\")\n      .replace(/^-|-$/g, \"\");\n  };\n\n  const handleNameChange = (name: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      name,\n      slug: !isEditMode && prev.slug === generateSlug(prev.name) \n        ? generateSlug(name) \n        : prev.slug,\n    }));\n  };\n\n  const togglePermission = (permissionId: string) => {\n    setFormData((prev) => ({\n      ...prev,\n      permissionIds: prev.permissionIds.includes(permissionId)\n        ? prev.permissionIds.filter((id) => id !== permissionId)\n        : [...prev.permissionIds, permissionId],\n    }));\n  };\n\n  const toggleModule = (module: string) => {\n    const modulePermissions = permissions.filter((p) => p.module === module);\n    const moduleIds = modulePermissions.map((p) => p.id);\n    const allSelected = moduleIds.every((id) => formData.permissionIds.includes(id));\n\n    setFormData((prev) => ({\n      ...prev,\n      permissionIds: allSelected\n        ? prev.permissionIds.filter((id) => !moduleIds.includes(id))\n        : [...new Set([...prev.permissionIds, ...moduleIds])],\n    }));\n  };\n\n  // Group permissions by module\n  const permissionsByModule = permissions.reduce<Record<string, Permission[]>>((acc, perm) => {\n    const existing = acc[perm.module] ?? [];\n    acc[perm.module] = [...existing, perm];\n    return acc;\n  }, {});\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[85vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {isEditMode ? t(\"editDialog.title\") : t(\"createDialog.title\")}\n          </DialogTitle>\n          <DialogDescription>\n            {isEditMode ? t(\"editDialog.description\") : t(\"createDialog.description\")}\n          </DialogDescription>\n        </DialogHeader>\n\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {error && (\n            <div className=\"rounded-md bg-destructive/10 p-3 text-sm text-destructive\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"grid gap-4 sm:grid-cols-2\">\n            <div className=\"space-y-2\">\n              <label htmlFor=\"name\" className=\"text-sm font-medium\">\n                {t(\"fields.name\")} *\n              </label>\n              <Input\n                id=\"name\"\n                value={formData.name}\n                onChange={(e) => handleNameChange(e.target.value)}\n                placeholder={t(\"fields.namePlaceholder\")}\n                required\n                disabled={isLoading || (isEditMode && role?.isSystem)}\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <label htmlFor=\"slug\" className=\"text-sm font-medium\">\n                {t(\"fields.slug\")} *\n              </label>\n              <Input\n                id=\"slug\"\n                value={formData.slug}\n                onChange={(e) =>\n                  setFormData((prev) => ({ ...prev, slug: e.target.value }))\n                }\n                placeholder={t(\"fields.slugPlaceholder\")}\n                required\n                disabled={isLoading || isEditMode}\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <label htmlFor=\"description\" className=\"text-sm font-medium\">\n              {t(\"fields.description\")}\n            </label>\n            <Input\n              id=\"description\"\n              value={formData.description}\n              onChange={(e) =>\n                setFormData((prev) => ({ ...prev, description: e.target.value }))\n              }\n              placeholder={t(\"fields.descriptionPlaceholder\")}\n              disabled={isLoading}\n            />\n          </div>\n\n          {/* Permissions Section */}\n          <div className=\"space-y-4\">\n            <label className=\"text-sm font-medium\">{t(\"fields.permissions\")}</label>\n            \n            {loadingPermissions ? (\n              <div className=\"flex items-center justify-center py-8\">\n                <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n              </div>\n            ) : (\n              <div className=\"space-y-4 rounded-lg border p-4\">\n                {Object.entries(permissionsByModule).map(([module, perms]) => {\n                  const moduleIds = perms.map((p) => p.id);\n                  const allSelected = moduleIds.every((id) =>\n                    formData.permissionIds.includes(id)\n                  );\n                  const someSelected =\n                    moduleIds.some((id) => formData.permissionIds.includes(id)) &&\n                    !allSelected;\n\n                  return (\n                    <div key={module} className=\"space-y-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Checkbox\n                          checked={allSelected}\n                          indeterminate={someSelected}\n                          onCheckedChange={() => toggleModule(module)}\n                          disabled={isLoading || (isEditMode && role?.isSystem)}\n                        />\n                        <span className=\"font-medium capitalize\">{module}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {perms.length}\n                        </Badge>\n                      </div>\n                      <div className=\"ms-6 grid gap-2 sm:grid-cols-2\">\n                        {perms.map((perm) => (\n                          <label\n                            key={perm.id}\n                            className=\"flex items-center gap-2 text-sm cursor-pointer\"\n                          >\n                            <Checkbox\n                              checked={formData.permissionIds.includes(perm.id)}\n                              onCheckedChange={() => togglePermission(perm.id)}\n                              disabled={isLoading || (isEditMode && role?.isSystem)}\n                            />\n                            <span className=\"text-muted-foreground\">\n                              {perm.action}\n                            </span>\n                          </label>\n                        ))}\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n\n          <DialogFooter>\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={() => onOpenChange(false)}\n              disabled={isLoading}\n            >\n              {t(\"actions.cancel\")}\n            </Button>\n            <Button \n              type=\"submit\" \n              disabled={isLoading || (isEditMode && role?.isSystem)}\n            >\n              {isLoading ? (\n                <>\n                  <Loader2 className=\"me-2 h-4 w-4 animate-spin\" />\n                  {isEditMode ? t(\"actions.saving\") : t(\"actions.creating\")}\n                </>\n              ) : isEditMode ? (\n                t(\"actions.save\")\n              ) : (\n                t(\"actions.create\")\n              )}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { useState, useEffect, useCallback } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { DataTableAdvanced, type Column } from \"@/shared/components/data-table\";\nimport { Button } from \"@/shared/components/ui/button\";\nimport { Badge } from \"@/shared/components/ui/badge\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/shared/components/ui/dialog\";\nimport { Plus, Edit, Trash2, Shield, Loader2 } from \"lucide-react\";\nimport { RoleFormDialog } from \"./components/RoleFormDialog\";\nimport { apiClient } from \"@/shared/api\";\n\ninterface Permission {\n  id: string;\n  name: string;\n  description: string;\n  module: string;\n  action: string;\n}\n\ninterface Role {\n  id: string;\n  name: string;\n  slug: string;\n  description?: string;\n  permissions: Permission[];\n  permissionsCount: number;\n  usersCount: number;\n  isSystem: boolean;\n  createdAt: string;\n}\n\nexport function RolesPage() {\n  const { t } = useTranslation(\"roles\");\n\n  // State\n  const [data, setData] = useState<Role[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [search, setSearch] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [perPage, setPerPage] = useState(20);\n  const [total, setTotal] = useState(0);\n  const [totalPages, setTotalPages] = useState(1);\n  const [selectedIds, setSelectedIds] = useState<string[]>([]);\n\n  // Dialog states\n  const [formDialogOpen, setFormDialogOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n  const [deletingRole, setDeletingRole] = useState<Role | null>(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n\n  // Fetch data\n  const fetchRoles = useCallback(async () => {\n    setIsLoading(true);\n    try {\n      const params: Record<string, string> = {\n        page: String(page),\n        perPage: String(perPage),\n      };\n      if (search) params.q = search;\n\n      const response = await apiClient.getWithMeta<Role[]>(\"/admin/roles\", params);\n      setData(response.data);\n      if (response.meta) {\n        setTotal(response.meta.total ?? 0);\n        setTotalPages(response.meta.totalPages ?? 1);\n      }\n    } catch (error) {\n      console.error(\"Failed to fetch roles:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [page, perPage, search]);\n\n  useEffect(() => {\n    fetchRoles();\n  }, [fetchRoles]);\n\n  // Debounced search\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setPage(1);\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [search]);\n\n  // Handlers\n  const handleEdit = (role: Role) => {\n    setEditingRole(role);\n    setFormDialogOpen(true);\n  };\n\n  const handleCreate = () => {\n    setEditingRole(null);\n    setFormDialogOpen(true);\n  };\n\n  const handleDeleteClick = (role: Role) => {\n    setDeletingRole(role);\n    setDeleteDialogOpen(true);\n  };\n\n  const handleDeleteConfirm = async () => {\n    if (!deletingRole) return;\n    setIsDeleting(true);\n    try {\n      await apiClient.delete(`/admin/roles/${deletingRole.id}`);\n      fetchRoles();\n      setDeleteDialogOpen(false);\n      setDeletingRole(null);\n    } catch (error) {\n      console.error(\"Failed to delete role:\", error);\n    } finally {\n      setIsDeleting(false);\n    }\n  };\n\n  // Columns\n  const columns: Column<Role>[] = [\n    {\n      key: \"name\",\n      header: t(\"columns.name\"),\n      cell: (row) => (\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex h-9 w-9 items-center justify-center rounded-lg bg-primary/10\">\n            <Shield className=\"h-4 w-4 text-primary\" />\n          </div>\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <p className=\"font-medium\">{row.name}</p>\n              {row.isSystem && (\n                <Badge variant=\"outline\" className=\"text-xs\">\n                  {t(\"systemRole\")}\n                </Badge>\n              )}\n            </div>\n            <p className=\"text-xs text-muted-foreground\">\n              {row.description || row.slug}\n            </p>\n          </div>\n        </div>\n      ),\n    },\n    {\n      key: \"permissionsCount\",\n      header: t(\"columns.permissions\"),\n      className: \"text-center\",\n      cell: (row) => (\n        <Badge variant=\"secondary\">{row.permissionsCount}</Badge>\n      ),\n    },\n    {\n      key: \"usersCount\",\n      header: t(\"columns.users\"),\n      className: \"text-center\",\n      cell: (row) => row.usersCount,\n    },\n    {\n      key: \"createdAt\",\n      header: t(\"columns.createdAt\"),\n      cell: (row) => new Date(row.createdAt).toLocaleDateString(),\n    },\n    {\n      key: \"actions\",\n      header: t(\"columns.actions\"),\n      cell: (row) => (\n        <div className=\"flex items-center gap-1\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"h-8 w-8\"\n            onClick={() => handleEdit(row)}\n          >\n            <Edit className=\"h-4 w-4\" />\n          </Button>\n          {!row.isSystem && (\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"h-8 w-8 text-destructive\"\n              onClick={() => handleDeleteClick(row)}\n            >\n              <Trash2 className=\"h-4 w-4\" />\n            </Button>\n          )}\n        </div>\n      ),\n      className: \"w-[80px]\",\n    },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page header */}\n      <div className=\"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold md:text-3xl\">{t(\"title\")}</h1>\n          <p className=\"text-muted-foreground\">{t(\"subtitle\")}</p>\n        </div>\n      </div>\n\n      {/* Data table */}\n      <DataTableAdvanced\n        columns={columns}\n        data={data}\n        isLoading={isLoading}\n        // Search\n        searchValue={search}\n        onSearchChange={setSearch}\n        searchPlaceholder={t(\"searchPlaceholder\")}\n        // Pagination\n        page={page}\n        totalPages={totalPages}\n        total={total}\n        perPage={perPage}\n        onPageChange={setPage}\n        onPerPageChange={(newPerPage) => {\n          setPerPage(newPerPage);\n          setPage(1);\n        }}\n        // Selection\n        selectable\n        selectedIds={selectedIds}\n        onSelectionChange={setSelectedIds}\n        // Actions\n        onRefresh={fetchRoles}\n        actions={\n          <Button onClick={handleCreate}>\n            <Plus className=\"h-4 w-4\" />\n            <span className=\"hidden sm:inline ms-2\">{t(\"addRole\")}</span>\n          </Button>\n        }\n      />\n\n      {/* Create/Edit Dialog */}\n      <RoleFormDialog\n        open={formDialogOpen}\n        onOpenChange={setFormDialogOpen}\n        onSuccess={fetchRoles}\n        role={editingRole}\n      />\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>{t(\"deleteDialog.title\")}</DialogTitle>\n            <DialogDescription>\n              {t(\"deleteDialog.description\", { name: deletingRole?.name })}\n            </DialogDescription>\n          </DialogHeader>\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setDeleteDialogOpen(false)}\n              disabled={isDeleting}\n            >\n              {t(\"actions.cancel\")}\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={handleDeleteConfirm}\n              disabled={isDeleting}\n            >\n              {isDeleting ? (\n                <>\n                  <Loader2 className=\"me-2 h-4 w-4 animate-spin\" />\n                  {t(\"actions.deleting\")}\n                </>\n              ) : (\n                t(\"actions.delete\")\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n"],"names":["RoleFormDialog","open","onOpenChange","onSuccess","role","t","useTranslation","isLoading","setIsLoading","useState","error","setError","permissions","setPermissions","loadingPermissions","setLoadingPermissions","formData","setFormData","isEditMode","useEffect","loadPermissions","data","apiClient","err","p","handleSubmit","e","generateSlug","name","handleNameChange","prev","togglePermission","permissionId","id","toggleModule","module","moduleIds","allSelected","permissionsByModule","acc","perm","existing","Dialog","jsxs","DialogContent","DialogHeader","jsx","DialogTitle","DialogDescription","Input","Loader2","perms","someSelected","Checkbox","Badge","DialogFooter","Button","Fragment","RolesPage","setData","search","setSearch","page","setPage","perPage","setPerPage","total","setTotal","totalPages","setTotalPages","selectedIds","setSelectedIds","formDialogOpen","setFormDialogOpen","editingRole","setEditingRole","deleteDialogOpen","setDeleteDialogOpen","deletingRole","setDeletingRole","isDeleting","setIsDeleting","fetchRoles","useCallback","params","response","timer","handleEdit","handleCreate","handleDeleteClick","handleDeleteConfirm","columns","row","Shield","Edit","Trash2","DataTableAdvanced","newPerPage","Plus"],"mappings":"2VAyCO,SAASA,GAAe,CAC7B,KAAAC,EACA,aAAAC,EACA,UAAAC,EACA,KAAAC,CACF,EAAwB,CACtB,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAe,OAAO,EAC9B,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAK,EAC1C,CAACC,EAAOC,CAAQ,EAAIF,EAAAA,SAAwB,IAAI,EAChD,CAACG,EAAaC,CAAc,EAAIJ,EAAAA,SAAuB,CAAA,CAAE,EACzD,CAACK,EAAoBC,CAAqB,EAAIN,EAAAA,SAAS,EAAI,EAE3D,CAACO,EAAUC,CAAW,EAAIR,WAAS,CACvC,KAAM,GACN,KAAM,GACN,YAAa,GACb,cAAe,CAAA,CAAC,CACjB,EAEKS,EAAa,CAAC,CAACd,EAGrBe,EAAAA,UAAU,IAAM,CACd,eAAeC,GAAkB,CAC/B,GAAI,CACF,MAAMC,EAAO,MAAMC,EAAU,IAAkB,oBAAoB,EACnET,EAAeQ,CAAI,CACrB,OAASE,EAAK,CACZ,QAAQ,MAAM,8BAA+BA,CAAG,CAClD,QAAA,CACER,EAAsB,EAAK,CAC7B,CACF,CACId,GACFmB,EAAA,CAEJ,EAAG,CAACnB,CAAI,CAAC,EAGTkB,EAAAA,UAAU,IAAM,CACVlB,GAAQG,EACVa,EAAY,CACV,KAAMb,EAAK,KACX,KAAMA,EAAK,KACX,YAAaA,EAAK,aAAe,GACjC,cAAeA,EAAK,YAAY,IAAKoB,GAAMA,EAAE,EAAE,CAAA,CAChD,EACQvB,GACTgB,EAAY,CACV,KAAM,GACN,KAAM,GACN,YAAa,GACb,cAAe,CAAA,CAAC,CACjB,EAEHN,EAAS,IAAI,CACf,EAAG,CAACV,EAAMG,CAAI,CAAC,EAEf,MAAMqB,EAAe,MAAOC,GAAuB,CACjDA,EAAE,eAAA,EACFf,EAAS,IAAI,EACbH,EAAa,EAAI,EAEjB,GAAI,CACEU,GAAcd,EAChB,MAAMkB,EAAU,MAAM,gBAAgBlB,EAAK,EAAE,GAAI,CAC/C,KAAMY,EAAS,KACf,YAAaA,EAAS,aAAe,OACrC,cAAeA,EAAS,aAAA,CACzB,EAED,MAAMM,EAAU,KAAK,eAAgB,CACnC,KAAMN,EAAS,KACf,KAAMA,EAAS,KACf,YAAaA,EAAS,aAAe,OACrC,cAAeA,EAAS,aAAA,CACzB,EAGHb,EAAA,EACAD,EAAa,EAAK,CACpB,OAASqB,EAAK,CACZZ,EAASY,aAAe,MAAQA,EAAI,QAAU,mBAAmB,CACnE,QAAA,CACEf,EAAa,EAAK,CACpB,CACF,EAEMmB,EAAgBC,GACbA,EACJ,cACA,QAAQ,cAAe,GAAG,EAC1B,QAAQ,SAAU,EAAE,EAGnBC,EAAoBD,GAAiB,CACzCX,EAAaa,IAAU,CACrB,GAAGA,EACH,KAAAF,EACA,KAAM,CAACV,GAAcY,EAAK,OAASH,EAAaG,EAAK,IAAI,EACrDH,EAAaC,CAAI,EACjBE,EAAK,IAAA,EACT,CACJ,EAEMC,EAAoBC,GAAyB,CACjDf,EAAaa,IAAU,CACrB,GAAGA,EACH,cAAeA,EAAK,cAAc,SAASE,CAAY,EACnDF,EAAK,cAAc,OAAQG,GAAOA,IAAOD,CAAY,EACrD,CAAC,GAAGF,EAAK,cAAeE,CAAY,CAAA,EACxC,CACJ,EAEME,EAAgBC,GAAmB,CAEvC,MAAMC,EADoBxB,EAAY,OAAQY,GAAMA,EAAE,SAAWW,CAAM,EACnC,IAAKX,GAAMA,EAAE,EAAE,EAC7Ca,EAAcD,EAAU,MAAOH,GAAOjB,EAAS,cAAc,SAASiB,CAAE,CAAC,EAE/EhB,EAAaa,IAAU,CACrB,GAAGA,EACH,cAAeO,EACXP,EAAK,cAAc,OAAQG,GAAO,CAACG,EAAU,SAASH,CAAE,CAAC,EACzD,CAAC,GAAG,IAAI,IAAI,CAAC,GAAGH,EAAK,cAAe,GAAGM,CAAS,CAAC,CAAC,CAAA,EACtD,CACJ,EAGME,EAAsB1B,EAAY,OAAqC,CAAC2B,EAAKC,IAAS,CAC1F,MAAMC,EAAWF,EAAIC,EAAK,MAAM,GAAK,CAAA,EACrC,OAAAD,EAAIC,EAAK,MAAM,EAAI,CAAC,GAAGC,EAAUD,CAAI,EAC9BD,CACT,EAAG,CAAA,CAAE,EAEL,aACGG,EAAA,CAAO,KAAAzC,EAAY,aAAAC,EAClB,SAAAyC,EAAAA,KAACC,EAAA,CAAc,UAAU,gDACvB,SAAA,CAAAD,OAACE,EAAA,CACC,SAAA,CAAAC,MAACC,GACE,SAAa1C,EAAba,EAAe,mBAAwB,oBAAN,EACpC,EACA4B,MAACE,GACE,SAAa3C,EAAba,EAAe,yBAA8B,0BAAN,CAAgC,CAC1E,CAAA,EACF,EAEAyB,EAAAA,KAAC,OAAA,CAAK,SAAUlB,EAAc,UAAU,YACrC,SAAA,CAAAf,GACCoC,EAAAA,IAAC,MAAA,CAAI,UAAU,4DACZ,SAAApC,EACH,EAGFiC,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,QAAQ,OAAO,UAAU,sBAC7B,SAAA,CAAAtC,EAAE,aAAa,EAAE,IAAA,EACpB,EACAyC,EAAAA,IAACG,EAAA,CACC,GAAG,OACH,MAAOjC,EAAS,KAChB,SAAWU,GAAMG,EAAiBH,EAAE,OAAO,KAAK,EAChD,YAAarB,EAAE,wBAAwB,EACvC,SAAQ,GACR,SAAUE,GAAcW,IAAcd,GAAA,YAAAA,EAAM,SAAA,CAAA,CAC9C,EACF,EAEAuC,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAA,EAAAA,KAAC,QAAA,CAAM,QAAQ,OAAO,UAAU,sBAC7B,SAAA,CAAAtC,EAAE,aAAa,EAAE,IAAA,EACpB,EACAyC,EAAAA,IAACG,EAAA,CACC,GAAG,OACH,MAAOjC,EAAS,KAChB,SAAWU,GACTT,EAAaa,IAAU,CAAE,GAAGA,EAAM,KAAMJ,EAAE,OAAO,OAAQ,EAE3D,YAAarB,EAAE,wBAAwB,EACvC,SAAQ,GACR,SAAUE,GAAaW,CAAA,CAAA,CACzB,CAAA,CACF,CAAA,EACF,EAEAyB,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAG,EAAAA,IAAC,SAAM,QAAQ,cAAc,UAAU,sBACpC,SAAAzC,EAAE,oBAAoB,EACzB,EACAyC,EAAAA,IAACG,EAAA,CACC,GAAG,cACH,MAAOjC,EAAS,YAChB,SAAWU,GACTT,EAAaa,IAAU,CAAE,GAAGA,EAAM,YAAaJ,EAAE,OAAO,OAAQ,EAElE,YAAarB,EAAE,+BAA+B,EAC9C,SAAUE,CAAA,CAAA,CACZ,EACF,EAGAoC,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAG,MAAC,QAAA,CAAM,UAAU,sBAAuB,SAAAzC,EAAE,oBAAoB,EAAE,EAE/DS,EACCgC,EAAAA,IAAC,MAAA,CAAI,UAAU,wCACb,eAACI,EAAA,CAAQ,UAAU,4CAAA,CAA6C,CAAA,CAClE,EAEAJ,MAAC,OAAI,UAAU,kCACZ,SAAA,OAAO,QAAQR,CAAmB,EAAE,IAAI,CAAC,CAACH,EAAQgB,CAAK,IAAM,CAC5D,MAAMf,EAAYe,EAAM,IAAK3B,GAAMA,EAAE,EAAE,EACjCa,EAAcD,EAAU,MAAOH,GACnCjB,EAAS,cAAc,SAASiB,CAAE,CAAA,EAE9BmB,EACJhB,EAAU,KAAMH,GAAOjB,EAAS,cAAc,SAASiB,CAAE,CAAC,GAC1D,CAACI,EAEH,OACEM,EAAAA,KAAC,MAAA,CAAiB,UAAU,YAC1B,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAG,EAAAA,IAACO,EAAA,CACC,QAAShB,EACT,cAAee,EACf,gBAAiB,IAAMlB,EAAaC,CAAM,EAC1C,SAAU5B,GAAcW,IAAcd,GAAA,YAAAA,EAAM,SAAA,CAAA,EAE9C0C,EAAAA,IAAC,OAAA,CAAK,UAAU,yBAA0B,SAAAX,EAAO,QAChDmB,EAAA,CAAM,QAAQ,YAAY,UAAU,UAClC,WAAM,MAAA,CACT,CAAA,EACF,QACC,MAAA,CAAI,UAAU,iCACZ,SAAAH,EAAM,IAAKX,GACVG,EAAAA,KAAC,QAAA,CAEC,UAAU,iDAEV,SAAA,CAAAG,EAAAA,IAACO,EAAA,CACC,QAASrC,EAAS,cAAc,SAASwB,EAAK,EAAE,EAChD,gBAAiB,IAAMT,EAAiBS,EAAK,EAAE,EAC/C,SAAUjC,GAAcW,IAAcd,GAAA,YAAAA,EAAM,SAAA,CAAA,EAE9C0C,EAAAA,IAAC,OAAA,CAAK,UAAU,wBACb,WAAK,MAAA,CACR,CAAA,CAAA,EAVKN,EAAK,EAAA,CAYb,CAAA,CACH,CAAA,CAAA,EA7BQL,CA8BV,CAEJ,CAAC,CAAA,CACH,CAAA,EAEJ,SAECoB,EAAA,CACC,SAAA,CAAAT,EAAAA,IAACU,EAAA,CACC,KAAK,SACL,QAAQ,UACR,QAAS,IAAMtD,EAAa,EAAK,EACjC,SAAUK,EAET,WAAE,gBAAgB,CAAA,CAAA,EAErBuC,EAAAA,IAACU,EAAA,CACC,KAAK,SACL,SAAUjD,GAAcW,IAAcd,GAAA,YAAAA,EAAM,UAE3C,WACCuC,EAAAA,KAAAc,EAAAA,SAAA,CACE,SAAA,CAAAX,EAAAA,IAACI,EAAA,CAAQ,UAAU,2BAAA,CAA4B,EACjC7C,EAAba,EAAe,iBAAsB,kBAAN,CAAwB,CAAA,CAC1D,EAEAb,EADEa,EACA,eAEA,gBAFc,CAEE,CAAA,CAEtB,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAEJ,CClSO,SAASwC,IAAY,CAC1B,KAAM,CAAE,EAAArD,CAAA,EAAMC,EAAe,OAAO,EAG9B,CAACe,EAAMsC,CAAO,EAAIlD,EAAAA,SAAiB,CAAA,CAAE,EACrC,CAACF,EAAWC,CAAY,EAAIC,EAAAA,SAAS,EAAI,EACzC,CAACmD,EAAQC,CAAS,EAAIpD,EAAAA,SAAS,EAAE,EACjC,CAACqD,EAAMC,CAAO,EAAItD,EAAAA,SAAS,CAAC,EAC5B,CAACuD,EAASC,CAAU,EAAIxD,EAAAA,SAAS,EAAE,EACnC,CAACyD,EAAOC,CAAQ,EAAI1D,EAAAA,SAAS,CAAC,EAC9B,CAAC2D,EAAYC,CAAa,EAAI5D,EAAAA,SAAS,CAAC,EACxC,CAAC6D,EAAaC,CAAc,EAAI9D,EAAAA,SAAmB,CAAA,CAAE,EAGrD,CAAC+D,EAAgBC,CAAiB,EAAIhE,EAAAA,SAAS,EAAK,EACpD,CAACiE,EAAaC,CAAc,EAAIlE,EAAAA,SAAsB,IAAI,EAC1D,CAACmE,EAAkBC,CAAmB,EAAIpE,EAAAA,SAAS,EAAK,EACxD,CAACqE,EAAcC,CAAe,EAAItE,EAAAA,SAAsB,IAAI,EAC5D,CAACuE,EAAYC,CAAa,EAAIxE,EAAAA,SAAS,EAAK,EAG5CyE,EAAaC,EAAAA,YAAY,SAAY,CACzC3E,EAAa,EAAI,EACjB,GAAI,CACF,MAAM4E,EAAiC,CACrC,KAAM,OAAOtB,CAAI,EACjB,QAAS,OAAOE,CAAO,CAAA,EAErBJ,MAAe,EAAIA,GAEvB,MAAMyB,EAAW,MAAM/D,EAAU,YAAoB,eAAgB8D,CAAM,EAC3EzB,EAAQ0B,EAAS,IAAI,EACjBA,EAAS,OACXlB,EAASkB,EAAS,KAAK,OAAS,CAAC,EACjChB,EAAcgB,EAAS,KAAK,YAAc,CAAC,EAE/C,OAAS3E,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,CAC/C,QAAA,CACEF,EAAa,EAAK,CACpB,CACF,EAAG,CAACsD,EAAME,EAASJ,CAAM,CAAC,EAE1BzC,EAAAA,UAAU,IAAM,CACd+D,EAAA,CACF,EAAG,CAACA,CAAU,CAAC,EAGf/D,EAAAA,UAAU,IAAM,CACd,MAAMmE,EAAQ,WAAW,IAAM,CAC7BvB,EAAQ,CAAC,CACX,EAAG,GAAG,EACN,MAAO,IAAM,aAAauB,CAAK,CACjC,EAAG,CAAC1B,CAAM,CAAC,EAGX,MAAM2B,EAAcnF,GAAe,CACjCuE,EAAevE,CAAI,EACnBqE,EAAkB,EAAI,CACxB,EAEMe,EAAe,IAAM,CACzBb,EAAe,IAAI,EACnBF,EAAkB,EAAI,CACxB,EAEMgB,EAAqBrF,GAAe,CACxC2E,EAAgB3E,CAAI,EACpByE,EAAoB,EAAI,CAC1B,EAEMa,EAAsB,SAAY,CACtC,GAAKZ,EACL,CAAAG,EAAc,EAAI,EAClB,GAAI,CACF,MAAM3D,EAAU,OAAO,gBAAgBwD,EAAa,EAAE,EAAE,EACxDI,EAAA,EACAL,EAAoB,EAAK,EACzBE,EAAgB,IAAI,CACtB,OAASrE,EAAO,CACd,QAAQ,MAAM,yBAA0BA,CAAK,CAC/C,QAAA,CACEuE,EAAc,EAAK,CACrB,EACF,EAGMU,EAA0B,CAC9B,CACE,IAAK,OACL,OAAQtF,EAAE,cAAc,EACxB,KAAOuF,GACLjD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAG,EAAAA,IAAC,OAAI,UAAU,oEACb,eAAC+C,EAAA,CAAO,UAAU,uBAAuB,CAAA,CAC3C,SACC,MAAA,CACC,SAAA,CAAAlD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAG,EAAAA,IAAC,IAAA,CAAE,UAAU,cAAe,SAAA8C,EAAI,KAAK,EACpCA,EAAI,UACH9C,MAACQ,EAAA,CAAM,QAAQ,UAAU,UAAU,UAChC,SAAAjD,EAAE,YAAY,CAAA,CACjB,CAAA,EAEJ,QACC,IAAA,CAAE,UAAU,gCACV,SAAAuF,EAAI,aAAeA,EAAI,IAAA,CAC1B,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAGJ,CACE,IAAK,mBACL,OAAQvF,EAAE,qBAAqB,EAC/B,UAAW,cACX,KAAOuF,GACL9C,EAAAA,IAACQ,GAAM,QAAQ,YAAa,WAAI,gBAAA,CAAiB,CAAA,EAGrD,CACE,IAAK,aACL,OAAQjD,EAAE,eAAe,EACzB,UAAW,cACX,KAAOuF,GAAQA,EAAI,UAAA,EAErB,CACE,IAAK,YACL,OAAQvF,EAAE,mBAAmB,EAC7B,KAAOuF,GAAQ,IAAI,KAAKA,EAAI,SAAS,EAAE,mBAAA,CAAmB,EAE5D,CACE,IAAK,UACL,OAAQvF,EAAE,iBAAiB,EAC3B,KAAOuF,GACLjD,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAG,EAAAA,IAACU,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,UACV,QAAS,IAAM+B,EAAWK,CAAG,EAE7B,SAAA9C,EAAAA,IAACgD,EAAA,CAAK,UAAU,SAAA,CAAU,CAAA,CAAA,EAE3B,CAACF,EAAI,UACJ9C,EAAAA,IAACU,EAAA,CACC,QAAQ,QACR,KAAK,OACL,UAAU,2BACV,QAAS,IAAMiC,EAAkBG,CAAG,EAEpC,SAAA9C,EAAAA,IAACiD,EAAA,CAAO,UAAU,SAAA,CAAU,CAAA,CAAA,CAC9B,EAEJ,EAEF,UAAW,UAAA,CACb,EAGF,OACEpD,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAG,MAAC,MAAA,CAAI,UAAU,qEACb,SAAAH,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAG,MAAC,KAAA,CAAG,UAAU,iCAAkC,SAAAzC,EAAE,OAAO,EAAE,QAC1D,IAAA,CAAE,UAAU,wBAAyB,SAAAA,EAAE,UAAU,CAAA,CAAE,CAAA,CAAA,CACtD,CAAA,CACF,EAGAyC,EAAAA,IAACkD,EAAA,CACC,QAAAL,EACA,KAAAtE,EACA,UAAAd,EAEA,YAAaqD,EACb,eAAgBC,EAChB,kBAAmBxD,EAAE,mBAAmB,EAExC,KAAAyD,EACA,WAAAM,EACA,MAAAF,EACA,QAAAF,EACA,aAAcD,EACd,gBAAkBkC,GAAe,CAC/BhC,EAAWgC,CAAU,EACrBlC,EAAQ,CAAC,CACX,EAEA,WAAU,GACV,YAAAO,EACA,kBAAmBC,EAEnB,UAAWW,EACX,QACEvC,EAAAA,KAACa,EAAA,CAAO,QAASgC,EACf,SAAA,CAAA1C,EAAAA,IAACoD,GAAA,CAAK,UAAU,SAAA,CAAU,QACzB,OAAA,CAAK,UAAU,wBAAyB,SAAA7F,EAAE,SAAS,CAAA,CAAE,CAAA,CAAA,CACxD,CAAA,CAAA,EAKJyC,EAAAA,IAAC9C,GAAA,CACC,KAAMwE,EACN,aAAcC,EACd,UAAWS,EACX,KAAMR,CAAA,CAAA,QAIPhC,EAAA,CAAO,KAAMkC,EAAkB,aAAcC,EAC5C,gBAACjC,EAAA,CACC,SAAA,CAAAD,OAACE,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAa,SAAA1C,EAAE,oBAAoB,CAAA,CAAE,EACtCyC,MAACE,GACE,SAAA3C,EAAE,2BAA4B,CAAE,KAAMyE,GAAA,YAAAA,EAAc,IAAA,CAAM,CAAA,CAC7D,CAAA,EACF,SACCvB,EAAA,CACC,SAAA,CAAAT,EAAAA,IAACU,EAAA,CACC,QAAQ,UACR,QAAS,IAAMqB,EAAoB,EAAK,EACxC,SAAUG,EAET,WAAE,gBAAgB,CAAA,CAAA,EAErBlC,EAAAA,IAACU,EAAA,CACC,QAAQ,cACR,QAASkC,EACT,SAAUV,EAET,WACCrC,EAAAA,KAAAc,EAAAA,SAAA,CACE,SAAA,CAAAX,EAAAA,IAACI,EAAA,CAAQ,UAAU,2BAAA,CAA4B,EAC9C7C,EAAE,kBAAkB,CAAA,CAAA,CACvB,EAEAA,EAAE,gBAAgB,CAAA,CAAA,CAEtB,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ"}