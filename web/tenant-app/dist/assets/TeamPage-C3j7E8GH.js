import{c as _e,r as n,j as e,f as $e,g as $,b as M,L as F,e as E,t as S}from"./index-Dh87D1Ms.js";import{h as Me,u as qe,i as _,D as q,a as U,b as O,c as V,d as B,I as b,j as ae,k as se,l as ne,m as ie,n as re,e as z,f as N,B as I,S as Ue,T as Oe,g as Ve}from"./dialog-RtiktQL8.js";import{P as Y}from"./plus-BhVm2Ofv.js";import"./check-DVQOtCr5.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],ze=_e("rotate-cw",Be);function He(t,i=[]){let h=[];function o(a,m){const d=n.createContext(m);d.displayName=a+"Context";const x=h.length;h=[...h,m];const f=u=>{var P;const{scope:r,children:l,...p}=u,g=((P=r==null?void 0:r[t])==null?void 0:P[x])||d,y=n.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:y,children:l})};f.displayName=a+"Provider";function v(u,r){var g;const l=((g=r==null?void 0:r[t])==null?void 0:g[x])||d,p=n.useContext(l);if(p)return p;if(m!==void 0)return m;throw new Error(`\`${u}\` must be used within \`${a}\``)}return[f,v]}const c=()=>{const a=h.map(m=>n.createContext(m));return function(d){const x=(d==null?void 0:d[t])||a;return n.useMemo(()=>({[`__scope${t}`]:{...d,[t]:x}}),[d,x])}};return c.scopeName=t,[o,We(c,...i)]}function We(...t){const i=t[0];if(t.length===1)return i;const h=()=>{const o=t.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(a){const m=o.reduce((d,{useScope:x,scopeName:f})=>{const u=x(a)[`__scope${f}`];return{...d,...u}},{});return n.useMemo(()=>({[`__scope${i.scopeName}`]:m}),[m])}};return h.scopeName=i.scopeName,h}var Ge=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],H=Ge.reduce((t,i)=>{const h=Me(`Primitive.${i}`),o=n.forwardRef((c,a)=>{const{asChild:m,...d}=c,x=m?h:i;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(x,{...d,ref:a})});return o.displayName=`Primitive.${i}`,{...t,[i]:o}},{}),R={exports:{}},T={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z;function Ke(){if(Z)return T;Z=1;var t=$e();function i(u,r){return u===r&&(u!==0||1/u===1/r)||u!==u&&r!==r}var h=typeof Object.is=="function"?Object.is:i,o=t.useState,c=t.useEffect,a=t.useLayoutEffect,m=t.useDebugValue;function d(u,r){var l=r(),p=o({inst:{value:l,getSnapshot:r}}),g=p[0].inst,y=p[1];return a(function(){g.value=l,g.getSnapshot=r,x(g)&&y({inst:g})},[u,l,r]),c(function(){return x(g)&&y({inst:g}),u(function(){x(g)&&y({inst:g})})},[u]),m(l),l}function x(u){var r=u.getSnapshot;u=u.value;try{var l=r();return!h(u,l)}catch{return!0}}function f(u,r){return r()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:d;return T.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:v,T}var ee;function Je(){return ee||(ee=1,R.exports=Ke()),R.exports}var Qe=Je();function Xe(){return Qe.useSyncExternalStore(Ye,()=>!0,()=>!1)}function Ye(){return()=>{}}var W="Avatar",[Ze]=He(W),[et,le]=Ze(W),oe=n.forwardRef((t,i)=>{const{__scopeAvatar:h,...o}=t,[c,a]=n.useState("idle");return e.jsx(et,{scope:h,imageLoadingStatus:c,onImageLoadingStatusChange:a,children:e.jsx(H.span,{...o,ref:i})})});oe.displayName=W;var ce="AvatarImage",de=n.forwardRef((t,i)=>{const{__scopeAvatar:h,src:o,onLoadingStatusChange:c=()=>{},...a}=t,m=le(ce,h),d=tt(o,a),x=qe(f=>{c(f),m.onImageLoadingStatusChange(f)});return _(()=>{d!=="idle"&&x(d)},[d,x]),d==="loaded"?e.jsx(H.img,{...a,ref:i,src:o}):null});de.displayName=ce;var ue="AvatarFallback",me=n.forwardRef((t,i)=>{const{__scopeAvatar:h,delayMs:o,...c}=t,a=le(ue,h),[m,d]=n.useState(o===void 0);return n.useEffect(()=>{if(o!==void 0){const x=window.setTimeout(()=>d(!0),o);return()=>window.clearTimeout(x)}},[o]),m&&a.imageLoadingStatus!=="loaded"?e.jsx(H.span,{...c,ref:i}):null});me.displayName=ue;function te(t,i){return t?i?(t.src!==i&&(t.src=i),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function tt(t,{referrerPolicy:i,crossOrigin:h}){const o=Xe(),c=n.useRef(null),a=o?(c.current||(c.current=new window.Image),c.current):null,[m,d]=n.useState(()=>te(a,t));return _(()=>{d(te(a,t))},[a,t]),_(()=>{const x=u=>()=>{d(u)};if(!a)return;const f=x("loaded"),v=x("error");return a.addEventListener("load",f),a.addEventListener("error",v),i&&(a.referrerPolicy=i),typeof h=="string"&&(a.crossOrigin=h),()=>{a.removeEventListener("load",f),a.removeEventListener("error",v)}},[a,h,i]),m}var he=oe,fe=de,xe=me;const pe=n.forwardRef(({className:t,...i},h)=>e.jsx(he,{ref:h,className:$("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...i}));pe.displayName=he.displayName;const at=n.forwardRef(({className:t,...i},h)=>e.jsx(fe,{ref:h,className:$("aspect-square h-full w-full",t),...i}));at.displayName=fe.displayName;const ve=n.forwardRef(({className:t,...i},h)=>e.jsx(xe,{ref:h,className:$("flex h-full w-full items-center justify-center rounded-full bg-muted text-sm font-medium",t),...i}));ve.displayName=xe.displayName;function st({open:t,onOpenChange:i,onSuccess:h,roles:o}){const{t:c}=M("team"),[a,m]=n.useState(!1),[d,x]=n.useState(null),[f,v]=n.useState({email:"",roleId:"",firstName:"",lastName:""});n.useEffect(()=>{var r;t&&(v({email:"",roleId:((r=o[0])==null?void 0:r.id)||"",firstName:"",lastName:""}),x(null))},[t,o]);const u=async r=>{r.preventDefault(),x(null),m(!0);try{await E.post("/invitations",{email:f.email,roleIds:[f.roleId],displayName:f.firstName&&f.lastName?`${f.firstName} ${f.lastName}`.trim():void 0}),S.success(c("notifications.memberInvited")),h(),i(!1)}catch(l){const p=l instanceof Error?l.message:"An error occurred";x(p),S.error(p)}finally{m(!1)}};return e.jsx(q,{open:t,onOpenChange:i,children:e.jsxs(U,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(V,{children:c("inviteDialog.title")}),e.jsx(B,{children:c("inviteDialog.description")})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[d&&e.jsx("div",{className:"rounded-md bg-destructive/10 p-3 text-sm text-destructive",children:d}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"email",className:"text-sm font-medium",children:[c("fields.email")," *"]}),e.jsx(b,{id:"email",type:"email",value:f.email,onChange:r=>v(l=>({...l,email:r.target.value})),placeholder:c("fields.emailPlaceholder"),required:!0,disabled:a})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"role",className:"text-sm font-medium",children:[c("fields.role")," *"]}),e.jsxs(ae,{value:f.roleId,onValueChange:r=>v(l=>({...l,roleId:r})),disabled:a,children:[e.jsx(se,{children:e.jsx(ne,{placeholder:c("fields.rolePlaceholder")})}),e.jsx(ie,{children:o.map(r=>e.jsx(re,{value:r.id,children:r.name},r.id))})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"firstName",className:"text-sm font-medium",children:c("fields.firstName")}),e.jsx(b,{id:"firstName",value:f.firstName,onChange:r=>v(l=>({...l,firstName:r.target.value})),placeholder:c("fields.firstNamePlaceholder"),disabled:a})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"lastName",className:"text-sm font-medium",children:c("fields.lastName")}),e.jsx(b,{id:"lastName",value:f.lastName,onChange:r=>v(l=>({...l,lastName:r.target.value})),placeholder:c("fields.lastNamePlaceholder"),disabled:a})]})]}),e.jsxs(z,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:a,children:c("actions.cancel")}),e.jsx(N,{type:"submit",disabled:a||!f.roleId,children:a?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"me-2 h-4 w-4 animate-spin"}),c("actions.inviting")]}):c("actions.invite")})]})]})]})})}function nt({open:t,onOpenChange:i,onSuccess:h,member:o,roles:c}){const{t:a}=M("team"),[m,d]=n.useState(!1),[x,f]=n.useState(null),[v,u]=n.useState({displayName:"",jobTitle:"",department:"",phoneNumber:"",roleIds:[]});n.useEffect(()=>{t&&o&&(u({displayName:o.displayName||"",jobTitle:o.jobTitle||"",department:o.department||"",phoneNumber:o.phoneNumber||"",roleIds:o.roleIds||[]}),f(null))},[t,o]);const r=async l=>{if(l.preventDefault(),!!o){f(null),d(!0);try{await E.put(`/members/${o.id}`,{displayName:v.displayName,jobTitle:v.jobTitle||void 0,department:v.department||void 0,phoneNumber:v.phoneNumber||void 0,roleIds:v.roleIds}),S.success(a("notifications.memberUpdated")),h(),i(!1)}catch(p){const g=p instanceof Error?p.message:"An error occurred";f(g),S.error(g)}finally{d(!1)}}};return e.jsx(q,{open:t,onOpenChange:i,children:e.jsxs(U,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(V,{children:a("editDialog.title")}),e.jsx(B,{children:a("editDialog.description",{name:(o==null?void 0:o.displayName)||""})})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[x&&e.jsx("div",{className:"rounded-md bg-destructive/10 p-3 text-sm text-destructive",children:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"displayName",className:"text-sm font-medium",children:[a("fields.displayName")," *"]}),e.jsx(b,{id:"displayName",value:v.displayName,onChange:l=>u(p=>({...p,displayName:l.target.value})),disabled:m,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"role",className:"text-sm font-medium",children:[a("fields.role")," *"]}),e.jsxs(ae,{value:v.roleIds[0]||"",onValueChange:l=>u(p=>({...p,roleIds:[l]})),disabled:m,children:[e.jsx(se,{children:e.jsx(ne,{placeholder:a("fields.rolePlaceholder")})}),e.jsx(ie,{children:c.map(l=>e.jsx(re,{value:l.id,children:l.name},l.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"jobTitle",className:"text-sm font-medium",children:a("fields.jobTitle")}),e.jsx(b,{id:"jobTitle",value:v.jobTitle,onChange:l=>u(p=>({...p,jobTitle:l.target.value})),disabled:m})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"department",className:"text-sm font-medium",children:a("fields.department")}),e.jsx(b,{id:"department",value:v.department,onChange:l=>u(p=>({...p,department:l.target.value})),disabled:m})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"phoneNumber",className:"text-sm font-medium",children:a("fields.phoneNumber")}),e.jsx(b,{id:"phoneNumber",value:v.phoneNumber,onChange:l=>u(p=>({...p,phoneNumber:l.target.value})),disabled:m})]}),e.jsxs(z,{children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>i(!1),disabled:m,children:a("actions.cancel")}),e.jsx(N,{type:"submit",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"me-2 h-4 w-4 animate-spin"}),a("actions.saving")]}):a("actions.save")})]})]})]})})}function ct(){const{t}=M("team"),[i,h]=n.useState([]),[o,c]=n.useState([]),[a,m]=n.useState(!0),[d,x]=n.useState(""),[f,v]=n.useState(),[u,r]=n.useState(),[l,p]=n.useState(1),[g,y]=n.useState(20),[P,ge]=n.useState(0),[je,Ne]=n.useState(1),[Se,ye]=n.useState([]),[be,L]=n.useState(!1),[Ce,G]=n.useState(!1),[we,Ie]=n.useState(null),[Ee,A]=n.useState(!1),[D,K]=n.useState(null),[k,J]=n.useState(!1),[Q,X]=n.useState(null);n.useEffect(()=>{async function s(){try{const j=await E.getWithMeta("/roles");c(j.data)}catch(j){console.error("Failed to fetch roles:",j)}}s()},[]);const C=n.useCallback(async()=>{m(!0);try{const s={page:String(l),pageSize:String(g)};d&&(s.search=d),f&&(s.roleId=f),u&&(s.status=u);const j=await E.getWithMeta("/members",s);h(j.data),j.meta&&(ge(j.meta.total??0),Ne(j.meta.totalPages??1))}catch(s){console.error("Failed to fetch team:",s)}finally{m(!1)}},[l,g,d,f,u]);n.useEffect(()=>{C()},[C]),n.useEffect(()=>{const s=setTimeout(()=>{p(1)},300);return()=>clearTimeout(s)},[d]);const De=s=>{Ie(s),G(!0)},Pe=s=>{K(s),A(!0)},Ae=async()=>{if(D){J(!0);try{await E.post(`/members/${D.id}/deactivate`),S.success(t("notifications.memberDeactivated")),C(),A(!1),K(null)}catch(s){console.error("Failed to deactivate member:",s),S.error(t("notifications.deactivateFailed"))}finally{J(!1)}}},Fe=async s=>{X(s);try{await E.post(`/invitations/${s}/resend`),S.success(t("notifications.invitationResent"))}catch(j){console.error("Failed to resend invitation:",j),S.error(t("notifications.resendFailed"))}finally{X(null)}},Le=(s,j)=>{if(s){const w=s.split(" ");return w.length>=2?`${w[0][0]}${w[1][0]}`.toUpperCase():s[0].toUpperCase()}return j[0].toUpperCase()},ke=[{key:"name",header:t("columns.member"),cell:s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"h-9 w-9",children:e.jsx(ve,{className:"bg-primary/10 text-primary text-xs",children:Le(s.displayName,s.email)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.displayName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})]})},{key:"role",header:t("columns.role"),cell:s=>{var j;return e.jsx("div",{className:"flex flex-wrap gap-1",children:((j=s.roles)==null?void 0:j.map(w=>e.jsx(I,{variant:"secondary",children:w.name},w.id)))||e.jsx(I,{variant:"outline",children:"No role"})})}},{key:"status",header:t("columns.status"),cell:s=>{switch(s.status){case"pending":return e.jsx(I,{variant:"outline",children:t("status.pending")});case"active":return e.jsx(I,{variant:"success",children:t("status.active")});case"inactive":return e.jsx(I,{variant:"secondary",children:t("status.inactive")});default:return e.jsx(I,{children:s.status})}}},{key:"joinedAt",header:t("columns.joinedAt"),cell:s=>s.joinedAtUtc?new Date(s.joinedAtUtc).toLocaleDateString():"-"},{key:"actions",header:t("columns.actions"),cell:s=>e.jsxs("div",{className:"flex items-center gap-1",children:[s.status==="pending"&&e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>Fe(s.id),disabled:Q===s.id,children:Q===s.id?e.jsx(F,{className:"h-4 w-4 animate-spin"}):e.jsx(ze,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>De(s),children:e.jsx(Ue,{className:"h-4 w-4"})}),s.status!=="inactive"&&e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>Pe(s),children:e.jsx(Oe,{className:"h-4 w-4"})})]}),className:"w-[120px]"}],Re=[{key:"role",label:t("filters.role"),value:f,options:o.map(s=>({label:s.name,value:s.id}))},{key:"status",label:t("filters.status"),value:u,options:[{label:t("status.active"),value:"active"},{label:t("status.inactive"),value:"inactive"},{label:t("status.pending"),value:"pending"}]}],Te=(s,j)=>{s==="role"?v(j):s==="status"&&r(j),p(1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold md:text-3xl",children:t("title")}),e.jsx("p",{className:"text-muted-foreground",children:t("subtitle")})]})}),e.jsx(Ve,{columns:ke,data:i,isLoading:a,searchValue:d,onSearchChange:x,searchPlaceholder:t("searchPlaceholder"),filters:Re,onFilterChange:Te,page:l,totalPages:je,total:P,perPage:g,onPageChange:p,onPerPageChange:s=>{y(s),p(1)},selectable:!0,selectedIds:Se,onSelectionChange:ye,onRefresh:C,actions:e.jsxs(N,{onClick:()=>L(!0),children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline ms-2",children:t("inviteMember")})]}),emptyVariant:"team",emptyAction:e.jsxs(N,{onClick:()=>L(!0),children:[e.jsx(Y,{className:"h-4 w-4 me-2"}),t("inviteMember")]})}),e.jsx(st,{open:be,onOpenChange:L,onSuccess:C,roles:o}),e.jsx(nt,{open:Ce,onOpenChange:G,onSuccess:C,member:we,roles:o}),e.jsx(q,{open:Ee,onOpenChange:A,children:e.jsxs(U,{children:[e.jsxs(O,{children:[e.jsx(V,{children:t("deactivateDialog.title")}),e.jsx(B,{children:t("deactivateDialog.description",{name:(D==null?void 0:D.displayName)||""})})]}),e.jsxs(z,{children:[e.jsx(N,{variant:"outline",onClick:()=>A(!1),disabled:k,children:t("actions.cancel")}),e.jsx(N,{variant:"destructive",onClick:Ae,disabled:k,children:k?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"me-2 h-4 w-4 animate-spin"}),t("actions.deactivating")]}):t("actions.deactivate")})]})]})})]})}export{ct as TeamPage};
//# sourceMappingURL=TeamPage-C3j7E8GH.js.map
