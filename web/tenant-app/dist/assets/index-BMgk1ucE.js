import{c as b,g as y,i as ee,l as P,r as c,j as e,X as se,f,d as I,P as M}from"./index-CAFiiKcd.js";import{j as te,k as D,l as ae,m as ne,C as z,n as ie,T as L,D as _,O as $,L as m,o as p,B as le,v as re,w as oe,E as ce,x as de,y as k,V as ue,z as q,A as me,F as pe,G as he,H as xe,J as ge,K as fe,M as je,N as ye,Q as ve}from"./label-U6-MgQeg.js";import{B as g}from"./button-kOl4-mQz.js";import{M as Ne}from"./mail-DuEwvCfO.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Se=b("ban",be);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Ae=b("globe",Ce);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ke=b("phone",we);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],De=b("rotate-ccw",Pe);function S(s){return`/tenants/${ee()}${s}`}function Fe(s){return y.getPaged(S("/suppliers"),{...s,include:"supplier"})}function Ee(s){return y.post(S("/suppliers"),s)}function Te(s,a){return y.patch(S(`/suppliers/${s}`),a)}function Me(s){return y.delete(S(`/suppliers/${s}`))}function qe(s){return y.post("/suppliers",s)}const C="tenant-suppliers";function Re(s){return te({queryKey:[C,s],queryFn:()=>Fe(s)})}function Ie(){const s=P();return D({mutationFn:async a=>{const t=await qe(a);return Ee({supplierId:t.id})},onSuccess:()=>{s.invalidateQueries({queryKey:[C]})}})}function ze(){const s=P();return D({mutationFn:({id:a,data:t})=>Te(a,t),onSuccess:()=>{s.invalidateQueries({queryKey:[C]})}})}function Le(){const s=P();return D({mutationFn:a=>Me(a),onSuccess:()=>{s.invalidateQueries({queryKey:[C]})}})}const _e=ae,$e=ne,K=c.forwardRef(({className:s,...a},t)=>e.jsx($,{ref:t,className:f("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a}));K.displayName=$.displayName;const Ke={top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 start-0 h-full w-3/4 border-e data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm rtl:data-[state=closed]:slide-out-to-right rtl:data-[state=open]:slide-in-from-right",right:"inset-y-0 end-0 h-full w-3/4 border-s data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-lg rtl:data-[state=closed]:slide-out-to-left rtl:data-[state=open]:slide-in-from-left"},Q=c.forwardRef(({side:s="right",className:a,children:t,...n},h)=>e.jsxs($e,{children:[e.jsx(K,{}),e.jsxs(z,{ref:h,className:f("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",Ke[s],a),...n,children:[t,e.jsxs(ie,{className:"absolute end-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Q.displayName=z.displayName;const B=({className:s,...a})=>e.jsx("div",{className:f("flex flex-col space-y-2 text-start",s),...a});B.displayName="SheetHeader";const O=({className:s,...a})=>e.jsx("div",{className:f("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 rtl:sm:space-x-reverse",s),...a});O.displayName="SheetFooter";const V=c.forwardRef(({className:s,...a},t)=>e.jsx(L,{ref:t,className:f("text-lg font-semibold text-foreground",s),...a}));V.displayName=L.displayName;const H=c.forwardRef(({className:s,...a},t)=>e.jsx(_,{ref:t,className:f("text-sm text-muted-foreground",s),...a}));H.displayName=_.displayName;const R={nameEn:"",nameAr:"",country:"",city:"",licenseNumber:"",phone:"",email:"",website:"",notes:""};function Qe({open:s,onOpenChange:a}){const{t}=I("suppliers"),[n,h]=c.useState(R),x=Ie(),d=(l,A)=>h(j=>({...j,[l]:A})),v=async l=>{l.preventDefault(),!(!n.nameEn.trim()||!n.country.trim())&&(await x.mutateAsync({nameEn:n.nameEn.trim(),nameAr:n.nameAr.trim()||void 0,country:n.country.trim(),city:n.city.trim()||void 0,licenseNumber:n.licenseNumber.trim()||void 0,phone:n.phone.trim()||void 0,email:n.email.trim()||void 0,website:n.website.trim()||void 0,notes:n.notes.trim()||void 0}),h(R),a(!1))};return e.jsx(_e,{open:s,onOpenChange:a,children:e.jsx(Q,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:v,className:"flex flex-col h-full",children:[e.jsxs(B,{children:[e.jsx(V,{children:t("add.title")}),e.jsx(H,{children:t("add.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(m,{htmlFor:"nameEn",children:[t("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"nameEn",placeholder:t("add.nameEnPlaceholder"),value:n.nameEn,onChange:l=>d("nameEn",l.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"nameAr",children:t("add.nameAr")}),e.jsx(p,{id:"nameAr",placeholder:t("add.nameArPlaceholder"),value:n.nameAr,onChange:l=>d("nameAr",l.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(m,{htmlFor:"country",children:[t("add.country")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(p,{id:"country",placeholder:t("add.countryPlaceholder"),value:n.country,onChange:l=>d("country",l.target.value),maxLength:10,required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"city",children:t("add.city")}),e.jsx(p,{id:"city",placeholder:t("add.cityPlaceholder"),value:n.city,onChange:l=>d("city",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"licenseNumber",children:t("add.licenseNumber")}),e.jsx(p,{id:"licenseNumber",placeholder:t("add.licenseNumberPlaceholder"),value:n.licenseNumber,onChange:l=>d("licenseNumber",l.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"phone",children:t("add.phone")}),e.jsx(p,{id:"phone",type:"tel",placeholder:t("add.phonePlaceholder"),value:n.phone,onChange:l=>d("phone",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"email",children:t("add.email")}),e.jsx(p,{id:"email",type:"email",placeholder:t("add.emailPlaceholder"),value:n.email,onChange:l=>d("email",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"website",children:t("add.website")}),e.jsx(p,{id:"website",type:"url",placeholder:t("add.websitePlaceholder"),value:n.website,onChange:l=>d("website",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"notes",children:t("add.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:t("add.notesPlaceholder"),value:n.notes,onChange:l=>d("notes",l.target.value),rows:3})]})]}),e.jsxs(O,{children:[e.jsx(g,{type:"button",variant:"outline",onClick:()=>a(!1),children:t("common:cancel")}),e.jsx(g,{type:"submit",disabled:x.isPending||!n.nameEn.trim()||!n.country.trim(),children:x.isPending?t("add.submitting"):t("add.submit")})]})]})})})}const Be={Active:"default",Suspended:"secondary",Terminated:"destructive"};function Ge(){const{t:s}=I("suppliers"),[a,t]=c.useState(""),[n,h]=c.useState(1),[x,d]=c.useState(20),[v,l]=c.useState([]),[A,j]=c.useState(!1),[w,N]=c.useState(null),U=c.useMemo(()=>({page:n,pageSize:x,search:a||void 0,sort:"-createdAt"}),[n,x,a]),{data:o,isLoading:G,refetch:J}=Re(U),X=Le(),Y=ze(),W=async()=>{w&&(await X.mutateAsync(w.id),N(null))},F=async(i,r)=>{await Y.mutateAsync({id:i.id,data:{status:r}})},Z=[{key:"name",header:s("columns.name"),cell:i=>{var r,u;return e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:((r=i.supplier)==null?void 0:r.nameEn)??"—"}),((u=i.supplier)==null?void 0:u.nameAr)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:i.supplier.nameAr})]})}},{key:"country",header:s("columns.country"),cell:i=>{var r,u;return e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ae,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{children:((r=i.supplier)==null?void 0:r.country)??"—"}),((u=i.supplier)==null?void 0:u.city)&&e.jsxs("span",{className:"text-muted-foreground",children:["/ ",i.supplier.city]})]})}},{key:"contact",header:s("columns.contact"),cell:i=>{var r,u,E,T;return e.jsxs("div",{className:"flex flex-col gap-0.5 text-sm",children:[(r=i.supplier)!=null&&r.email?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[180px]",children:i.supplier.email})]}):null,(u=i.supplier)!=null&&u.phone?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(ke,{className:"h-3 w-3"}),i.supplier.phone]}):null,!((E=i.supplier)!=null&&E.email)&&!((T=i.supplier)!=null&&T.phone)&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s("noContact")})]})}},{key:"status",header:s("columns.status"),cell:i=>e.jsx(le,{variant:Be[i.status]??"secondary",children:s(`status.${i.status}`)})},{key:"actions",header:s("columns.actions"),className:"w-[70px]",cell:i=>e.jsxs(re,{children:[e.jsx(oe,{asChild:!0,children:e.jsx(g,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsxs(de,{align:"end",children:[i.status==="Active"&&e.jsxs(k,{onClick:()=>F(i,"Suspended"),children:[e.jsx(Se,{className:"me-2 h-4 w-4"}),s("actions.suspend")]}),i.status==="Suspended"&&e.jsxs(k,{onClick:()=>F(i,"Active"),children:[e.jsx(De,{className:"me-2 h-4 w-4"}),s("actions.reactivate")]}),e.jsx(ue,{}),e.jsxs(k,{className:"text-destructive",onClick:()=>N(i),children:[e.jsx(q,{className:"me-2 h-4 w-4"}),s("actions.remove")]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("title")}),e.jsx("p",{className:"text-muted-foreground",children:s("description")})]}),e.jsx(me,{columns:Z,data:(o==null?void 0:o.items)??[],isLoading:G,selectable:!0,selectedIds:v,onSelectionChange:l,searchPlaceholder:s("searchPlaceholder"),searchValue:a,onSearchChange:i=>{t(i),h(1)},page:n,totalPages:o==null?void 0:o.totalPages,total:o==null?void 0:o.totalCount,pageSize:x,onPageChange:h,onPageSizeChange:d,onRefresh:()=>J(),emptyVariant:"default",emptyTitle:s("empty.title"),emptyDescription:s("empty.description"),emptyAction:e.jsxs(g,{onClick:()=>j(!0),children:[e.jsx(M,{className:"me-2 h-4 w-4"}),s("addSupplier")]}),actions:e.jsxs(g,{onClick:()=>j(!0),children:[e.jsx(M,{className:"me-2 h-4 w-4"}),s("addSupplier")]}),bulkActions:e.jsxs(g,{variant:"destructive",size:"sm",onClick:()=>{const r=((o==null?void 0:o.items)??[]).find(u=>v.includes(u.id));r&&N(r)},children:[e.jsx(q,{className:"me-2 h-4 w-4"}),s("actions.remove")]})}),e.jsx(Qe,{open:A,onOpenChange:j}),e.jsx(pe,{open:!!w,onOpenChange:()=>N(null),children:e.jsxs(he,{children:[e.jsxs(xe,{children:[e.jsx(ge,{children:s("remove.title")}),e.jsx(fe,{children:s("remove.description")})]}),e.jsxs(je,{children:[e.jsx(ye,{children:s("common:cancel")}),e.jsx(ve,{onClick:W,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("remove.confirm")})]})]})})]})}export{Ge as SuppliersPage};
//# sourceMappingURL=index-BMgk1ucE.js.map
