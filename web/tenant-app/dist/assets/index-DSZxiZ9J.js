import{u as A,a as P,A as U,b as I,D as M,c as B,d as _,g as $}from"./WorkerDocumentsTab-Bd4WGVx-.js";import{W as ke}from"./WorkerDocumentsTab-Bd4WGVx-.js";import{d as z,a as W,r as i,j as t,B as V,v as R,T as q,t as H,y as j}from"./index-3LWobmh4.js";import{D as O}from"./DataTableAdvanced-BaepryHP.js";import{C as X,a as Y,b as G,c as J}from"./card-zP3Z4qZO.js";import{S as K}from"./skeleton-CkBj2wMt.js";import{D as Q,a as Z,E as ee,b as te,c as N}from"./alert-dialog-C58uG3WD.js";import{E as se}from"./eye-CeiYeXqo.js";import{D as ae}from"./download-8P9IEK_b.js";import{F as oe}from"./file-text-Y4nid_gy.js";import"./label-C6xqjT5A.js";import"./select-DSHg5FKg.js";import"./ban-CAM-JbPt.js";import"./dialog-dlmPZOCs.js";import"./pencil-DyyNSMRS.js";import"./upload-DY_JWs3d.js";function d({title:s,value:u,icon:r,className:c,isLoading:l}){return t.jsxs(X,{children:[t.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(G,{className:"text-sm font-medium",children:s}),t.jsx(r,{className:`h-4 w-4 ${c??"text-muted-foreground"}`})]}),t.jsx(J,{children:l?t.jsx(K,{className:"h-8 w-16"}):t.jsx("div",{className:`text-2xl font-bold ${c??""}`,children:u})})]})}function Ne(){const{t:s}=z("documents"),u=W(),[r,c]=i.useState(""),[l,p]=i.useState(1),[x,S]=i.useState(20),[v,k]=i.useState([]),[h,C]=i.useState(),[f,w]=i.useState(),{data:a,isLoading:m}=A(),T=i.useMemo(()=>({page:l,pageSize:x,search:r||void 0,sort:"expiresAt","filter[documentType]":h,"filter[effectiveStatus]":f}),[l,x,r,h,f]),{data:o,isLoading:D,refetch:b}=P(T),g=async(e,n)=>{try{const y=await $(e,n);y.fileUrl?window.open(y.fileUrl,"_blank"):j.error(s("toast.noFile"))}catch{j.error(s("toast.downloadError"))}},E=[{key:"documentType",label:s("filters.documentType"),options:U.map(e=>({label:s(`documentType.${e}`),value:e})),value:h},{key:"effectiveStatus",label:s("filters.status"),options:I.map(e=>({label:s(`effectiveStatus.${e}`),value:e})),value:f}],F=(e,n)=>{e==="documentType"&&C(n),e==="effectiveStatus"&&w(n),p(1)},L=[{key:"worker",header:s("columns.worker"),cell:e=>t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"font-medium truncate",children:e.workerName??"—"}),e.workerCode&&t.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:e.workerCode})]})},{key:"documentType",header:s("columns.documentType"),cell:e=>t.jsx(M,{type:e.documentType})},{key:"documentNumber",header:s("columns.documentNumber"),cell:e=>t.jsx("span",{className:"font-mono text-sm",children:e.documentNumber??"—"})},{key:"expiresAt",header:s("columns.expiresAt"),cell:e=>e.expiresAt?new Date(e.expiresAt).toLocaleDateString():"—"},{key:"effectiveStatus",header:s("columns.status"),cell:e=>t.jsx(B,{status:e.effectiveStatus})},{key:"daysUntilExpiry",header:s("columns.daysLeft"),cell:e=>{if(e.daysUntilExpiry==null)return"—";const n=e.daysUntilExpiry<0;return t.jsx("span",{className:n?"text-destructive font-medium":"",children:e.daysUntilExpiry})}},{key:"hasFile",header:s("columns.file"),className:"w-[60px]",cell:e=>e.hasFile?t.jsx("button",{onClick:()=>g(e.workerId,e.id),className:"inline-flex items-center text-primary hover:text-primary/80",title:s("actions.downloadFile"),children:t.jsx(_,{className:"h-4 w-4"})}):t.jsx("span",{className:"text-muted-foreground",children:"—"})},{key:"actions",header:s("columns.actions"),className:"w-[70px]",cell:e=>t.jsxs(Q,{children:[t.jsx(Z,{asChild:!0,children:t.jsx(V,{variant:"ghost",size:"icon",className:"h-8 w-8",children:t.jsx(ee,{className:"h-4 w-4"})})}),t.jsxs(te,{align:"end",children:[t.jsxs(N,{onClick:()=>u(`/workers/${e.workerId}`),children:[t.jsx(se,{className:"me-2 h-4 w-4"}),s("actions.viewWorker")]}),e.hasFile&&t.jsxs(N,{onClick:()=>g(e.workerId,e.id),children:[t.jsx(ae,{className:"me-2 h-4 w-4"}),s("actions.downloadFile")]})]})]})}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("compliance.title")}),t.jsx("p",{className:"text-muted-foreground",children:s("compliance.description")})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsx(d,{title:s("compliance.totalDocuments"),value:(a==null?void 0:a.totalDocuments)??0,icon:oe,isLoading:m}),t.jsx(d,{title:s("compliance.valid"),value:(a==null?void 0:a.valid)??0,icon:R,className:"text-emerald-600",isLoading:m}),t.jsx(d,{title:s("compliance.expiringSoon"),value:(a==null?void 0:a.expiringSoon)??0,icon:q,className:"text-amber-600",isLoading:m}),t.jsx(d,{title:s("compliance.expired"),value:(a==null?void 0:a.expired)??0,icon:H,className:"text-destructive",isLoading:m})]}),t.jsx(O,{columns:L,data:(o==null?void 0:o.items)??[],isLoading:D,selectable:!0,selectedIds:v,onSelectionChange:k,searchPlaceholder:s("compliance.searchPlaceholder"),searchValue:r,onSearchChange:e=>{c(e),p(1)},filters:E,onFilterChange:F,page:l,totalPages:o==null?void 0:o.totalPages,total:o==null?void 0:o.totalCount,pageSize:x,onPageChange:p,onPageSizeChange:S,onRefresh:()=>b(),emptyVariant:"default",emptyTitle:s("compliance.empty.title"),emptyDescription:s("compliance.empty.description")})]})}export{Ne as CompliancePage,B as DocumentStatusBadge,M as DocumentTypeBadge,ke as WorkerDocumentsTab};
//# sourceMappingURL=index-DSZxiZ9J.js.map
