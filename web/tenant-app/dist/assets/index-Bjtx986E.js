import{h as p,l as f,m as g,d as v,r as c,j as t,J as y,G as N}from"./index-3LWobmh4.js";import{D as j}from"./DataTableAdvanced-BaepryHP.js";import{y as S}from"./select-DSHg5FKg.js";import"./skeleton-CkBj2wMt.js";function P(e){return`/tenants/${f()}${e}`}function C(e){return p.getPaged(P("/audit/events"),e)}const A="audit";function I(e){return g({queryKey:[A,"events",e],queryFn:()=>C(e)})}function w({json:e}){const[s,i]=c.useState(!1);if(!e)return t.jsx("span",{className:"text-muted-foreground text-xs",children:"-"});let a;try{a=JSON.parse(e)}catch{return t.jsx("span",{className:"text-xs text-muted-foreground",children:e})}const l=JSON.stringify(a,null,2),r=JSON.stringify(a).slice(0,60);return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>i(!s),className:"flex items-center gap-1 text-xs text-muted-foreground hover:text-foreground",children:[s?t.jsx(S,{className:"h-3 w-3"}):t.jsx(N,{className:"h-3 w-3"}),t.jsx("span",{className:"font-mono",children:s?"collapse":r+(r.length>=60?"...":"")})]}),s&&t.jsx("pre",{className:"mt-1 max-h-48 overflow-auto rounded bg-muted p-2 text-xs font-mono",children:l})]})}function k(e){return new Date(e).toLocaleString()}function D(e){return e?t.jsxs("span",{className:"font-mono text-xs",children:[e.slice(0,8),"..."]}):t.jsx("span",{className:"text-muted-foreground",children:"-"})}function z(){const{t:e}=v("audit"),[s,i]=c.useState(1),[a,l]=c.useState(20),[r,d]=c.useState(""),u=c.useMemo(()=>({page:s,pageSize:a,sort:"-createdAt",...r?{filter:{name:r}}:{}}),[s,a,r]),{data:n,isLoading:m,refetch:x}=I(u),h=[{key:"eventName",header:e("events.eventName"),cell:o=>t.jsx("span",{className:"font-medium",children:o.eventName})},{key:"userId",header:e("events.userId"),cell:o=>D(o.userId)},{key:"createdAt",header:e("events.time"),cell:o=>t.jsx("span",{className:"text-sm",children:k(o.createdAt)})},{key:"payload",header:e("events.payload"),cell:o=>t.jsx(w,{json:o.payload})}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:e("title")}),t.jsx("p",{className:"text-muted-foreground",children:e("description")})]}),t.jsx(j,{columns:h,data:(n==null?void 0:n.items)??[],isLoading:m,searchPlaceholder:e("filters.eventName"),searchValue:r,onSearchChange:d,page:s,pageSize:a,totalPages:(n==null?void 0:n.totalPages)??0,total:(n==null?void 0:n.totalCount)??0,onPageChange:i,onPageSizeChange:l,onRefresh:()=>x(),emptyIcon:y,emptyTitle:e("empty.events.title"),emptyDescription:e("empty.events.description")})]})}export{z as AuditPage};
//# sourceMappingURL=index-Bjtx986E.js.map
