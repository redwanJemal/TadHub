import{c as U,j as e,d as R,r as j,P as F}from"./index-Cqouy3Yt.js";import{v as _,S as T,d as I,e as M,f as G,g as J,L as g,I as v,B as K,D as Q,h as W,E as X,i as Y,j as P,t as Z,T as L,k as ee,A as se,l as ae,m as te,n as ne,o as le,p as ie,q as re,r as ce}from"./label-DwNxcReA.js";import{B as y}from"./button-C8-5F-AC.js";import{u as z,g as E,B as de}from"./index-C2uTH2Od.js";import{u as oe,a as me,b as ue,c as he}from"./hooks-kuV7fTZo.js";import{S as pe,a as xe,b as ge,c as je,d as ve,e as fe,P as Ne}from"./sheet-BahDlhVT.js";import{M as ye}from"./mail-Dhp7jO02.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],be=U("rotate-ccw",Se);function Ce({value:t,onChange:u,disabled:n,placeholder:a="Select country",showFlag:p=!0,showCode:h=!1,className:d,error:f,id:S,name:l}){const{data:i,isLoading:x,isError:N}=z(),A=o=>{const k=i==null?void 0:i.find(b=>b.id===o);u==null||u(o,k)},r=i==null?void 0:i.find(o=>o.id===t);return x?e.jsx(_,{className:"h-10 w-full"}):N?e.jsx(T,{disabled:!0,children:e.jsx(I,{className:d,children:e.jsx(M,{placeholder:"Failed to load countries"})})}):e.jsxs(T,{value:t,onValueChange:A,disabled:n,name:l,children:[e.jsx(I,{id:S,className:`${d} ${f?"border-red-500":""}`,children:e.jsx(M,{placeholder:a,children:r&&e.jsxs("span",{className:"flex items-center gap-2",children:[p&&e.jsx("span",{className:"text-lg",children:E(r.code)}),h&&e.jsx("span",{className:"font-mono text-muted-foreground",children:r.code}),e.jsx("span",{children:r.nameEn})]})})}),e.jsx(G,{children:i==null?void 0:i.map(o=>e.jsx(J,{value:o.id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[p&&e.jsx("span",{className:"text-lg",children:E(o.code)}),h&&e.jsx("span",{className:"font-mono text-muted-foreground",children:o.code}),e.jsx("span",{children:o.nameEn})]})},o.id))})]})}const B={nameEn:"",nameAr:"",countryId:"",countryCode:"",city:"",licenseNumber:"",phone:"",email:"",website:"",notes:""};function Ae({open:t,onOpenChange:u}){const{t:n}=R("suppliers"),[a,p]=j.useState(B),h=oe(),d=(l,i)=>p(x=>({...x,[l]:i})),f=(l,i)=>{p(x=>({...x,countryId:l,countryCode:(i==null?void 0:i.code)??""}))},S=async l=>{l.preventDefault(),!(!a.nameEn.trim()||!a.countryCode)&&(await h.mutateAsync({nameEn:a.nameEn.trim(),nameAr:a.nameAr.trim()||void 0,country:a.countryCode,city:a.city.trim()||void 0,licenseNumber:a.licenseNumber.trim()||void 0,phone:a.phone.trim()||void 0,email:a.email.trim()||void 0,website:a.website.trim()||void 0,notes:a.notes.trim()||void 0}),p(B),u(!1))};return e.jsx(pe,{open:t,onOpenChange:u,children:e.jsx(xe,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:S,className:"flex flex-col h-full",children:[e.jsxs(ge,{children:[e.jsx(je,{children:n("add.title")}),e.jsx(ve,{children:n("add.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(g,{htmlFor:"nameEn",children:[n("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{id:"nameEn",placeholder:n("add.nameEnPlaceholder"),value:a.nameEn,onChange:l=>d("nameEn",l.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"nameAr",children:n("add.nameAr")}),e.jsx(v,{id:"nameAr",placeholder:n("add.nameArPlaceholder"),value:a.nameAr,onChange:l=>d("nameAr",l.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(g,{htmlFor:"country",children:[n("add.country")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(Ce,{id:"country",value:a.countryId,onChange:f,placeholder:n("add.countryPlaceholder"),showFlag:!0,showCode:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"city",children:n("add.city")}),e.jsx(v,{id:"city",placeholder:n("add.cityPlaceholder"),value:a.city,onChange:l=>d("city",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"licenseNumber",children:n("add.licenseNumber")}),e.jsx(v,{id:"licenseNumber",placeholder:n("add.licenseNumberPlaceholder"),value:a.licenseNumber,onChange:l=>d("licenseNumber",l.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"phone",children:n("add.phone")}),e.jsx(v,{id:"phone",type:"tel",placeholder:n("add.phonePlaceholder"),value:a.phone,onChange:l=>d("phone",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"email",children:n("add.email")}),e.jsx(v,{id:"email",type:"email",placeholder:n("add.emailPlaceholder"),value:a.email,onChange:l=>d("email",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"website",children:n("add.website")}),e.jsx(v,{id:"website",type:"url",placeholder:n("add.websitePlaceholder"),value:a.website,onChange:l=>d("website",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"notes",children:n("add.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:n("add.notesPlaceholder"),value:a.notes,onChange:l=>d("notes",l.target.value),rows:3})]})]}),e.jsxs(fe,{children:[e.jsx(y,{type:"button",variant:"outline",onClick:()=>u(!1),children:n("common:cancel")}),e.jsx(y,{type:"submit",disabled:h.isPending||!a.nameEn.trim()||!a.countryCode,children:h.isPending?n("add.submitting"):n("add.submit")})]})]})})})}const ke={Active:"default",Suspended:"secondary",Terminated:"destructive"};function Me(){const{t}=R("suppliers"),[u,n]=j.useState(""),[a,p]=j.useState(1),[h,d]=j.useState(20),[f,S]=j.useState([]),[l,i]=j.useState(!1),[x,N]=j.useState(null),A=j.useMemo(()=>({page:a,pageSize:h,search:u||void 0,sort:"-createdAt"}),[a,h,u]),{data:r,isLoading:o,refetch:k}=me(A),{data:b}=z(),q=ue(),V=he(),$=s=>{if(!s)return"—";const c=b==null?void 0:b.find(m=>m.code===s);return(c==null?void 0:c.nameEn)??s},H=async()=>{x&&(await q.mutateAsync(x.id),N(null))},w=async(s,c)=>{await V.mutateAsync({id:s.id,data:{status:c}})},O=[{key:"name",header:t("columns.name"),cell:s=>{var c,m;return e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:((c=s.supplier)==null?void 0:c.nameEn)??"—"}),((m=s.supplier)==null?void 0:m.nameAr)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:s.supplier.nameAr})]})}},{key:"country",header:t("columns.country"),cell:s=>{var c,m,C;return e.jsxs("div",{className:"flex items-center gap-1.5",children:[((c=s.supplier)==null?void 0:c.country)&&e.jsx("span",{className:"text-lg leading-none",children:E(s.supplier.country)}),e.jsx("span",{children:$((m=s.supplier)==null?void 0:m.country)}),((C=s.supplier)==null?void 0:C.city)&&e.jsxs("span",{className:"text-muted-foreground",children:["/ ",s.supplier.city]})]})}},{key:"contact",header:t("columns.contact"),cell:s=>{var c,m,C,D;return e.jsxs("div",{className:"flex flex-col gap-0.5 text-sm",children:[(c=s.supplier)!=null&&c.email?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(ye,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[180px]",children:s.supplier.email})]}):null,(m=s.supplier)!=null&&m.phone?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(Ne,{className:"h-3 w-3"}),s.supplier.phone]}):null,!((C=s.supplier)!=null&&C.email)&&!((D=s.supplier)!=null&&D.phone)&&e.jsx("span",{className:"text-xs text-muted-foreground",children:t("noContact")})]})}},{key:"status",header:t("columns.status"),cell:s=>e.jsx(K,{variant:ke[s.status]??"secondary",children:t(`status.${s.status}`)})},{key:"actions",header:t("columns.actions"),className:"w-[70px]",cell:s=>e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsx(y,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(X,{className:"h-4 w-4"})})}),e.jsxs(Y,{align:"end",children:[s.status==="Active"&&e.jsxs(P,{onClick:()=>w(s,"Suspended"),children:[e.jsx(de,{className:"me-2 h-4 w-4"}),t("actions.suspend")]}),s.status==="Suspended"&&e.jsxs(P,{onClick:()=>w(s,"Active"),children:[e.jsx(be,{className:"me-2 h-4 w-4"}),t("actions.reactivate")]}),e.jsx(Z,{}),e.jsxs(P,{className:"text-destructive",onClick:()=>N(s),children:[e.jsx(L,{className:"me-2 h-4 w-4"}),t("actions.remove")]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t("title")}),e.jsx("p",{className:"text-muted-foreground",children:t("description")})]}),e.jsx(ee,{columns:O,data:(r==null?void 0:r.items)??[],isLoading:o,selectable:!0,selectedIds:f,onSelectionChange:S,searchPlaceholder:t("searchPlaceholder"),searchValue:u,onSearchChange:s=>{n(s),p(1)},page:a,totalPages:r==null?void 0:r.totalPages,total:r==null?void 0:r.totalCount,pageSize:h,onPageChange:p,onPageSizeChange:d,onRefresh:()=>k(),emptyVariant:"default",emptyTitle:t("empty.title"),emptyDescription:t("empty.description"),emptyAction:e.jsxs(y,{onClick:()=>i(!0),children:[e.jsx(F,{className:"me-2 h-4 w-4"}),t("addSupplier")]}),actions:e.jsxs(y,{onClick:()=>i(!0),children:[e.jsx(F,{className:"me-2 h-4 w-4"}),t("addSupplier")]}),bulkActions:e.jsxs(y,{variant:"destructive",size:"sm",onClick:()=>{const c=((r==null?void 0:r.items)??[]).find(m=>f.includes(m.id));c&&N(c)},children:[e.jsx(L,{className:"me-2 h-4 w-4"}),t("actions.remove")]})}),e.jsx(Ae,{open:l,onOpenChange:i}),e.jsx(se,{open:!!x,onOpenChange:()=>N(null),children:e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(ne,{children:t("remove.title")}),e.jsx(le,{children:t("remove.description")})]}),e.jsxs(ie,{children:[e.jsx(re,{children:t("common:cancel")}),e.jsx(ce,{onClick:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:t("remove.confirm")})]})]})})]})}export{Me as SuppliersPage};
//# sourceMappingURL=index-B0Au522h.js.map
