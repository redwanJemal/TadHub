import{c as I,g as j,j as e,i as ce,l as M,r as p,X as de,f as C,d as V,P as $}from"./index-CzQYpL67.js";import{j as H,W as ue,S as K,p as _,q as B,r as me,s as pe,k as R,l as he,m as xe,C as U,n as ge,T as G,D as J,O as W,L as f,o as v,B as fe,v as je,w as ye,E as ve,x as Ne,y as T,V as be,z as O,A as Se,F as Ce,G as Ae,H as ke,J as we,K as Pe,M as Ee,N as Fe,Q as De}from"./label-BVqgqd5_.js";import{B as S}from"./button-Dy3PHW7p.js";import{M as Te}from"./mail-SzKC0Ca6.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Ie=I("ban",qe);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Re=I("phone",Me);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Le=I("rotate-ccw",ze),$e={async list(t={}){const a={};t.page&&(a.page=t.page),t.pageSize&&(a.pageSize=t.pageSize),t.sort&&(a.sort=t.sort);const s={};return t.code&&(s.code=t.code),t.isActive!==void 0&&(s.isActive=String(t.isActive)),t.isCommonNationality!==void 0&&(s.isCommonNationality=String(t.isCommonNationality)),Object.keys(s).length>0&&(a.filter=s),j.get("/countries",a)},async getRefs(){return j.get("/countries/refs")},async getCommonNationalities(){return j.get("/countries/common-nationalities")},async getById(t){return j.get(`/countries/${t}`)},async getByCode(t){return j.get(`/countries/by-code/${t}`)}},y={all:["countries"],lists:()=>[...y.all,"list"],list:t=>[...y.lists(),t],refs:()=>[...y.all,"refs"],commonNationalities:()=>[...y.all,"commonNationalities"],details:()=>[...y.all,"detail"],detail:t=>[...y.details(),t],byCode:t=>[...y.all,"byCode",t]},Ke=1440*60*1e3;function X(){return H({queryKey:y.refs(),queryFn:()=>$e.getRefs(),staleTime:Ke})}function q(t){const a=t.toUpperCase().split("").map(s=>127397+s.charCodeAt(0));return String.fromCodePoint(...a)}function _e({value:t,onChange:a,disabled:s,placeholder:i="Select country",showFlag:h=!0,showCode:x=!1,className:d,error:N,id:A,name:l}){const{data:r,isLoading:g,isError:b}=X(),F=u=>{const D=r==null?void 0:r.find(k=>k.id===u);a==null||a(u,D)},o=r==null?void 0:r.find(u=>u.id===t);return g?e.jsx(ue,{className:"h-10 w-full"}):b?e.jsx(K,{disabled:!0,children:e.jsx(_,{className:d,children:e.jsx(B,{placeholder:"Failed to load countries"})})}):e.jsxs(K,{value:t,onValueChange:F,disabled:s,name:l,children:[e.jsx(_,{id:A,className:`${d} ${N?"border-red-500":""}`,children:e.jsx(B,{placeholder:i,children:o&&e.jsxs("span",{className:"flex items-center gap-2",children:[h&&e.jsx("span",{className:"text-lg",children:q(o.code)}),x&&e.jsx("span",{className:"font-mono text-muted-foreground",children:o.code}),e.jsx("span",{children:o.nameEn})]})})}),e.jsx(me,{children:r==null?void 0:r.map(u=>e.jsx(pe,{value:u.id,children:e.jsxs("span",{className:"flex items-center gap-2",children:[h&&e.jsx("span",{className:"text-lg",children:q(u.code)}),x&&e.jsx("span",{className:"font-mono text-muted-foreground",children:u.code}),e.jsx("span",{children:u.nameEn})]})},u.id))})]})}function P(t){return`/tenants/${ce()}${t}`}function Be(t){return j.getPaged(P("/suppliers"),{...t,include:"supplier"})}function Oe(t,a){return j.patch(P(`/suppliers/${t}`),a)}function Qe(t){return j.delete(P(`/suppliers/${t}`))}function Ve(t){return j.post(P("/suppliers/create"),t)}const E="tenant-suppliers";function He(t){return H({queryKey:[E,t],queryFn:()=>Be(t)})}function Ue(){const t=M();return R({mutationFn:a=>Ve(a),onSuccess:()=>{t.invalidateQueries({queryKey:[E]})}})}function Ge(){const t=M();return R({mutationFn:({id:a,data:s})=>Oe(a,s),onSuccess:()=>{t.invalidateQueries({queryKey:[E]})}})}function Je(){const t=M();return R({mutationFn:a=>Qe(a),onSuccess:()=>{t.invalidateQueries({queryKey:[E]})}})}const We=he,Xe=xe,Y=p.forwardRef(({className:t,...a},s)=>e.jsx(W,{ref:s,className:C("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));Y.displayName=W.displayName;const Ye={top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 start-0 h-full w-3/4 border-e data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm rtl:data-[state=closed]:slide-out-to-right rtl:data-[state=open]:slide-in-from-right",right:"inset-y-0 end-0 h-full w-3/4 border-s data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-lg rtl:data-[state=closed]:slide-out-to-left rtl:data-[state=open]:slide-in-from-left"},Z=p.forwardRef(({side:t="right",className:a,children:s,...i},h)=>e.jsxs(Xe,{children:[e.jsx(Y,{}),e.jsxs(U,{ref:h,className:C("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",Ye[t],a),...i,children:[s,e.jsxs(ge,{className:"absolute end-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Z.displayName=U.displayName;const ee=({className:t,...a})=>e.jsx("div",{className:C("flex flex-col space-y-2 text-start",t),...a});ee.displayName="SheetHeader";const te=({className:t,...a})=>e.jsx("div",{className:C("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 rtl:sm:space-x-reverse",t),...a});te.displayName="SheetFooter";const se=p.forwardRef(({className:t,...a},s)=>e.jsx(G,{ref:s,className:C("text-lg font-semibold text-foreground",t),...a}));se.displayName=G.displayName;const ae=p.forwardRef(({className:t,...a},s)=>e.jsx(J,{ref:s,className:C("text-sm text-muted-foreground",t),...a}));ae.displayName=J.displayName;const Q={nameEn:"",nameAr:"",countryId:"",countryCode:"",city:"",licenseNumber:"",phone:"",email:"",website:"",notes:""};function Ze({open:t,onOpenChange:a}){const{t:s}=V("suppliers"),[i,h]=p.useState(Q),x=Ue(),d=(l,r)=>h(g=>({...g,[l]:r})),N=(l,r)=>{h(g=>({...g,countryId:l,countryCode:(r==null?void 0:r.code)??""}))},A=async l=>{l.preventDefault(),!(!i.nameEn.trim()||!i.countryCode)&&(await x.mutateAsync({nameEn:i.nameEn.trim(),nameAr:i.nameAr.trim()||void 0,country:i.countryCode,city:i.city.trim()||void 0,licenseNumber:i.licenseNumber.trim()||void 0,phone:i.phone.trim()||void 0,email:i.email.trim()||void 0,website:i.website.trim()||void 0,notes:i.notes.trim()||void 0}),h(Q),a(!1))};return e.jsx(We,{open:t,onOpenChange:a,children:e.jsx(Z,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:A,className:"flex flex-col h-full",children:[e.jsxs(ee,{children:[e.jsx(se,{children:s("add.title")}),e.jsx(ae,{children:s("add.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(f,{htmlFor:"nameEn",children:[s("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(v,{id:"nameEn",placeholder:s("add.nameEnPlaceholder"),value:i.nameEn,onChange:l=>d("nameEn",l.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"nameAr",children:s("add.nameAr")}),e.jsx(v,{id:"nameAr",placeholder:s("add.nameArPlaceholder"),value:i.nameAr,onChange:l=>d("nameAr",l.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(f,{htmlFor:"country",children:[s("add.country")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(_e,{id:"country",value:i.countryId,onChange:N,placeholder:s("add.countryPlaceholder"),showFlag:!0,showCode:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"city",children:s("add.city")}),e.jsx(v,{id:"city",placeholder:s("add.cityPlaceholder"),value:i.city,onChange:l=>d("city",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"licenseNumber",children:s("add.licenseNumber")}),e.jsx(v,{id:"licenseNumber",placeholder:s("add.licenseNumberPlaceholder"),value:i.licenseNumber,onChange:l=>d("licenseNumber",l.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"phone",children:s("add.phone")}),e.jsx(v,{id:"phone",type:"tel",placeholder:s("add.phonePlaceholder"),value:i.phone,onChange:l=>d("phone",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"email",children:s("add.email")}),e.jsx(v,{id:"email",type:"email",placeholder:s("add.emailPlaceholder"),value:i.email,onChange:l=>d("email",l.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"website",children:s("add.website")}),e.jsx(v,{id:"website",type:"url",placeholder:s("add.websitePlaceholder"),value:i.website,onChange:l=>d("website",l.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"notes",children:s("add.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:s("add.notesPlaceholder"),value:i.notes,onChange:l=>d("notes",l.target.value),rows:3})]})]}),e.jsxs(te,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>a(!1),children:s("common:cancel")}),e.jsx(S,{type:"submit",disabled:x.isPending||!i.nameEn.trim()||!i.countryCode,children:x.isPending?s("add.submitting"):s("add.submit")})]})]})})})}const et={Active:"default",Suspended:"secondary",Terminated:"destructive"};function it(){const{t}=V("suppliers"),[a,s]=p.useState(""),[i,h]=p.useState(1),[x,d]=p.useState(20),[N,A]=p.useState([]),[l,r]=p.useState(!1),[g,b]=p.useState(null),F=p.useMemo(()=>({page:i,pageSize:x,search:a||void 0,sort:"-createdAt"}),[i,x,a]),{data:o,isLoading:u,refetch:D}=He(F),{data:k}=X(),ne=Je(),ie=Ge(),le=n=>{if(!n)return"—";const c=k==null?void 0:k.find(m=>m.code===n);return(c==null?void 0:c.nameEn)??n},re=async()=>{g&&(await ne.mutateAsync(g.id),b(null))},z=async(n,c)=>{await ie.mutateAsync({id:n.id,data:{status:c}})},oe=[{key:"name",header:t("columns.name"),cell:n=>{var c,m;return e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:((c=n.supplier)==null?void 0:c.nameEn)??"—"}),((m=n.supplier)==null?void 0:m.nameAr)&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:n.supplier.nameAr})]})}},{key:"country",header:t("columns.country"),cell:n=>{var c,m,w;return e.jsxs("div",{className:"flex items-center gap-1.5",children:[((c=n.supplier)==null?void 0:c.country)&&e.jsx("span",{className:"text-lg leading-none",children:q(n.supplier.country)}),e.jsx("span",{children:le((m=n.supplier)==null?void 0:m.country)}),((w=n.supplier)==null?void 0:w.city)&&e.jsxs("span",{className:"text-muted-foreground",children:["/ ",n.supplier.city]})]})}},{key:"contact",header:t("columns.contact"),cell:n=>{var c,m,w,L;return e.jsxs("div",{className:"flex flex-col gap-0.5 text-sm",children:[(c=n.supplier)!=null&&c.email?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(Te,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[180px]",children:n.supplier.email})]}):null,(m=n.supplier)!=null&&m.phone?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(Re,{className:"h-3 w-3"}),n.supplier.phone]}):null,!((w=n.supplier)!=null&&w.email)&&!((L=n.supplier)!=null&&L.phone)&&e.jsx("span",{className:"text-xs text-muted-foreground",children:t("noContact")})]})}},{key:"status",header:t("columns.status"),cell:n=>e.jsx(fe,{variant:et[n.status]??"secondary",children:t(`status.${n.status}`)})},{key:"actions",header:t("columns.actions"),className:"w-[70px]",cell:n=>e.jsxs(je,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ve,{className:"h-4 w-4"})})}),e.jsxs(Ne,{align:"end",children:[n.status==="Active"&&e.jsxs(T,{onClick:()=>z(n,"Suspended"),children:[e.jsx(Ie,{className:"me-2 h-4 w-4"}),t("actions.suspend")]}),n.status==="Suspended"&&e.jsxs(T,{onClick:()=>z(n,"Active"),children:[e.jsx(Le,{className:"me-2 h-4 w-4"}),t("actions.reactivate")]}),e.jsx(be,{}),e.jsxs(T,{className:"text-destructive",onClick:()=>b(n),children:[e.jsx(O,{className:"me-2 h-4 w-4"}),t("actions.remove")]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:t("title")}),e.jsx("p",{className:"text-muted-foreground",children:t("description")})]}),e.jsx(Se,{columns:oe,data:(o==null?void 0:o.items)??[],isLoading:u,selectable:!0,selectedIds:N,onSelectionChange:A,searchPlaceholder:t("searchPlaceholder"),searchValue:a,onSearchChange:n=>{s(n),h(1)},page:i,totalPages:o==null?void 0:o.totalPages,total:o==null?void 0:o.totalCount,pageSize:x,onPageChange:h,onPageSizeChange:d,onRefresh:()=>D(),emptyVariant:"default",emptyTitle:t("empty.title"),emptyDescription:t("empty.description"),emptyAction:e.jsxs(S,{onClick:()=>r(!0),children:[e.jsx($,{className:"me-2 h-4 w-4"}),t("addSupplier")]}),actions:e.jsxs(S,{onClick:()=>r(!0),children:[e.jsx($,{className:"me-2 h-4 w-4"}),t("addSupplier")]}),bulkActions:e.jsxs(S,{variant:"destructive",size:"sm",onClick:()=>{const c=((o==null?void 0:o.items)??[]).find(m=>N.includes(m.id));c&&b(c)},children:[e.jsx(O,{className:"me-2 h-4 w-4"}),t("actions.remove")]})}),e.jsx(Ze,{open:l,onOpenChange:r}),e.jsx(Ce,{open:!!g,onOpenChange:()=>b(null),children:e.jsxs(Ae,{children:[e.jsxs(ke,{children:[e.jsx(we,{children:t("remove.title")}),e.jsx(Pe,{children:t("remove.description")})]}),e.jsxs(Ee,{children:[e.jsx(Fe,{children:t("common:cancel")}),e.jsx(De,{onClick:re,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:t("remove.confirm")})]})]})})]})}export{it as SuppliersPage};
//# sourceMappingURL=index-DZQDFwac.js.map
