import{c as F,e as q,d as M,a as z,f as H,r,j as e,L as g,B as T,C as O,g as I,P as R,h as m,s as $}from"./index-ClGAhe1I.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],U=F("arrow-right",D);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],G=F("mail",Y);function K(){var C,S;const{t:n}=q(),h=M(),x=z(),{setCurrentTenant:b,setAvailableTenants:f}=H(),[t,y]=r.useState(null),[W,P]=r.useState(!0),[o,N]=r.useState(null),[d,c]=r.useState(!1),[j,i]=r.useState(null),[A,v]=r.useState(!1),[u,w]=r.useState("");r.useEffect(()=>{async function a(){try{const s=await m.get("/me");y(s),!s.needsOnboarding&&!s.needsTenantSelection&&s.tenants.length>0&&x("/",{replace:!0});const _=s.pendingInvitations||[];s.tenants.length===1&&_.length===0&&N(s.tenants[0].id)}catch(s){console.error("Failed to fetch status:",s),i("Failed to load your account status")}finally{P(!1)}}h.isAuthenticated&&a()},[h.isAuthenticated,x]);const L=async()=>{if(!(!o||!t)){c(!0),i(null);try{const a=t.tenants.find(s=>s.id===o);a&&(b(a),$(a.id),f(t.tenants)),await m.patch("/users/me",{defaultTenantId:o}),x("/",{replace:!0})}catch(a){console.error("Failed to select tenant:",a),i("Failed to select workspace. Please try again.")}finally{c(!1)}}},B=async a=>{c(!0),i(null);try{await m.post(`/invitations/${a}/accept`);const s=await m.get("/me");y(s)}catch(s){console.error("Failed to accept invitation:",s),i("Failed to accept invitation. Please try again.")}finally{c(!1)}},E=async a=>{if(a.preventDefault(),!!u.trim()){c(!0),i(null);try{const s=await m.post("/tenants",{name:u.trim()});b(s),f([...(t==null?void 0:t.tenants)||[],s]),x("/",{replace:!0})}catch(s){console.error("Failed to create tenant:",s),i("Failed to create workspace. Please try again.")}finally{c(!1)}}};if(W)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(g,{className:"h-8 w-8 animate-spin text-primary"})});const l=t==null?void 0:t.profile,p=((t==null?void 0:t.tenants.length)||0)>0,k=(((C=t==null?void 0:t.pendingInvitations)==null?void 0:C.length)||0)>0;return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx("header",{className:"border-b bg-card",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-6 w-6 text-primary"}),e.jsx("span",{className:"font-bold text-xl",children:"TadHub"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[l==null?void 0:l.firstName," ",l==null?void 0:l.lastName]})]})}),e.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8 max-w-2xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:n("onboarding.welcome","Welcome to TadHub")}),e.jsx("p",{className:"text-muted-foreground",children:p||k?n("onboarding.selectWorkspace","Select a workspace to continue"):n("onboarding.createWorkspace","Create your first workspace to get started")})]}),j&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-destructive/10 text-destructive text-sm",children:j}),k&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),n("onboarding.pendingInvitations","Pending Invitations")]}),e.jsx("div",{className:"space-y-3",children:(S=t==null?void 0:t.pendingInvitations)==null?void 0:S.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.tenantName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n("onboarding.invitedBy","Invited by {{name}} as {{role}}",{name:a.invitedByName,role:a.role})})]}),e.jsx("button",{onClick:()=>B(a.id),disabled:d,className:"px-4 py-2 rounded-lg bg-primary text-primary-foreground text-sm font-medium hover:bg-primary/90 disabled:opacity-50",children:n("onboarding.accept","Accept")})]},a.id))})]}),p&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),n("onboarding.yourWorkspaces","Your Workspaces")]}),e.jsx("div",{className:"space-y-3",children:t==null?void 0:t.tenants.map(a=>{var s;return e.jsxs("button",{onClick:()=>N(a.id),className:I("w-full flex items-center gap-4 p-4 rounded-lg border transition-colors text-start",o===a.id?"border-primary bg-primary/5":"bg-card hover:bg-muted"),children:[a.logo?e.jsx("img",{src:a.logo,alt:a.name,className:"h-10 w-10 rounded-lg object-cover"}):e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-primary/10 text-lg font-semibold text-primary",children:(s=a.name[0])==null?void 0:s.toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.slug})]}),o===a.id&&e.jsx(O,{className:"h-5 w-5 text-primary"})]},a.id)})}),o&&e.jsx("button",{onClick:L,disabled:d,className:"mt-4 w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg bg-primary text-primary-foreground font-medium hover:bg-primary/90 disabled:opacity-50",children:d?e.jsx(g,{className:"h-5 w-5 animate-spin"}):e.jsxs(e.Fragment,{children:[n("onboarding.continue","Continue"),e.jsx(U,{className:"h-5 w-5"})]})})]}),(t==null?void 0:t.canCreateTenant)&&e.jsxs("div",{children:[p&&e.jsxs("div",{className:"relative my-8",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"bg-background px-4 text-muted-foreground",children:n("onboarding.or","or")})})]}),A?e.jsxs("form",{onSubmit:E,className:"p-4 rounded-lg border bg-card",children:[e.jsx("h3",{className:"font-semibold mb-4",children:n("onboarding.newWorkspace","New Workspace")}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:n("onboarding.workspaceName","Workspace Name")}),e.jsx("input",{type:"text",value:u,onChange:a=>w(a.target.value),placeholder:n("onboarding.workspaceNamePlaceholder","e.g., My Company"),className:"w-full px-3 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{v(!1),w("")},className:"flex-1 px-4 py-2 rounded-lg border hover:bg-muted",children:n("onboarding.cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:d||!u.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground font-medium hover:bg-primary/90 disabled:opacity-50",children:d?e.jsx(g,{className:"h-5 w-5 animate-spin"}):n("onboarding.create","Create")})]})]}):e.jsxs("button",{onClick:()=>v(!0),className:I("w-full flex items-center justify-center gap-2 p-4 rounded-lg border-2 border-dashed transition-colors","hover:border-primary hover:bg-primary/5 text-muted-foreground hover:text-foreground"),children:[e.jsx(R,{className:"h-5 w-5"}),n("onboarding.createNew","Create a New Workspace")]})]})]})]})}export{K as OnboardingPage};
//# sourceMappingURL=index-BSaKxEb-.js.map
