import{c as ze,j as e,g as J,i as ge,A as He,m as Ke,l as X,d as M,r as y,a as ce,P as ne,X as ie,n as me,o as xe,t as fe,p as ve}from"./index-Cqouy3Yt.js";import{v as U,S as D,d as R,e as O,f as $,g as I,b as ye,c as Q,w as Qe,B as W,L as m,D as Ge,h as Xe,E as Je,i as We,j as oe,R as Ne,t as Ze,T as be,k as es,A as Se,l as Ce,m as we,n as Ee,o as ke,p as Te,q as Pe,r as Ae,I as L}from"./label-DwNxcReA.js";import{B}from"./button-C8-5F-AC.js";import{a as ss,b as as,u as pe,g as re,B as ls}from"./index-C2uTH2Od.js";import{C as ts,a as ns,b as is,E as rs,c as N,d as b,e as k,f as S,I as cs,V as ds}from"./card-BUUw-53B.js";import{D as os,a as us,b as hs,c as ms,d as xs,e as ps,T as js,f as gs,g as ae,h as le}from"./dialog-BgCayfk_.js";import{a as Le}from"./hooks-kuV7fTZo.js";import{F as he}from"./file-text-vaYRguJE.js";import{P as fs}from"./pencil-BP9XdQ27.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ys=ze("upload",vs);function Ie({value:s,onChange:n,disabled:t,placeholder:a="Select job category",showCode:u=!1,className:o,error:j,id:c,name:h}){const{data:l,isLoading:w,isError:E}=ss(),T=v=>{const A=l==null?void 0:l.find(x=>x.id===v);n==null||n(v,A)},f=l==null?void 0:l.find(v=>v.id===s);return w?e.jsx(U,{className:"h-10 w-full"}):E?e.jsx(D,{disabled:!0,children:e.jsx(R,{className:o,children:e.jsx(O,{placeholder:"Failed to load categories"})})}):e.jsxs(D,{value:s,onValueChange:T,disabled:t,name:h,children:[e.jsx(R,{id:c,className:`${o} ${j?"border-red-500":""}`,children:e.jsx(O,{placeholder:a,children:f&&e.jsxs("span",{children:[u&&e.jsx("span",{className:"font-mono text-muted-foreground me-2",children:f.moHRECode}),f.nameEn]})})}),e.jsx($,{children:l==null?void 0:l.map(v=>e.jsxs(I,{value:v.id,children:[u&&e.jsx("span",{className:"font-mono text-muted-foreground me-2",children:v.moHRECode}),v.nameEn]},v.id))})]})}function Fe({value:s,onChange:n,disabled:t,placeholder:a="Select nationality",commonOnly:u=!1,showFlag:o=!0,valueType:j="id",className:c,error:h,id:l,name:w}){const E=as(),T=pe(),{data:f,isLoading:v,isError:A}=u?E:T,x=d=>j==="name"?d.nameEn:d.id,C=d=>{const _=f==null?void 0:f.find(r=>x(r)===d);n==null||n(d,_)},g=f==null?void 0:f.find(d=>x(d)===s);return v?e.jsx(U,{className:"h-10 w-full"}):A?e.jsx(D,{disabled:!0,children:e.jsx(R,{className:c,children:e.jsx(O,{placeholder:"Failed to load nationalities"})})}):e.jsxs(D,{value:s,onValueChange:C,disabled:t,name:w,children:[e.jsx(R,{id:l,className:`${c} ${h?"border-red-500":""}`,children:e.jsx(O,{placeholder:a,children:g&&e.jsxs("span",{className:"flex items-center gap-2",children:[o&&e.jsx("span",{className:"text-lg",children:re(g.code)}),e.jsx("span",{children:g.nameEn})]})})}),e.jsx($,{children:f==null?void 0:f.map(d=>e.jsx(I,{value:x(d),children:e.jsxs("span",{className:"flex items-center gap-2",children:[o&&e.jsx("span",{className:"text-lg",children:re(d.code)}),e.jsx("span",{children:d.nameEn})]})},d.id))})]})}function z(s){return`/tenants/${ge()}${s}`}function Ns(s){return J.getPaged(z("/candidates"),s)}function bs(s,n){return J.get(z(`/candidates/${s}`),n)}function Ss(s){return J.post(z("/candidates"),s)}function Cs(s,n){return J.patch(z(`/candidates/${s}`),n)}function ws(s,n){return J.post(z(`/candidates/${s}/status`),n)}function Es(s){return J.delete(z(`/candidates/${s}`))}async function de(s,n,t){const a=ge(),u=new FormData;u.append("file",n);const o=Ke(),j=await fetch(`${He}${s}`,{method:"POST",headers:{...o?{Authorization:`Bearer ${o}`}:{},"X-Tenant-ID":a||""},body:u});if(!j.ok){const h=await j.json().catch(()=>({}));throw new Error(h.error||t)}const c=await j.json();return c.data??c}function ks(s,n){return de(z(`/candidates/${s}/photo`),n,"Photo upload failed")}function Ts(s,n){return de(z(`/candidates/${s}/video`),n,"Video upload failed")}function Ps(s,n){return de(z(`/candidates/${s}/passport`),n,"Passport upload failed")}function As(s,n){return de(z(`/files?fileType=${n}`),s,"File upload failed")}const H="candidates";function Ls(s){return ye({queryKey:[H,s],queryFn:()=>Ns({...s,include:"supplier"})})}function De(s){return ye({queryKey:[H,s],queryFn:()=>bs(s,{include:"statusHistory,supplier"}),enabled:!!s})}function Is(){const s=X();return Q({mutationFn:n=>Ss(n),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Fs(){const s=X();return Q({mutationFn:({id:n,data:t})=>Cs(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Ds(){const s=X();return Q({mutationFn:({id:n,data:t})=>ws(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Re(){const s=X();return Q({mutationFn:n=>Es(n),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Rs(){const s=X();return Q({mutationFn:({id:n,file:t})=>ks(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Os(){const s=X();return Q({mutationFn:({id:n,file:t})=>Ts(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Us(){const s=X();return Q({mutationFn:({id:n,file:t})=>Ps(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function $s(){return Q({mutationFn:({file:s,fileType:n})=>As(s,n)})}const Oe={Received:{variant:"secondary",icon:is},UnderReview:{variant:"warning",icon:Qe},Approved:{variant:"success",icon:ns},Rejected:{variant:"destructive",icon:ts},Cancelled:{variant:"secondary",icon:ls}},Bs=["Received","UnderReview","Approved","Rejected","Cancelled"],je=["Supplier","Local"],Ue={Received:["UnderReview","Cancelled"],UnderReview:["Approved","Rejected","Cancelled"]},te=["Cooking","Cleaning","Childcare","Eldercare","Laundry","Ironing","Driving"],ue=["Arabic","English","Hindi","Urdu","Tagalog","Sinhala","Bengali","Nepali","Indonesian","Amharic"],_s=["Basic","Intermediate","Advanced","Expert"],Vs=["Basic","Conversational","Fluent","Native"],$e=["Islam","Christianity","Hinduism","Buddhism","Other"],Be=["Single","Married","Divorced","Widowed"],_e=["None","Primary","Secondary","HighSchool","Diploma","Bachelor","Master","PhD"];function ee({status:s,showIcon:n=!0,className:t}){const{t:a}=M("candidates"),u=Oe[s];if(!u)return e.jsx(W,{variant:"outline",children:s});const o=u.icon;return e.jsxs(W,{variant:u.variant,className:t,children:[n&&e.jsx(o,{className:"me-1 h-3 w-3"}),a(`status.${s}`)]})}const Ys=["Rejected","Cancelled"];function Ve({open:s,onOpenChange:n,candidateId:t,currentStatus:a}){const{t:u}=M("candidates"),[o,j]=y.useState(""),[c,h]=y.useState(""),[l,w]=y.useState(""),E=Ds(),T=Ys.includes(o),f=o&&(!T||c.trim()),v=Ue[a]??[],A=async()=>{f&&(await E.mutateAsync({id:t,data:{status:o,reason:c.trim()||void 0,notes:l.trim()||void 0}}),j(""),h(""),w(""),n(!1))},x=C=>{C||(j(""),h(""),w("")),n(C)};return e.jsx(os,{open:s,onOpenChange:x,children:e.jsxs(us,{children:[e.jsxs(hs,{children:[e.jsx(ms,{children:u("transition.title")}),e.jsx(xs,{children:u("transition.description")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:u("transition.currentStatus")}),e.jsx("div",{children:e.jsx(ee,{status:a})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:u("transition.targetStatus")}),e.jsxs(D,{value:o,onValueChange:j,children:[e.jsx(R,{children:e.jsx(O,{placeholder:u("transition.targetStatusPlaceholder")})}),e.jsx($,{children:v.map(C=>e.jsx(I,{value:C,children:e.jsx(ee,{status:C})},C))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{children:[u("transition.reason"),T&&e.jsx("span",{className:"text-destructive",children:" *"})]}),e.jsx("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:u("transition.reasonPlaceholder"),value:c,onChange:C=>h(C.target.value)}),T&&!c.trim()&&e.jsx("p",{className:"text-sm text-destructive",children:u("transition.reasonRequired")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:u("transition.notes")}),e.jsx("textarea",{className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:u("transition.notesPlaceholder"),value:l,onChange:C=>w(C.target.value)})]})]}),e.jsxs(ps,{children:[e.jsx(B,{variant:"outline",onClick:()=>x(!1),children:u("common:cancel")}),e.jsx(B,{onClick:A,disabled:!f||E.isPending,children:E.isPending?u("transition.submitting"):u("transition.submit")})]})]})})}function sa(){const{t:s}=M("candidates"),n=ce(),[t,a]=y.useState(""),[u,o]=y.useState(1),[j,c]=y.useState(20),[h,l]=y.useState([]),[w,E]=y.useState(),[T,f]=y.useState(),[v,A]=y.useState(null),[x,C]=y.useState(null),g=y.useMemo(()=>({page:u,pageSize:j,search:t||void 0,sort:"-createdAt","filter[status]":w,"filter[sourceType]":T}),[u,j,t,w,T]),{data:d,isLoading:_,refetch:r}=Ls(g),{data:P}=pe(),i=Re(),V=p=>{if(!p)return"—";const q=P==null?void 0:P.find(Me=>Me.code===p);return(q==null?void 0:q.nameEn)??p},Y=async()=>{v&&(await i.mutateAsync(v.id),A(null))},K=[{key:"status",label:s("filters.status"),options:Bs.map(p=>({label:s(`status.${p}`),value:p})),value:w},{key:"sourceType",label:s("filters.sourceType"),options:je.map(p=>({label:s(`sourceType.${p}`),value:p})),value:T}],se=(p,q)=>{p==="status"&&E(q),p==="sourceType"&&f(q),o(1)},G=[{key:"name",header:s("columns.name"),cell:p=>e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[p.photoUrl?e.jsx("img",{src:p.photoUrl,alt:"",className:"h-8 w-8 rounded-full object-cover border shrink-0"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-xs font-medium shrink-0",children:p.fullNameEn.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:p.fullNameEn}),p.fullNameAr&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:p.fullNameAr})]})]})},{key:"nationality",header:s("columns.nationality"),cell:p=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[p.nationality&&e.jsx("span",{className:"text-lg leading-none",children:re(p.nationality)}),e.jsx("span",{children:V(p.nationality)})]})},{key:"sourceType",header:s("columns.sourceType"),cell:p=>s(`sourceType.${p.sourceType}`)},{key:"supplier",header:s("columns.supplier"),cell:p=>{var q;return((q=p.supplier)==null?void 0:q.name)??"—"}},{key:"jobCategory",header:s("columns.jobCategory"),cell:p=>{var q;return((q=p.jobCategory)==null?void 0:q.name)??"—"}},{key:"status",header:s("columns.status"),cell:p=>e.jsx(ee,{status:p.status})},{key:"createdAt",header:s("columns.createdAt"),cell:p=>new Date(p.createdAt).toLocaleDateString()},{key:"actions",header:s("columns.actions"),className:"w-[70px]",cell:p=>e.jsxs(Ge,{children:[e.jsx(Xe,{asChild:!0,children:e.jsx(B,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(Je,{className:"h-4 w-4"})})}),e.jsxs(We,{align:"end",children:[e.jsxs(oe,{onClick:()=>n(`/candidates/${p.id}`),children:[e.jsx(rs,{className:"me-2 h-4 w-4"}),s("actions.view")]}),e.jsxs(oe,{onClick:()=>C(p),children:[e.jsx(Ne,{className:"me-2 h-4 w-4"}),s("actions.changeStatus")]}),e.jsx(Ze,{}),e.jsxs(oe,{className:"text-destructive",onClick:()=>A(p),children:[e.jsx(be,{className:"me-2 h-4 w-4"}),s("actions.delete")]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("title")}),e.jsx("p",{className:"text-muted-foreground",children:s("description")})]}),e.jsx(es,{columns:G,data:(d==null?void 0:d.items)??[],isLoading:_,selectable:!0,selectedIds:h,onSelectionChange:l,searchPlaceholder:s("searchPlaceholder"),searchValue:t,onSearchChange:p=>{a(p),o(1)},filters:K,onFilterChange:se,page:u,totalPages:d==null?void 0:d.totalPages,total:d==null?void 0:d.totalCount,pageSize:j,onPageChange:o,onPageSizeChange:c,onRefresh:()=>r(),emptyVariant:"default",emptyTitle:s("empty.title"),emptyDescription:s("empty.description"),emptyAction:e.jsxs(B,{onClick:()=>n("/candidates/new"),children:[e.jsx(ne,{className:"me-2 h-4 w-4"}),s("addCandidate")]}),actions:e.jsxs(B,{onClick:()=>n("/candidates/new"),children:[e.jsx(ne,{className:"me-2 h-4 w-4"}),s("addCandidate")]})}),x&&e.jsx(Ve,{open:!!x,onOpenChange:p=>{p||C(null)},candidateId:x.id,currentStatus:x.status}),e.jsx(Se,{open:!!v,onOpenChange:()=>A(null),children:e.jsxs(Ce,{children:[e.jsxs(we,{children:[e.jsx(Ee,{children:s("deleteDialog.title")}),e.jsx(ke,{children:s("deleteDialog.description")})]}),e.jsxs(Te,{children:[e.jsx(Pe,{children:s("common:cancel")}),e.jsx(Ae,{onClick:Y,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("deleteDialog.confirm")})]})]})})]})}function Ye({skills:s,onChange:n}){const{t}=M("candidates"),a=()=>{n([...s,{skillName:"",proficiencyLevel:"Basic"}])},u=c=>{n(s.filter((h,l)=>l!==c))},o=(c,h,l)=>{const w=s.map((E,T)=>T===c?{...E,[h]:l}:E);n(w)},j=new Set(s.map(c=>c.skillName));return e.jsxs("div",{className:"space-y-3",children:[s.map((c,h)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(D,{value:te.includes(c.skillName)?c.skillName:"__custom",onValueChange:l=>{l==="__custom"?o(h,"skillName",""):o(h,"skillName",l)},children:[e.jsx(R,{children:e.jsx(O,{placeholder:t("skills.selectSkill")})}),e.jsxs($,{children:[te.filter(l=>!j.has(l)||l===c.skillName).map(l=>e.jsx(I,{value:l,children:t(`skills.presets.${l}`,l)},l)),e.jsx(I,{value:"__custom",children:t("skills.custom")})]})]})}),!te.includes(c.skillName)&&c.skillName!==""&&e.jsx(L,{className:"flex-1",value:c.skillName,onChange:l=>o(h,"skillName",l.target.value),placeholder:t("skills.customPlaceholder")}),!te.includes(c.skillName)&&c.skillName===""&&e.jsx(L,{className:"flex-1",value:"",onChange:l=>o(h,"skillName",l.target.value),placeholder:t("skills.customPlaceholder")}),e.jsx("div",{className:"w-40",children:e.jsxs(D,{value:c.proficiencyLevel,onValueChange:l=>o(h,"proficiencyLevel",l),children:[e.jsx(R,{children:e.jsx(O,{})}),e.jsx($,{children:_s.map(l=>e.jsx(I,{value:l,children:t(`skills.proficiency.${l}`,l)},l))})]})}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>u(h),children:e.jsx(ie,{className:"h-4 w-4"})})]},h)),e.jsxs(B,{type:"button",variant:"outline",size:"sm",onClick:a,children:[e.jsx(ne,{className:"me-1 h-4 w-4"}),t("skills.add")]})]})}function qe({languages:s,onChange:n}){const{t}=M("candidates"),a=()=>{n([...s,{language:"",proficiencyLevel:"Basic"}])},u=c=>{n(s.filter((h,l)=>l!==c))},o=(c,h,l)=>{const w=s.map((E,T)=>T===c?{...E,[h]:l}:E);n(w)},j=new Set(s.map(c=>c.language));return e.jsxs("div",{className:"space-y-3",children:[s.map((c,h)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(D,{value:ue.includes(c.language)?c.language:"__custom",onValueChange:l=>{l==="__custom"?o(h,"language",""):o(h,"language",l)},children:[e.jsx(R,{children:e.jsx(O,{placeholder:t("languages.selectLanguage")})}),e.jsxs($,{children:[ue.filter(l=>!j.has(l)||l===c.language).map(l=>e.jsx(I,{value:l,children:t(`languages.presets.${l}`,l)},l)),e.jsx(I,{value:"__custom",children:t("languages.custom")})]})]})}),!ue.includes(c.language)&&e.jsx(L,{className:"flex-1",value:c.language,onChange:l=>o(h,"language",l.target.value),placeholder:t("languages.customPlaceholder")}),e.jsx("div",{className:"w-40",children:e.jsxs(D,{value:c.proficiencyLevel,onValueChange:l=>o(h,"proficiencyLevel",l),children:[e.jsx(R,{children:e.jsx(O,{})}),e.jsx($,{children:Vs.map(l=>e.jsx(I,{value:l,children:t(`languages.proficiency.${l}`,l)},l))})]})}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>u(h),children:e.jsx(ie,{className:"h-4 w-4"})})]},h)),e.jsxs(B,{type:"button",variant:"outline",size:"sm",onClick:a,children:[e.jsx(ne,{className:"me-1 h-4 w-4"}),t("languages.add")]})]})}function Z({accept:s,maxSizeMB:n,currentUrl:t,onUpload:a,isPending:u,type:o,mode:j="immediate",onFileSelected:c}){const{t:h}=M("candidates"),l=y.useRef(null),[w,E]=y.useState(""),[T,f]=y.useState(null),[v,A]=y.useState(null),x=async d=>{var r;const _=(r=d.target.files)==null?void 0:r[0];if(_){if(E(""),_.size>n*1024*1024){E(h("fileUpload.tooLarge",{max:n}));return}if(o==="photo"?f(URL.createObjectURL(_)):o==="document"&&A(_.name),j==="deferred"&&c)c(_);else try{await a(_)}catch(P){E(P instanceof Error?P.message:h("fileUpload.failed"))}l.current&&(l.current.value="")}},C=()=>{f(null),A(null),j==="deferred"&&c&&c(void 0)},g=T||t;return e.jsxs("div",{className:"space-y-2",children:[g&&o==="photo"&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:g,alt:"Preview",className:"h-32 w-32 rounded-lg object-cover border"}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-background shadow",onClick:C,children:e.jsx(ie,{className:"h-3 w-3"})})]}),g&&o==="video"&&e.jsx("video",{src:g,controls:!0,className:"h-48 max-w-full rounded-lg border"}),o==="document"&&(t||v)&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border p-3",children:[e.jsx(he,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate flex-1",children:v||h("fileUpload.documentUploaded")}),t&&!v&&e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:h("fileUpload.viewDocument")}),e.jsx(B,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,children:e.jsx(ie,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:l,type:"file",accept:s,className:"hidden",onChange:x}),e.jsxs(B,{type:"button",variant:"outline",size:"sm",disabled:u,onClick:()=>{var d;return(d=l.current)==null?void 0:d.click()},children:[e.jsx(ys,{className:"me-1 h-4 w-4"}),h(u?"fileUpload.uploading":t||v?"fileUpload.replace":"fileUpload.upload")]})]}),w&&e.jsx("p",{className:"text-sm text-destructive",children:w})]})}const qs={fullNameEn:"",fullNameAr:"",nationality:"",dateOfBirth:"",gender:"",passportNumber:"",passportExpiry:"",phone:"",email:"",sourceType:"",tenantSupplierId:"",religion:"",maritalStatus:"",educationLevel:"",jobCategoryId:"",experienceYears:"",monthlySalary:"",notes:"",externalReference:""};function aa(){var _;const{t:s}=M("candidates"),n=ce(),[t,a]=y.useState(qs),[u,o]=y.useState([]),[j,c]=y.useState([]),[h,l]=y.useState(null),[w,E]=y.useState(null),T=Is(),f=$s(),v=t.sourceType==="Supplier",{data:A}=Le({pageSize:100}),x=(r,P)=>{a(i=>({...i,[r]:P}))},[C,g]=y.useState(!1),d=async r=>{if(r.preventDefault(),!(!t.fullNameEn.trim()||!t.sourceType)){g(!0);try{const P=u.filter(Y=>Y.skillName.trim()),i=j.filter(Y=>Y.language.trim()),V=await T.mutateAsync({fullNameEn:t.fullNameEn.trim(),fullNameAr:t.fullNameAr.trim()||void 0,nationality:t.nationality||void 0,dateOfBirth:t.dateOfBirth||void 0,gender:t.gender||void 0,passportNumber:t.passportNumber.trim()||void 0,passportExpiry:t.passportExpiry||void 0,phone:t.phone.trim()||void 0,email:t.email.trim()||void 0,sourceType:t.sourceType,tenantSupplierId:v&&t.tenantSupplierId?t.tenantSupplierId:void 0,religion:t.religion||void 0,maritalStatus:t.maritalStatus||void 0,educationLevel:t.educationLevel||void 0,jobCategoryId:t.jobCategoryId||void 0,experienceYears:t.experienceYears?parseInt(t.experienceYears):void 0,monthlySalary:t.monthlySalary?parseFloat(t.monthlySalary):void 0,skills:P.length>0?P:void 0,languages:i.length>0?i:void 0,photoFileId:h||void 0,passportFileId:w||void 0,notes:t.notes.trim()||void 0,externalReference:t.externalReference.trim()||void 0});n(`/candidates/${V.id}`)}catch(P){const i=P instanceof Error?P.message:"Failed to create candidate";fe.error(i)}finally{g(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:"/candidates",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("create.backToList")]}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("create.title")})]}),e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.personal")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"fullNameEn",children:[s("create.fullNameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(L,{id:"fullNameEn",value:t.fullNameEn,onChange:r=>x("fullNameEn",r.target.value),placeholder:s("create.fullNameEnPlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"fullNameAr",children:s("create.fullNameAr")}),e.jsx(L,{id:"fullNameAr",value:t.fullNameAr,onChange:r=>x("fullNameAr",r.target.value),placeholder:s("create.fullNameArPlaceholder"),dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.nationality")}),e.jsx(Fe,{value:t.nationality,onChange:r=>x("nationality",r),placeholder:s("create.nationalityPlaceholder"),valueType:"name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"dateOfBirth",children:s("create.dateOfBirth")}),e.jsx(L,{id:"dateOfBirth",type:"date",value:t.dateOfBirth,onChange:r=>x("dateOfBirth",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.gender")}),e.jsxs(D,{value:t.gender,onValueChange:r=>x("gender",r),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.genderPlaceholder")})}),e.jsxs($,{children:[e.jsx(I,{value:"Male",children:s("create.genderOptions.Male")}),e.jsx(I,{value:"Female",children:s("create.genderOptions.Female")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"passportNumber",children:s("create.passportNumber")}),e.jsx(L,{id:"passportNumber",value:t.passportNumber,onChange:r=>x("passportNumber",r.target.value),placeholder:s("create.passportNumberPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"passportExpiry",children:s("create.passportExpiry")}),e.jsx(L,{id:"passportExpiry",type:"date",value:t.passportExpiry,onChange:r=>x("passportExpiry",r.target.value)})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.contact")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",children:s("create.phone")}),e.jsx(L,{id:"phone",value:t.phone,onChange:r=>x("phone",r.target.value),placeholder:s("create.phonePlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:s("create.email")}),e.jsx(L,{id:"email",type:"email",value:t.email,onChange:r=>x("email",r.target.value),placeholder:s("create.emailPlaceholder")})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.sourcing")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{children:[s("create.sourceType")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(D,{value:t.sourceType,onValueChange:r=>{x("sourceType",r),r!=="Supplier"&&x("tenantSupplierId","")},children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.sourceTypePlaceholder")})}),e.jsx($,{children:je.map(r=>e.jsx(I,{value:r,children:s(`sourceType.${r}`)},r))})]})]}),v&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.supplier")}),e.jsxs(D,{value:t.tenantSupplierId,onValueChange:r=>x("tenantSupplierId",r),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.supplierPlaceholder")})}),e.jsx($,{children:(_=A==null?void 0:A.items)==null?void 0:_.map(r=>{var P;return e.jsx(I,{value:r.id,children:((P=r.supplier)==null?void 0:P.nameEn)??r.id},r.id)})})]})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.professional")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.religion")}),e.jsxs(D,{value:t.religion,onValueChange:r=>x("religion",r),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.religionPlaceholder")})}),e.jsx($,{children:$e.map(r=>e.jsx(I,{value:r,children:s(`professional.religion.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.maritalStatus")}),e.jsxs(D,{value:t.maritalStatus,onValueChange:r=>x("maritalStatus",r),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.maritalStatusPlaceholder")})}),e.jsx($,{children:Be.map(r=>e.jsx(I,{value:r,children:s(`professional.maritalStatus.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.educationLevel")}),e.jsxs(D,{value:t.educationLevel,onValueChange:r=>x("educationLevel",r),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.educationLevelPlaceholder")})}),e.jsx($,{children:_e.map(r=>e.jsx(I,{value:r,children:s(`professional.educationLevel.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.jobCategory")}),e.jsx(Ie,{value:t.jobCategoryId,onChange:r=>x("jobCategoryId",r),placeholder:s("create.jobCategoryPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"experienceYears",children:s("create.experienceYears")}),e.jsx(L,{id:"experienceYears",type:"number",min:"0",max:"50",value:t.experienceYears,onChange:r=>x("experienceYears",r.target.value),placeholder:s("create.experienceYearsPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"monthlySalary",children:s("create.monthlySalary")}),e.jsx(L,{id:"monthlySalary",type:"number",min:"0",step:"0.01",value:t.monthlySalary,onChange:r=>x("monthlySalary",r.target.value),placeholder:s("create.monthlySalaryPlaceholder")})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.skills")})}),e.jsx(S,{children:e.jsx(Ye,{skills:u,onChange:o})})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.languages")})}),e.jsx(S,{children:e.jsx(qe,{languages:j,onChange:c})})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.media")})}),e.jsxs(S,{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.photo")}),e.jsx(Z,{accept:"image/jpeg,image/png,image/webp",maxSizeMB:5,type:"photo",isPending:f.isPending,onUpload:async r=>{const P=await f.mutateAsync({file:r,fileType:"photo"});l(P.id)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.passport")}),e.jsx(Z,{accept:"application/pdf,image/jpeg,image/png",maxSizeMB:10,type:"document",isPending:f.isPending,onUpload:async r=>{const P=await f.mutateAsync({file:r,fileType:"passport"});E(P.id)}})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.additional")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"externalReference",children:s("create.externalReference")}),e.jsx(L,{id:"externalReference",value:t.externalReference,onChange:r=>x("externalReference",r.target.value),placeholder:s("create.externalReferencePlaceholder")})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(m,{htmlFor:"notes",children:s("create.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:t.notes,onChange:r=>x("notes",r.target.value),placeholder:s("create.notesPlaceholder")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>n("/candidates"),children:s("common:cancel")}),e.jsx(B,{type:"submit",disabled:!t.fullNameEn.trim()||!t.sourceType||C,children:s(C?"create.submitting":"create.submit")})]})]})]})}function Ms({history:s}){const{t:n}=M("candidates");if(!s||s.length===0)return null;const t=[...s].sort((a,u)=>new Date(u.changedAt).getTime()-new Date(a.changedAt).getTime());return e.jsx("div",{className:"space-y-4",children:t.map((a,u)=>{const o=Oe[a.toStatus],j=o==null?void 0:o.icon,c=u===t.length-1;return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full border-2 bg-background",children:j&&e.jsx(j,{className:"h-4 w-4 text-muted-foreground"})}),u<t.length-1&&e.jsx("div",{className:"w-px flex-1 bg-border"})]}),e.jsxs("div",{className:"pb-6 pt-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:c&&!a.fromStatus?e.jsx("p",{className:"text-sm font-medium",children:n("timeline.initialStatus")}):e.jsxs("p",{className:"text-sm font-medium",children:[n("timeline.changedTo")," ",e.jsx(ee,{status:a.toStatus})]})}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:new Date(a.changedAt).toLocaleString()}),a.reason&&e.jsxs("p",{className:"mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"font-medium",children:[n("timeline.reason"),":"]})," ",a.reason]}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:a.notes})]})]},a.id)})})}function F({label:s,value:n}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s}),e.jsx("p",{className:"font-medium",children:n!=null&&n!==""?String(n):"—"})]})}function zs(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(U,{className:"h-4 w-32 mb-4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-8 w-64"}),e.jsx(U,{className:"h-6 w-24"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-9 w-32"}),e.jsx(U,{className:"h-9 w-32"})]})]})]}),e.jsx(U,{className:"h-10 w-96"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(U,{className:"h-6 w-40"})}),e.jsx(S,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:6}).map((s,n)=>e.jsxs("div",{children:[e.jsx(U,{className:"h-4 w-24 mb-1"}),e.jsx(U,{className:"h-5 w-40"})]},n))})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(U,{className:"h-6 w-36"})}),e.jsx(S,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:2}).map((s,n)=>e.jsxs("div",{children:[e.jsx(U,{className:"h-4 w-24 mb-1"}),e.jsx(U,{className:"h-5 w-40"})]},n))})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(U,{className:"h-6 w-36"})}),e.jsx(S,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:3}).map((s,n)=>e.jsxs("div",{children:[e.jsx(U,{className:"h-4 w-24 mb-1"}),e.jsx(U,{className:"h-5 w-40"})]},n))})]})]})]})}function la(){var A,x,C;const{t:s}=M("candidates"),{id:n}=ve(),t=ce(),{data:a,isLoading:u}=De(n),{data:o}=pe(),j=Re(),[c,h]=y.useState(!1),[l,w]=y.useState(!1),E=g=>{if(!g)return;const d=o==null?void 0:o.find(_=>_.code===g||_.nameEn===g);return d?`${re(d.code)} ${d.nameEn}`:g},T=async()=>{n&&(await j.mutateAsync(n),t("/candidates"))};if(u)return e.jsx(zs,{});if(!a)return e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("common:noResults")})});const f=a.status==="Received"||a.status==="UnderReview",v=(((A=Ue[a.status])==null?void 0:A.length)??0)>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:"/candidates",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("detail.backToList")]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.photoUrl&&e.jsx("img",{src:a.photoUrl,alt:a.fullNameEn,className:"h-12 w-12 rounded-full object-cover border"}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a.fullNameEn}),e.jsx(ee,{status:a.status})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[f&&e.jsxs(B,{variant:"outline",onClick:()=>t(`/candidates/${n}/edit`),children:[e.jsx(fs,{className:"me-2 h-4 w-4"}),s("actions.edit")]}),v&&e.jsxs(B,{variant:"outline",onClick:()=>h(!0),children:[e.jsx(Ne,{className:"me-2 h-4 w-4"}),s("actions.changeStatus")]}),e.jsxs(B,{variant:"destructive",onClick:()=>w(!0),children:[e.jsx(be,{className:"me-2 h-4 w-4"}),s("actions.delete")]})]})]})]}),e.jsxs(js,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(gs,{children:[e.jsx(ae,{value:"overview",children:s("tabs.overview")}),e.jsx(ae,{value:"professional",children:s("tabs.professional")}),e.jsx(ae,{value:"documentsOperations",children:s("tabs.documentsOperations")}),e.jsxs(ae,{value:"statusHistory",children:[s("tabs.statusHistory"),a.statusHistory&&e.jsx(W,{variant:"secondary",className:"ms-2",children:a.statusHistory.length})]})]}),e.jsx(le,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.personal")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:s("detail.fullNameEn"),value:a.fullNameEn}),e.jsx(F,{label:s("detail.fullNameAr"),value:a.fullNameAr}),e.jsx(F,{label:s("detail.nationality"),value:E(a.nationality)}),e.jsx(F,{label:s("detail.dateOfBirth"),value:a.dateOfBirth}),e.jsx(F,{label:s("detail.gender"),value:a.gender}),e.jsx(F,{label:s("detail.passportNumber"),value:a.passportNumber}),e.jsx(F,{label:s("detail.passportExpiry"),value:a.passportExpiry})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.contact")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:s("detail.phone"),value:a.phone}),e.jsx(F,{label:s("detail.email"),value:a.email})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.sourcing")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:s("detail.sourceType"),value:s(`sourceType.${a.sourceType}`)}),e.jsx(F,{label:s("detail.supplier"),value:(x=a.supplier)==null?void 0:x.name}),e.jsx(F,{label:s("detail.externalReference"),value:a.externalReference})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.media")})}),e.jsx(S,{children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.photo")}),a.photoUrl?e.jsx("img",{src:a.photoUrl,alt:a.fullNameEn,className:"h-40 w-40 rounded-lg object-cover border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(cs,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.video")}),a.videoUrl?e.jsx("video",{src:a.videoUrl,controls:!0,className:"h-40 max-w-full rounded-lg border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(ds,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.passportDocument")}),a.passportDocumentUrl?e.jsxs("a",{href:a.passportDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"h-40 w-40 rounded-lg border flex flex-col items-center justify-center gap-2 hover:bg-muted/50 transition-colors",children:[e.jsx(he,{className:"h-10 w-10 text-primary"}),e.jsx("span",{className:"text-sm text-primary font-medium",children:s("detail.viewPassportDocument")})]}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(he,{className:"h-8 w-8 text-muted-foreground/50"})})]})]})})]})]})}),e.jsx(le,{value:"professional",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.professionalProfile")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:s("detail.religion"),value:a.religion?s(`professional.religion.${a.religion}`,a.religion):void 0}),e.jsx(F,{label:s("detail.maritalStatus"),value:a.maritalStatus?s(`professional.maritalStatus.${a.maritalStatus}`,a.maritalStatus):void 0}),e.jsx(F,{label:s("detail.educationLevel"),value:a.educationLevel?s(`professional.educationLevel.${a.educationLevel}`,a.educationLevel):void 0}),e.jsx(F,{label:s("detail.jobCategory"),value:(C=a.jobCategory)==null?void 0:C.name}),e.jsx(F,{label:s("detail.experienceYears"),value:a.experienceYears}),e.jsx(F,{label:s("detail.monthlySalary"),value:a.monthlySalary?`${a.monthlySalary} AED`:void 0})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.skills")})}),e.jsx(S,{children:a.skills&&a.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.skills.map(g=>e.jsxs(W,{variant:"outline",children:[g.skillName," — ",s(`skills.proficiency.${g.proficiencyLevel}`,g.proficiencyLevel)]},g.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.languages")})}),e.jsx(S,{children:a.languages&&a.languages.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.languages.map(g=>e.jsxs(W,{variant:"outline",children:[g.language," — ",s(`languages.proficiency.${g.proficiencyLevel}`,g.proficiencyLevel)]},g.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]})]})}),e.jsx(le,{value:"documentsOperations",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.operational")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(F,{label:s("detail.createdAt"),value:new Date(a.createdAt).toLocaleString()}),e.jsx(F,{label:s("detail.updatedAt"),value:new Date(a.updatedAt).toLocaleString()}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(F,{label:s("detail.notes"),value:a.notes})})]})]})})}),e.jsx(le,{value:"statusHistory",className:"space-y-6",children:a.statusHistory&&a.statusHistory.length>0?e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("detail.statusHistory")})}),e.jsx(S,{children:e.jsx(Ms,{history:a.statusHistory})})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[20vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("detail.notAvailable")})})})]}),e.jsx(Ve,{open:c,onOpenChange:h,candidateId:a.id,currentStatus:a.status}),e.jsx(Se,{open:l,onOpenChange:w,children:e.jsxs(Ce,{children:[e.jsxs(we,{children:[e.jsx(Ee,{children:s("deleteDialog.title")}),e.jsx(ke,{children:s("deleteDialog.description")})]}),e.jsxs(Te,{children:[e.jsx(Pe,{children:s("common:cancel")}),e.jsx(Ae,{onClick:T,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("deleteDialog.confirm")})]})]})})]})}function ta(){var P;const{t:s}=M("candidates"),{id:n}=ve(),t=ce(),{data:a,isLoading:u}=De(n),o=Fs(),j=Rs(),c=Os(),h=Us(),[l,w]=y.useState({fullNameEn:"",fullNameAr:"",nationality:"",dateOfBirth:"",gender:"",passportNumber:"",passportExpiry:"",phone:"",email:"",sourceType:"",tenantSupplierId:"",religion:"",maritalStatus:"",educationLevel:"",jobCategoryId:"",experienceYears:"",monthlySalary:"",notes:"",externalReference:""}),[E,T]=y.useState([]),[f,v]=y.useState([]),[A,x]=y.useState(!1),C=l.sourceType==="Supplier",{data:g}=Le({pageSize:100});y.useEffect(()=>{var i,V,Y,K,se;a&&!A&&(w({fullNameEn:a.fullNameEn||"",fullNameAr:a.fullNameAr||"",nationality:a.nationality||"",dateOfBirth:a.dateOfBirth||"",gender:a.gender||"",passportNumber:a.passportNumber||"",passportExpiry:a.passportExpiry||"",phone:a.phone||"",email:a.email||"",sourceType:a.sourceType||"",tenantSupplierId:a.tenantSupplierId||"",religion:a.religion||"",maritalStatus:a.maritalStatus||"",educationLevel:a.educationLevel||"",jobCategoryId:((i=a.jobCategory)==null?void 0:i.id)||a.jobCategoryId||"",experienceYears:((V=a.experienceYears)==null?void 0:V.toString())||"",monthlySalary:((Y=a.monthlySalary)==null?void 0:Y.toString())||"",notes:a.notes||"",externalReference:a.externalReference||""}),T(((K=a.skills)==null?void 0:K.map(G=>({skillName:G.skillName,proficiencyLevel:G.proficiencyLevel})))??[]),v(((se=a.languages)==null?void 0:se.map(G=>({language:G.language,proficiencyLevel:G.proficiencyLevel})))??[]),x(!0))},[a,A]);const d=(i,V)=>{w(Y=>({...Y,[i]:V}))},_=async i=>{if(i.preventDefault(),!(!n||!l.fullNameEn.trim()))try{const V=E.filter(K=>K.skillName.trim()),Y=f.filter(K=>K.language.trim());await o.mutateAsync({id:n,data:{fullNameEn:l.fullNameEn.trim(),fullNameAr:l.fullNameAr.trim()||void 0,nationality:l.nationality||void 0,dateOfBirth:l.dateOfBirth||void 0,gender:l.gender||void 0,passportNumber:l.passportNumber.trim()||void 0,passportExpiry:l.passportExpiry||void 0,phone:l.phone.trim()||void 0,email:l.email.trim()||void 0,sourceType:l.sourceType||void 0,tenantSupplierId:C&&l.tenantSupplierId?l.tenantSupplierId:void 0,religion:l.religion||void 0,maritalStatus:l.maritalStatus||void 0,educationLevel:l.educationLevel||void 0,jobCategoryId:l.jobCategoryId||void 0,experienceYears:l.experienceYears?parseInt(l.experienceYears):void 0,monthlySalary:l.monthlySalary?parseFloat(l.monthlySalary):void 0,skills:V,languages:Y,notes:l.notes.trim()||void 0,externalReference:l.externalReference.trim()||void 0}}),t(`/candidates/${n}`)}catch(V){const Y=V instanceof Error?V.message:"Failed to update candidate";fe.error(Y)}};return u||!A?e.jsxs("div",{className:"space-y-6",children:[e.jsx(U,{className:"h-4 w-32 mb-4"}),e.jsx(U,{className:"h-8 w-64"}),e.jsx(U,{className:"h-64 w-full"})]}):a?a.status==="Received"||a.status==="UnderReview"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:`/candidates/${n}`,className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("edit.backToDetail")]}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("edit.title")})]}),e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.personal")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(m,{htmlFor:"fullNameEn",children:[s("create.fullNameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(L,{id:"fullNameEn",value:l.fullNameEn,onChange:i=>d("fullNameEn",i.target.value),placeholder:s("create.fullNameEnPlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"fullNameAr",children:s("create.fullNameAr")}),e.jsx(L,{id:"fullNameAr",value:l.fullNameAr,onChange:i=>d("fullNameAr",i.target.value),placeholder:s("create.fullNameArPlaceholder"),dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.nationality")}),e.jsx(Fe,{value:l.nationality,onChange:i=>d("nationality",i),placeholder:s("create.nationalityPlaceholder"),valueType:"name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"dateOfBirth",children:s("create.dateOfBirth")}),e.jsx(L,{id:"dateOfBirth",type:"date",value:l.dateOfBirth,onChange:i=>d("dateOfBirth",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.gender")}),e.jsxs(D,{value:l.gender,onValueChange:i=>d("gender",i),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.genderPlaceholder")})}),e.jsxs($,{children:[e.jsx(I,{value:"Male",children:s("create.genderOptions.Male")}),e.jsx(I,{value:"Female",children:s("create.genderOptions.Female")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"passportNumber",children:s("create.passportNumber")}),e.jsx(L,{id:"passportNumber",value:l.passportNumber,onChange:i=>d("passportNumber",i.target.value),placeholder:s("create.passportNumberPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"passportExpiry",children:s("create.passportExpiry")}),e.jsx(L,{id:"passportExpiry",type:"date",value:l.passportExpiry,onChange:i=>d("passportExpiry",i.target.value)})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.contact")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",children:s("create.phone")}),e.jsx(L,{id:"phone",value:l.phone,onChange:i=>d("phone",i.target.value),placeholder:s("create.phonePlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",children:s("create.email")}),e.jsx(L,{id:"email",type:"email",value:l.email,onChange:i=>d("email",i.target.value),placeholder:s("create.emailPlaceholder")})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.sourcing")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.sourceType")}),e.jsxs(D,{value:l.sourceType,onValueChange:i=>{d("sourceType",i),i!=="Supplier"&&d("tenantSupplierId","")},children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.sourceTypePlaceholder")})}),e.jsx($,{children:je.map(i=>e.jsx(I,{value:i,children:s(`sourceType.${i}`)},i))})]})]}),C&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.supplier")}),e.jsxs(D,{value:l.tenantSupplierId,onValueChange:i=>d("tenantSupplierId",i),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.supplierPlaceholder")})}),e.jsx($,{children:(P=g==null?void 0:g.items)==null?void 0:P.map(i=>{var V;return e.jsx(I,{value:i.id,children:((V=i.supplier)==null?void 0:V.nameEn)??i.id},i.id)})})]})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.professional")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.religion")}),e.jsxs(D,{value:l.religion,onValueChange:i=>d("religion",i),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.religionPlaceholder")})}),e.jsx($,{children:$e.map(i=>e.jsx(I,{value:i,children:s(`professional.religion.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.maritalStatus")}),e.jsxs(D,{value:l.maritalStatus,onValueChange:i=>d("maritalStatus",i),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.maritalStatusPlaceholder")})}),e.jsx($,{children:Be.map(i=>e.jsx(I,{value:i,children:s(`professional.maritalStatus.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.educationLevel")}),e.jsxs(D,{value:l.educationLevel,onValueChange:i=>d("educationLevel",i),children:[e.jsx(R,{children:e.jsx(O,{placeholder:s("create.educationLevelPlaceholder")})}),e.jsx($,{children:_e.map(i=>e.jsx(I,{value:i,children:s(`professional.educationLevel.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("create.jobCategory")}),e.jsx(Ie,{value:l.jobCategoryId,onChange:i=>d("jobCategoryId",i),placeholder:s("create.jobCategoryPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"experienceYears",children:s("create.experienceYears")}),e.jsx(L,{id:"experienceYears",type:"number",min:"0",max:"50",value:l.experienceYears,onChange:i=>d("experienceYears",i.target.value),placeholder:s("create.experienceYearsPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"monthlySalary",children:s("create.monthlySalary")}),e.jsx(L,{id:"monthlySalary",type:"number",min:"0",step:"0.01",value:l.monthlySalary,onChange:i=>d("monthlySalary",i.target.value),placeholder:s("create.monthlySalaryPlaceholder")})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.skills")})}),e.jsx(S,{children:e.jsx(Ye,{skills:E,onChange:T})})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.languages")})}),e.jsx(S,{children:e.jsx(qe,{languages:f,onChange:v})})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("edit.sections.media")})}),e.jsxs(S,{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("edit.photo")}),e.jsx(Z,{accept:"image/jpeg,image/png,image/webp",maxSizeMB:5,currentUrl:a.photoUrl,onUpload:async i=>{await j.mutateAsync({id:n,file:i})},isPending:j.isPending,type:"photo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("edit.video")}),e.jsx(Z,{accept:"video/mp4,video/webm",maxSizeMB:50,currentUrl:a.videoUrl,onUpload:async i=>{await c.mutateAsync({id:n,file:i})},isPending:c.isPending,type:"video"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:s("edit.passport")}),e.jsx(Z,{accept:"application/pdf,image/jpeg,image/png",maxSizeMB:10,currentUrl:a.passportDocumentUrl,onUpload:async i=>{await h.mutateAsync({id:n,file:i})},isPending:h.isPending,type:"document"})]})]})]}),e.jsxs(N,{children:[e.jsx(b,{children:e.jsx(k,{children:s("create.sections.additional")})}),e.jsxs(S,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"externalReference",children:s("create.externalReference")}),e.jsx(L,{id:"externalReference",value:l.externalReference,onChange:i=>d("externalReference",i.target.value),placeholder:s("create.externalReferencePlaceholder")})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(m,{htmlFor:"notes",children:s("create.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.notes,onChange:i=>d("notes",i.target.value),placeholder:s("create.notesPlaceholder")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(B,{type:"button",variant:"outline",onClick:()=>t(`/candidates/${n}`),children:s("common:cancel")}),e.jsx(B,{type:"submit",disabled:!l.fullNameEn.trim()||o.isPending,children:o.isPending?s("edit.submitting"):s("edit.submit")})]})]})]}):(t(`/candidates/${n}`),null):e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("common:noResults")})})}export{la as CandidateDetailPage,sa as CandidatesPage,aa as CreateCandidatePage,ta as EditCandidatePage};
//# sourceMappingURL=index-Ck7SQO4C.js.map
