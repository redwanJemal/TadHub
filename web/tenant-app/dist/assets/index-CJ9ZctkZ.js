import{c as I,H as $e,t as Ue,T as Ie,v as _e,d as O,j as e,r as m,B as P,a as K,p as X,z as Z,w as J,x as ee,m as Oe}from"./index-3LWobmh4.js";import{R as Y,S as He,D as Be}from"./DataTableAdvanced-BaepryHP.js";import{D as Fe,a as We,E as ze,b as Ve,c as B,k as qe,T as ae,A as se,d as te,e as ie,f as le,g as ne,h as re,i as ce,j as oe}from"./alert-dialog-C58uG3WD.js";import{B as $,L as M}from"./label-C6xqjT5A.js";import{S as de,b as me,c as ue,d as he,e as xe,I as q}from"./select-DSHg5FKg.js";import{u as G,g as Q}from"./index-e_Is6BP0.js";import{u as Ye,a as Ge,b as ge,c as Qe,d as Ke,e as Xe,g as Ze}from"./hooks-BRevRwgr.js";import{B as Je}from"./ban-CAM-JbPt.js";import{C as ea,E as aa}from"./eye-CeiYeXqo.js";import{B as sa,D as ta}from"./download-8P9IEK_b.js";import{U as ia}from"./user-check-CwWcRwPd.js";import{B as la,P as na,S as ra,W as ca}from"./WorkerDocumentsTab-Bd4WGVx-.js";import{D as je,a as pe,b as ve,c as fe,d as be,e as ye}from"./dialog-dlmPZOCs.js";import{F as z}from"./file-text-Y4nid_gy.js";import{S as k}from"./skeleton-CkBj2wMt.js";import{C as v,a as f,b as w,c as b}from"./card-zP3Z4qZO.js";import{T as oa,a as da,b as F,c as W}from"./tabs-CAZbEoeM.js";import{P as ma}from"./pencil-DyyNSMRS.js";import{I as Ne,V as ua}from"./video-off-VkDlexKR.js";import"./upload-DY_JWs3d.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],xa=I("arrow-right-left",ha);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]],ja=I("baby",ga);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],va=I("globe",pa);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ba=I("graduation-cap",fa);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]],Na=I("heart-pulse",ya);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ka=I("map-pin",wa);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Sa=I("printer",Aa);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],Ca=I("skull",Da),Ta={Available:{variant:"success",icon:_e,category:"Pool"},InTraining:{variant:"default",icon:ba,category:"Pool"},UnderMedicalTest:{variant:"default",icon:ra,category:"Pool"},NewArrival:{variant:"default",icon:na,category:"Arrival"},Booked:{variant:"default",icon:la,category:"Placement"},Hired:{variant:"default",icon:ia,category:"Placement"},OnProbation:{variant:"warning",icon:He,category:"Placement"},Active:{variant:"success",icon:sa,category:"Placement"},Renewed:{variant:"success",icon:Y,category:"Placement"},PendingReplacement:{variant:"warning",icon:ea,category:"NegativeSpecial"},Transferred:{variant:"secondary",icon:xa,category:"NegativeSpecial"},MedicallyUnfit:{variant:"destructive",icon:Na,category:"NegativeSpecial"},Absconded:{variant:"destructive",icon:Ie,category:"NegativeSpecial"},Terminated:{variant:"destructive",icon:Ue,category:"NegativeSpecial"},Pregnant:{variant:"warning",icon:ja,category:"NegativeSpecial"},Repatriated:{variant:"secondary",icon:$e,category:"Terminal"},Deported:{variant:"destructive",icon:Je,category:"Terminal"},Deceased:{variant:"destructive",icon:Ca,category:"Terminal"}},Pa=["Available","InTraining","UnderMedicalTest","NewArrival","Booked","Hired","OnProbation","Active","Renewed","PendingReplacement","Transferred","MedicallyUnfit","Absconded","Terminated","Pregnant","Repatriated","Deported","Deceased"],we=["Abroad","InCountry"],La=["Supplier","Local"],ke={Available:["Booked","UnderMedicalTest","InTraining","Absconded","Repatriated","Deceased"],InTraining:["Available","UnderMedicalTest","Absconded","Repatriated","Deceased"],UnderMedicalTest:["Available","MedicallyUnfit","Deceased"],NewArrival:["Available","InTraining","UnderMedicalTest","MedicallyUnfit","Absconded","Repatriated","Deceased"],Booked:["Hired","NewArrival","Available","Deceased"],Hired:["OnProbation","Available","Deceased"],OnProbation:["Active","PendingReplacement","Terminated","Absconded","Pregnant","Deceased"],Active:["Renewed","PendingReplacement","Terminated","Absconded","Pregnant","Transferred","Deceased"],Renewed:["Active","PendingReplacement","Terminated","Absconded","Pregnant","Transferred","Deceased"],PendingReplacement:["Available","Terminated","Repatriated","Deceased"],Transferred:["Repatriated"],MedicallyUnfit:["Repatriated","Available","Deceased"],Absconded:["Terminated","Repatriated","Deported","Available","Deceased"],Terminated:["Available","Repatriated","Transferred"],Pregnant:["Active","Terminated","Repatriated","Deceased"]},Ra=["Terminated","Absconded","MedicallyUnfit","PendingReplacement","Transferred","Repatriated","Deported","Pregnant","Deceased"],Ae={Abroad:{variant:"outline",icon:va},InCountry:{variant:"default",icon:ka}};function _({status:a}){const{t:n}=O("workers"),r=Ta[a];if(!r)return e.jsx($,{variant:"outline",children:a});const t=r.icon;return e.jsxs($,{variant:r.variant,children:[e.jsx(t,{className:"me-1 h-3 w-3"}),n(`status.${a}`)]})}function Se({open:a,onOpenChange:n,workerId:r,currentStatus:t}){const{t:s}=O("workers"),[y,j]=m.useState(""),[p,S]=m.useState(""),[A,c]=m.useState(""),u=Ye(),g=Ra.includes(y),D=y&&(!g||p.trim()),U=ke[t]??[],L=async()=>{D&&(await u.mutateAsync({id:r,data:{status:y,reason:p.trim()||void 0,notes:A.trim()||void 0}}),j(""),S(""),c(""),n(!1))},R=h=>{h||(j(""),S(""),c("")),n(h)};return e.jsx(je,{open:a,onOpenChange:R,children:e.jsxs(pe,{children:[e.jsxs(ve,{children:[e.jsx(fe,{children:s("transition.title")}),e.jsx(be,{children:s("transition.description")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:s("transition.currentStatus")}),e.jsx("div",{children:e.jsx(_,{status:t})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:s("transition.targetStatus")}),e.jsxs(de,{value:y,onValueChange:j,children:[e.jsx(me,{children:e.jsx(ue,{placeholder:s("transition.targetStatusPlaceholder")})}),e.jsx(he,{children:U.map(h=>e.jsx(xe,{value:h,children:e.jsx(_,{status:h})},h))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{children:[s("transition.reason"),g&&e.jsx("span",{className:"text-destructive",children:" *"})]}),e.jsx("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:s("transition.reasonPlaceholder"),value:p,onChange:h=>S(h.target.value)}),g&&!p.trim()&&e.jsx("p",{className:"text-sm text-destructive",children:s("transition.reasonRequired")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:s("transition.notes")}),e.jsx("textarea",{className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:s("transition.notesPlaceholder"),value:A,onChange:h=>c(h.target.value)})]})]}),e.jsxs(ye,{children:[e.jsx(P,{variant:"outline",onClick:()=>R(!1),children:s("common:cancel")}),e.jsx(P,{onClick:L,disabled:!D||u.isPending,children:u.isPending?s("transition.submitting"):s("transition.submit")})]})]})})}function ss(){const{t:a}=O("workers"),n=K(),{hasPermission:r}=X(),[t,s]=m.useState(""),[y,j]=m.useState(1),[p,S]=m.useState(20),[A,c]=m.useState([]),[u,g]=m.useState(),[D,U]=m.useState(),[L,R]=m.useState(),[h,E]=m.useState(null),[d,l]=m.useState(null),T=m.useMemo(()=>({page:y,pageSize:p,search:t||void 0,sort:"-createdAt","filter[status]":u,"filter[location]":D,"filter[sourceType]":L}),[y,p,t,u,D,L]),{data:C,isLoading:De,refetch:Ce}=Ge(T),{data:V}=G(),Te=ge(),Pe=i=>{if(!i)return"—";const x=V==null?void 0:V.find(H=>H.code===i);return(x==null?void 0:x.nameEn)??i},Le=async()=>{h&&(await Te.mutateAsync(h.id),E(null))},Re=[{key:"status",label:a("filters.status"),options:Pa.map(i=>({label:a(`status.${i}`),value:i})),value:u},{key:"location",label:a("filters.location"),options:we.map(i=>({label:a(`location.${i}`),value:i})),value:D},{key:"sourceType",label:a("filters.sourceType"),options:La.map(i=>({label:a(`sourceType.${i}`),value:i})),value:L}],Ee=(i,x)=>{i==="status"&&g(x),i==="location"&&U(x),i==="sourceType"&&R(x),j(1)},Me=[{key:"workerCode",header:a("columns.workerCode"),cell:i=>e.jsx("span",{className:"font-mono text-sm",children:i.workerCode})},{key:"name",header:a("columns.name"),cell:i=>e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.photoUrl?e.jsx("img",{src:i.photoUrl,alt:"",className:"h-8 w-8 rounded-full object-cover border shrink-0"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-xs font-medium shrink-0",children:i.fullNameEn.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.fullNameEn}),i.fullNameAr&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:i.fullNameAr})]})]})},{key:"nationality",header:a("columns.nationality"),cell:i=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[i.nationality&&e.jsx("span",{className:"text-lg leading-none",children:Q(i.nationality)}),e.jsx("span",{children:Pe(i.nationality)})]})},{key:"supplier",header:a("columns.supplier"),cell:i=>{var x;return((x=i.supplier)==null?void 0:x.name)??"—"}},{key:"jobCategory",header:a("columns.jobCategory"),cell:i=>{var x;return((x=i.jobCategory)==null?void 0:x.name)??"—"}},{key:"status",header:a("columns.status"),cell:i=>e.jsx(_,{status:i.status})},{key:"location",header:a("columns.location"),cell:i=>{const x=Ae[i.location],H=x==null?void 0:x.icon;return e.jsxs($,{variant:(x==null?void 0:x.variant)??"outline",className:"gap-1",children:[H&&e.jsx(H,{className:"h-3 w-3"}),a(`location.${i.location}`)]})}},{key:"activatedAt",header:a("columns.activatedAt"),cell:i=>i.activatedAt?new Date(i.activatedAt).toLocaleDateString():"—"},{key:"actions",header:a("columns.actions"),className:"w-[70px]",cell:i=>e.jsxs(Fe,{children:[e.jsx(We,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ze,{className:"h-4 w-4"})})}),e.jsxs(Ve,{align:"end",children:[e.jsxs(B,{onClick:()=>n(`/workers/${i.id}`),children:[e.jsx(aa,{className:"me-2 h-4 w-4"}),a("actions.view")]}),e.jsxs(B,{onClick:()=>n(`/workers/${i.id}/cv`),children:[e.jsx(z,{className:"me-2 h-4 w-4"}),a("actions.viewCv")]}),r("workers.manage_status")&&e.jsxs(B,{onClick:()=>l(i),children:[e.jsx(Y,{className:"me-2 h-4 w-4"}),a("actions.changeStatus")]}),r("workers.delete")&&e.jsxs(e.Fragment,{children:[e.jsx(qe,{}),e.jsxs(B,{className:"text-destructive",onClick:()=>E(i),children:[e.jsx(ae,{className:"me-2 h-4 w-4"}),a("actions.delete")]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a("title")}),e.jsx("p",{className:"text-muted-foreground",children:a("description")})]}),e.jsx(Be,{columns:Me,data:(C==null?void 0:C.items)??[],isLoading:De,selectable:!0,selectedIds:A,onSelectionChange:c,searchPlaceholder:a("searchPlaceholder"),searchValue:t,onSearchChange:i=>{s(i),j(1)},filters:Re,onFilterChange:Ee,page:y,totalPages:C==null?void 0:C.totalPages,total:C==null?void 0:C.totalCount,pageSize:p,onPageChange:j,onPageSizeChange:S,onRefresh:()=>Ce(),emptyVariant:"default",emptyTitle:a("empty.title"),emptyDescription:a("empty.description")}),d&&e.jsx(Se,{open:!!d,onOpenChange:i=>{i||l(null)},workerId:d.id,currentStatus:d.status}),e.jsx(se,{open:!!h,onOpenChange:()=>E(null),children:e.jsxs(te,{children:[e.jsxs(ie,{children:[e.jsx(le,{children:a("deleteDialog.title")}),e.jsx(ne,{children:a("deleteDialog.description")})]}),e.jsxs(re,{children:[e.jsx(ce,{children:a("common:cancel")}),e.jsx(oe,{onClick:Le,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:a("deleteDialog.confirm")})]})]})})]})}function Ea({open:a,onOpenChange:n,worker:r}){var R,h,E;const{t}=O("workers"),s=Qe(),[y,j]=m.useState(r.location),[p,S]=m.useState(((R=r.procurementPaidAt)==null?void 0:R.slice(0,10))??""),[A,c]=m.useState(((h=r.flightDate)==null?void 0:h.slice(0,10))??""),[u,g]=m.useState(((E=r.arrivedAt)==null?void 0:E.slice(0,10))??""),[D,U]=m.useState(r.notes??"");m.useEffect(()=>{var d,l,T;j(r.location),S(((d=r.procurementPaidAt)==null?void 0:d.slice(0,10))??""),c(((l=r.flightDate)==null?void 0:l.slice(0,10))??""),g(((T=r.arrivedAt)==null?void 0:T.slice(0,10))??""),U(r.notes??"")},[r]);const L=async()=>{await s.mutateAsync({id:r.id,data:{location:y,procurementPaidAt:p||void 0,flightDate:A||void 0,arrivedAt:u||void 0,notes:D.trim()||void 0}}),n(!1)};return e.jsx(je,{open:a,onOpenChange:n,children:e.jsxs(pe,{children:[e.jsxs(ve,{children:[e.jsx(fe,{children:t("editDialog.title")}),e.jsxs(be,{children:[r.fullNameEn," (",r.workerCode,")"]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:t("editDialog.location")}),e.jsxs(de,{value:y,onValueChange:d=>j(d),children:[e.jsx(me,{children:e.jsx(ue,{placeholder:t("editDialog.locationPlaceholder")})}),e.jsx(he,{children:we.map(d=>e.jsx(xe,{value:d,children:t(`location.${d}`)},d))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:t("editDialog.procurementPaidAt")}),e.jsx(q,{type:"date",value:p,onChange:d=>S(d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:t("editDialog.flightDate")}),e.jsx(q,{type:"date",value:A,onChange:d=>c(d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:t("editDialog.arrivedAt")}),e.jsx(q,{type:"date",value:u,onChange:d=>g(d.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{children:t("editDialog.notes")}),e.jsx("textarea",{className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:t("editDialog.notesPlaceholder"),value:D,onChange:d=>U(d.target.value)})]})]}),e.jsxs(ye,{children:[e.jsx(P,{variant:"outline",onClick:()=>n(!1),children:t("common:cancel")}),e.jsx(P,{onClick:L,disabled:s.isPending,children:s.isPending?t("editDialog.submitting"):t("editDialog.submit")})]})]})})}function o({label:a,value:n}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a}),e.jsx("p",{className:"font-medium",children:n!=null&&n!==""?String(n):"—"})]})}function Ma(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(k,{className:"h-4 w-32 mb-4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"h-8 w-64"}),e.jsx(k,{className:"h-6 w-24"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-9 w-32"}),e.jsx(k,{className:"h-9 w-32"})]})]})]}),e.jsx(k,{className:"h-10 w-96"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:Array.from({length:4}).map((a,n)=>e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(k,{className:"h-6 w-40"})}),e.jsx(b,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:4}).map((r,t)=>e.jsxs("div",{children:[e.jsx(k,{className:"h-4 w-24 mb-1"}),e.jsx(k,{className:"h-5 w-40"})]},t))})]},n))})]})}function ts(){var h,E,d;const{t:a}=O("workers"),{id:n}=Z(),r=K(),{hasPermission:t}=X(),{data:s,isLoading:y}=Ke(n),{data:j}=G(),p=ge(),[S,A]=m.useState(!1),[c,u]=m.useState(!1),[g,D]=m.useState(!1),U=l=>{if(!l)return;const T=j==null?void 0:j.find(C=>C.code===l||C.nameEn===l);return T?`${Q(T.code)} ${T.nameEn}`:l},L=async()=>{n&&(await p.mutateAsync(n),r("/workers"))};if(y)return e.jsx(Ma,{});if(!s)return e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:a("common:noResults")})});const R=(((h=ke[s.status])==null?void 0:h.length)??0)>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(J,{to:"/workers",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(ee,{className:"h-4 w-4"}),a("detail.backToList")]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.photoUrl&&e.jsx("img",{src:s.photoUrl,alt:s.fullNameEn,className:"h-12 w-12 rounded-full object-cover border"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s.fullNameEn}),e.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:s.workerCode})]}),e.jsx(_,{status:s.status}),(()=>{const l=Ae[s.location],T=l==null?void 0:l.icon;return e.jsxs($,{variant:(l==null?void 0:l.variant)??"outline",className:"gap-1",children:[T&&e.jsx(T,{className:"h-3 w-3"}),a(`location.${s.location}`)]})})()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t("workers.edit")&&e.jsxs(P,{variant:"outline",onClick:()=>D(!0),children:[e.jsx(ma,{className:"me-2 h-4 w-4"}),a("actions.edit")]}),e.jsxs(P,{variant:"outline",onClick:()=>r(`/workers/${n}/cv`),children:[e.jsx(z,{className:"me-2 h-4 w-4"}),a("actions.viewCv")]}),R&&t("workers.manage_status")&&e.jsxs(P,{variant:"outline",onClick:()=>A(!0),children:[e.jsx(Y,{className:"me-2 h-4 w-4"}),a("actions.changeStatus")]}),t("workers.delete")&&e.jsxs(P,{variant:"destructive",onClick:()=>u(!0),children:[e.jsx(ae,{className:"me-2 h-4 w-4"}),a("actions.delete")]})]})]})]}),e.jsxs(oa,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(da,{children:[e.jsx(F,{value:"overview",children:a("tabs.overview")}),e.jsx(F,{value:"professional",children:a("tabs.professional")}),e.jsx(F,{value:"documents",children:a("tabs.documents")}),e.jsxs(F,{value:"statusHistory",children:[a("tabs.statusHistory"),s.statusHistory&&e.jsx($,{variant:"secondary",className:"ms-2",children:s.statusHistory.length})]})]}),e.jsx(W,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.personal")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(o,{label:a("detail.fullNameEn"),value:s.fullNameEn}),e.jsx(o,{label:a("detail.fullNameAr"),value:s.fullNameAr}),e.jsx(o,{label:a("detail.workerCode"),value:s.workerCode}),e.jsx(o,{label:a("detail.nationality"),value:U(s.nationality)}),e.jsx(o,{label:a("detail.dateOfBirth"),value:s.dateOfBirth}),e.jsx(o,{label:a("detail.gender"),value:s.gender}),e.jsx(o,{label:a("detail.passportNumber"),value:s.passportNumber}),e.jsx(o,{label:a("detail.passportExpiry"),value:s.passportExpiry})]})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.contact")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(o,{label:a("detail.phone"),value:s.phone}),e.jsx(o,{label:a("detail.email"),value:s.email})]})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.sourcing")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(o,{label:a("detail.sourceType"),value:a(`sourceType.${s.sourceType}`)}),e.jsx(o,{label:a("detail.supplier"),value:(E=s.supplier)==null?void 0:E.name}),e.jsx(o,{label:a("detail.activatedAt"),value:s.activatedAt?new Date(s.activatedAt).toLocaleString():void 0}),s.terminatedAt&&e.jsxs(e.Fragment,{children:[e.jsx(o,{label:a("detail.terminatedAt"),value:new Date(s.terminatedAt).toLocaleString()}),e.jsx(o,{label:a("detail.terminationReason"),value:s.terminationReason})]})]})]}),(s.procurementPaidAt||s.flightDate||s.arrivedAt)&&e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.travel")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[s.procurementPaidAt&&e.jsx(o,{label:a("detail.procurementPaidAt"),value:new Date(s.procurementPaidAt).toLocaleDateString()}),s.flightDate&&e.jsx(o,{label:a("detail.flightDate"),value:new Date(s.flightDate).toLocaleDateString()}),s.arrivedAt&&e.jsx(o,{label:a("detail.arrivedAt"),value:new Date(s.arrivedAt).toLocaleDateString()})]})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.media")})}),e.jsx(b,{children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a("detail.photo")}),s.photoUrl?e.jsx("img",{src:s.photoUrl,alt:s.fullNameEn,className:"h-40 w-40 rounded-lg object-cover border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(Ne,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a("detail.video")}),s.videoUrl?e.jsx("video",{src:s.videoUrl,controls:!0,className:"h-40 max-w-full rounded-lg border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(ua,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:a("detail.passportDocument")}),s.passportDocumentUrl?e.jsxs("a",{href:s.passportDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"h-40 w-40 rounded-lg border flex flex-col items-center justify-center gap-2 hover:bg-muted/50 transition-colors",children:[e.jsx(z,{className:"h-10 w-10 text-primary"}),e.jsx("span",{className:"text-sm text-primary font-medium",children:a("detail.viewPassportDocument")})]}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(z,{className:"h-8 w-8 text-muted-foreground/50"})})]})]})})]})]})}),e.jsx(W,{value:"professional",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.professionalProfile")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(o,{label:a("detail.religion"),value:s.religion?a(`professional.religion.${s.religion}`,s.religion):void 0}),e.jsx(o,{label:a("detail.maritalStatus"),value:s.maritalStatus?a(`professional.maritalStatus.${s.maritalStatus}`,s.maritalStatus):void 0}),e.jsx(o,{label:a("detail.educationLevel"),value:s.educationLevel?a(`professional.educationLevel.${s.educationLevel}`,s.educationLevel):void 0}),e.jsx(o,{label:a("detail.jobCategory"),value:(d=s.jobCategory)==null?void 0:d.name}),e.jsx(o,{label:a("detail.experienceYears"),value:s.experienceYears}),e.jsx(o,{label:a("detail.monthlySalary"),value:s.monthlySalary?`${s.monthlySalary} AED`:void 0})]})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.skills")})}),e.jsx(b,{children:s.skills&&s.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map(l=>e.jsxs($,{variant:"outline",children:[l.skillName," — ",a(`skills.proficiency.${l.proficiencyLevel}`,l.proficiencyLevel)]},l.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.languages")})}),e.jsx(b,{children:s.languages&&s.languages.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.languages.map(l=>e.jsxs($,{variant:"outline",children:[l.language," — ",a(`languages.proficiency.${l.proficiencyLevel}`,l.proficiencyLevel)]},l.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.operational")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(o,{label:a("detail.createdAt"),value:new Date(s.createdAt).toLocaleString()}),e.jsx(o,{label:a("detail.updatedAt"),value:new Date(s.updatedAt).toLocaleString()}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(o,{label:a("detail.notes"),value:s.notes})})]})]})]})}),e.jsx(W,{value:"documents",className:"space-y-6",children:e.jsx(ca,{workerId:s.id})}),e.jsx(W,{value:"statusHistory",className:"space-y-6",children:s.statusHistory&&s.statusHistory.length>0?e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("detail.statusHistory")})}),e.jsx(b,{children:e.jsx("div",{className:"space-y-4",children:s.statusHistory.map(l=>e.jsx("div",{className:"flex items-start gap-3 border-s-2 border-muted ps-4 pb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.fromStatus&&e.jsxs(e.Fragment,{children:[e.jsx(_,{status:l.fromStatus}),e.jsx("span",{className:"text-muted-foreground",children:"→"})]}),e.jsx(_,{status:l.toStatus})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(l.changedAt).toLocaleString()}),l.reason&&e.jsx("p",{className:"text-sm mt-1",children:l.reason}),l.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l.notes})]})},l.id))})})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[20vh]",children:e.jsx("p",{className:"text-muted-foreground",children:a("detail.notAvailable")})})})]}),e.jsx(Ea,{open:g,onOpenChange:D,worker:s}),e.jsx(Se,{open:S,onOpenChange:A,workerId:s.id,currentStatus:s.status}),e.jsx(se,{open:c,onOpenChange:u,children:e.jsxs(te,{children:[e.jsxs(ie,{children:[e.jsx(le,{children:a("deleteDialog.title")}),e.jsx(ne,{children:a("deleteDialog.description")})]}),e.jsxs(re,{children:[e.jsx(ce,{children:a("common:cancel")}),e.jsx(oe,{onClick:L,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:a("deleteDialog.confirm")})]})]})})]})}function $a(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{className:"h-4 w-32 mb-4"}),e.jsx(k,{className:"h-8 w-64"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:Array.from({length:4}).map((a,n)=>e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(k,{className:"h-6 w-40"})}),e.jsx(b,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:4}).map((r,t)=>e.jsxs("div",{children:[e.jsx(k,{className:"h-4 w-24 mb-1"}),e.jsx(k,{className:"h-5 w-40"})]},t))})]},n))})]})}function N({label:a,value:n}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:a}),e.jsx("p",{className:"font-medium",children:n!=null&&n!==""?String(n):"—"})]})}function is(){var A;const{t:a}=O("workers"),{id:n}=Z(),{data:r}=G(),{data:t,isLoading:s}=Oe({queryKey:["workers",n,"cv"],queryFn:()=>Ze(n),enabled:!!n}),y=c=>{if(!c)return;const u=r==null?void 0:r.find(g=>g.code===c||g.nameEn===c);return u?`${Q(u.code)} ${u.nameEn}`:c},[j,p]=m.useState(!1),S=async()=>{if(n){p(!0);try{const c=await Xe(n),u=URL.createObjectURL(c),g=document.createElement("a");g.href=u,g.download=`CV-${(t==null?void 0:t.workerCode)??n}.pdf`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(u)}catch{}finally{p(!1)}}};return s?e.jsx($a,{}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between print:hidden",children:[e.jsxs("div",{children:[e.jsxs(J,{to:`/workers/${n}`,className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(ee,{className:"h-4 w-4"}),a("cv.backToDetail")]}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a("cv.title")}),e.jsx("p",{className:"text-muted-foreground font-mono",children:t.workerCode})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:"outline",onClick:S,disabled:j,children:[e.jsx(ta,{className:"me-2 h-4 w-4"}),a(j?"cv.downloading":"cv.downloadPdf")]}),e.jsxs(P,{variant:"outline",onClick:()=>window.print(),children:[e.jsx(Sa,{className:"me-2 h-4 w-4"}),a("cv.print")]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3 print:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-1 print:col-span-1 flex justify-center",children:t.photoUrl?e.jsx("img",{src:t.photoUrl,alt:t.fullNameEn,className:"h-48 w-48 rounded-lg object-cover border"}):e.jsx("div",{className:"h-48 w-48 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(Ne,{className:"h-12 w-12 text-muted-foreground/50"})})}),e.jsxs(v,{className:"md:col-span-2 print:col-span-2",children:[e.jsx(f,{children:e.jsx(w,{children:a("cv.personal")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(N,{label:a("detail.fullNameEn"),value:t.fullNameEn}),e.jsx(N,{label:a("detail.fullNameAr"),value:t.fullNameAr}),e.jsx(N,{label:a("detail.nationality"),value:y(t.nationality)}),e.jsx(N,{label:a("detail.dateOfBirth"),value:t.dateOfBirth}),e.jsx(N,{label:a("detail.gender"),value:t.gender}),e.jsx(N,{label:a("detail.passportNumber"),value:t.passportNumber}),e.jsx(N,{label:a("detail.phone"),value:t.phone}),e.jsx(N,{label:a("detail.email"),value:t.email})]})]})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("cv.professional")})}),e.jsxs(b,{className:"grid gap-4 sm:grid-cols-3",children:[e.jsx(N,{label:a("detail.religion"),value:t.religion?a(`professional.religion.${t.religion}`,t.religion):void 0}),e.jsx(N,{label:a("detail.maritalStatus"),value:t.maritalStatus?a(`professional.maritalStatus.${t.maritalStatus}`,t.maritalStatus):void 0}),e.jsx(N,{label:a("detail.educationLevel"),value:t.educationLevel?a(`professional.educationLevel.${t.educationLevel}`,t.educationLevel):void 0}),e.jsx(N,{label:a("detail.jobCategory"),value:(A=t.jobCategory)==null?void 0:A.name}),e.jsx(N,{label:a("detail.experienceYears"),value:t.experienceYears}),e.jsx(N,{label:a("detail.monthlySalary"),value:t.monthlySalary?`${t.monthlySalary} AED`:void 0})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 print:grid-cols-2",children:[e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("cv.skills")})}),e.jsx(b,{children:t.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.skills.map(c=>e.jsxs($,{variant:"outline",children:[c.skillName," — ",a(`skills.proficiency.${c.proficiencyLevel}`,c.proficiencyLevel)]},c.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]}),e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(w,{children:a("cv.languages")})}),e.jsx(b,{children:t.languages.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.languages.map(c=>e.jsxs($,{variant:"outline",children:[c.language," — ",a(`languages.proficiency.${c.proficiencyLevel}`,c.proficiencyLevel)]},c.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]})]})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:a("common:noResults")})})}export{is as WorkerCvPage,ts as WorkerDetailPage,ss as WorkersPage};
//# sourceMappingURL=index-CJ9ZctkZ.js.map
