import{c as T,g as f,i as J,l as E,d as b,r as x,j as e,P as F}from"./index-Cqouy3Yt.js";import{b as W,c as I,L as c,I as m,B as X,D as Z,h as ee,E as ae,i as te,j as P,t as ne,T as D,k as se,A as ie,l as le,m as de,n as re,o as ce,p as oe,q as me,r as he}from"./label-DwNxcReA.js";import{B as p}from"./button-C8-5F-AC.js";import{S as q,a as M,b as L,c as $,d as z,e as K,P as ue}from"./sheet-BahDlhVT.js";import{M as xe}from"./mail-Dhp7jO02.js";import{P as ge}from"./pencil-BP9XdQ27.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],je=T("toggle-left",pe);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],ye=T("toggle-right",ve);function N(a){return`/tenants/${J()}${a}`}function fe(a){return f.getPaged(N("/clients"),a)}function Ne(a){return f.post(N("/clients"),a)}function Ce(a,d){return f.patch(N(`/clients/${a}`),d)}function Ae(a){return f.delete(N(`/clients/${a}`))}const C="clients";function Pe(a){return W({queryKey:[C,a],queryFn:()=>fe(a)})}function Ee(){const a=E();return I({mutationFn:d=>Ne(d),onSuccess:()=>{a.invalidateQueries({queryKey:[C]})}})}function Q(){const a=E();return I({mutationFn:({id:d,data:n})=>Ce(d,n),onSuccess:()=>{a.invalidateQueries({queryKey:[C]})}})}function be(){const a=E();return I({mutationFn:d=>Ae(d),onSuccess:()=>{a.invalidateQueries({queryKey:[C]})}})}const w={nameEn:"",nameAr:"",nationalId:"",phone:"",email:"",address:"",city:"",notes:""};function Ie({open:a,onOpenChange:d}){const{t:n}=b("clients"),[t,g]=x.useState(w),l=Ee(),o=(i,r)=>g(j=>({...j,[i]:r})),u=async i=>{i.preventDefault(),t.nameEn.trim()&&(await l.mutateAsync({nameEn:t.nameEn.trim(),nameAr:t.nameAr.trim()||void 0,nationalId:t.nationalId.trim()||void 0,phone:t.phone.trim()||void 0,email:t.email.trim()||void 0,address:t.address.trim()||void 0,city:t.city.trim()||void 0,notes:t.notes.trim()||void 0}),g(w),d(!1))};return e.jsx(q,{open:a,onOpenChange:d,children:e.jsx(M,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:u,className:"flex flex-col h-full",children:[e.jsxs(L,{children:[e.jsx($,{children:n("add.title")}),e.jsx(z,{children:n("add.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(c,{htmlFor:"nameEn",children:[n("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(m,{id:"nameEn",placeholder:n("add.nameEnPlaceholder"),value:t.nameEn,onChange:i=>o("nameEn",i.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"nameAr",children:n("add.nameAr")}),e.jsx(m,{id:"nameAr",placeholder:n("add.nameArPlaceholder"),value:t.nameAr,onChange:i=>o("nameAr",i.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"nationalId",children:n("add.nationalId")}),e.jsx(m,{id:"nationalId",placeholder:n("add.nationalIdPlaceholder"),value:t.nationalId,onChange:i=>o("nationalId",i.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"phone",children:n("add.phone")}),e.jsx(m,{id:"phone",type:"tel",placeholder:n("add.phonePlaceholder"),value:t.phone,onChange:i=>o("phone",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"email",children:n("add.email")}),e.jsx(m,{id:"email",type:"email",placeholder:n("add.emailPlaceholder"),value:t.email,onChange:i=>o("email",i.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"address",children:n("add.address")}),e.jsx(m,{id:"address",placeholder:n("add.addressPlaceholder"),value:t.address,onChange:i=>o("address",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"city",children:n("add.city")}),e.jsx(m,{id:"city",placeholder:n("add.cityPlaceholder"),value:t.city,onChange:i=>o("city",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"notes",children:n("add.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:n("add.notesPlaceholder"),value:t.notes,onChange:i=>o("notes",i.target.value),rows:3})]})]}),e.jsxs(K,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>d(!1),children:n("common:cancel")}),e.jsx(p,{type:"submit",disabled:l.isPending||!t.nameEn.trim(),children:l.isPending?n("add.submitting"):n("add.submit")})]})]})})})}function Se({open:a,onOpenChange:d,client:n}){const{t}=b("clients"),g=Q(),[l,o]=x.useState({nameEn:"",nameAr:"",nationalId:"",phone:"",email:"",city:""});x.useEffect(()=>{n&&o({nameEn:n.nameEn||"",nameAr:n.nameAr||"",nationalId:n.nationalId||"",phone:n.phone||"",email:n.email||"",city:n.city||""})},[n]);const u=(r,j)=>o(v=>({...v,[r]:j})),i=async r=>{r.preventDefault(),!(!n||!l.nameEn.trim())&&(await g.mutateAsync({id:n.id,data:{nameEn:l.nameEn.trim(),nameAr:l.nameAr.trim()||void 0,nationalId:l.nationalId.trim()||void 0,phone:l.phone.trim()||void 0,email:l.email.trim()||void 0,city:l.city.trim()||void 0}}),d(!1))};return e.jsx(q,{open:a,onOpenChange:d,children:e.jsx(M,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:i,className:"flex flex-col h-full",children:[e.jsxs(L,{children:[e.jsx($,{children:t("edit.title")}),e.jsx(z,{children:t("edit.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(c,{htmlFor:"editNameEn",children:[t("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(m,{id:"editNameEn",placeholder:t("add.nameEnPlaceholder"),value:l.nameEn,onChange:r=>u("nameEn",r.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editNameAr",children:t("add.nameAr")}),e.jsx(m,{id:"editNameAr",placeholder:t("add.nameArPlaceholder"),value:l.nameAr,onChange:r=>u("nameAr",r.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editNationalId",children:t("add.nationalId")}),e.jsx(m,{id:"editNationalId",placeholder:t("add.nationalIdPlaceholder"),value:l.nationalId,onChange:r=>u("nationalId",r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editPhone",children:t("add.phone")}),e.jsx(m,{id:"editPhone",type:"tel",placeholder:t("add.phonePlaceholder"),value:l.phone,onChange:r=>u("phone",r.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editEmail",children:t("add.email")}),e.jsx(m,{id:"editEmail",type:"email",placeholder:t("add.emailPlaceholder"),value:l.email,onChange:r=>u("email",r.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editCity",children:t("add.city")}),e.jsx(m,{id:"editCity",placeholder:t("add.cityPlaceholder"),value:l.city,onChange:r=>u("city",r.target.value)})]})]}),e.jsxs(K,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>d(!1),children:t("common:cancel")}),e.jsx(p,{type:"submit",disabled:g.isPending||!l.nameEn.trim(),children:g.isPending?t("edit.submitting"):t("edit.submit")})]})]})})})}function Me(){const{t:a}=b("clients"),[d,n]=x.useState(""),[t,g]=x.useState(1),[l,o]=x.useState(20),[u,i]=x.useState([]),[r,j]=x.useState(!1),[v,S]=x.useState(null),[A,y]=x.useState(null),_=x.useMemo(()=>({page:t,pageSize:l,search:d||void 0,sort:"-createdAt"}),[t,l,d]),{data:h,isLoading:B,refetch:R}=Pe(_),H=Q(),V=be(),O=async()=>{A&&(await V.mutateAsync(A.id),y(null))},U=async s=>{await H.mutateAsync({id:s.id,data:{isActive:!s.isActive}})},Y=[{key:"name",header:a("columns.name"),cell:s=>e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:s.nameEn}),s.nameAr&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:s.nameAr})]})},{key:"nationalId",header:a("columns.nationalId"),cell:s=>e.jsx("span",{className:"text-sm",children:s.nationalId||"—"})},{key:"contact",header:a("columns.contact"),cell:s=>e.jsxs("div",{className:"flex flex-col gap-0.5 text-sm",children:[s.email?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[180px]",children:s.email})]}):null,s.phone?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(ue,{className:"h-3 w-3"}),s.phone]}):null,!s.email&&!s.phone&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})]})},{key:"city",header:a("columns.city"),cell:s=>e.jsx("span",{className:"text-sm",children:s.city||"—"})},{key:"status",header:a("columns.status"),cell:s=>e.jsx(X,{variant:s.isActive?"default":"secondary",children:a(`status.${s.isActive?"Active":"Inactive"}`)})},{key:"actions",header:a("columns.actions"),className:"w-[70px]",cell:s=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ae,{className:"h-4 w-4"})})}),e.jsxs(te,{align:"end",children:[e.jsxs(P,{onClick:()=>S(s),children:[e.jsx(ge,{className:"me-2 h-4 w-4"}),a("actions.edit")]}),e.jsx(P,{onClick:()=>U(s),children:s.isActive?e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"me-2 h-4 w-4"}),a("actions.deactivate")]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"me-2 h-4 w-4"}),a("actions.activate")]})}),e.jsx(ne,{}),e.jsxs(P,{className:"text-destructive",onClick:()=>y(s),children:[e.jsx(D,{className:"me-2 h-4 w-4"}),a("actions.delete")]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a("title")}),e.jsx("p",{className:"text-muted-foreground",children:a("description")})]}),e.jsx(se,{columns:Y,data:(h==null?void 0:h.items)??[],isLoading:B,selectable:!0,selectedIds:u,onSelectionChange:i,searchPlaceholder:a("searchPlaceholder"),searchValue:d,onSearchChange:s=>{n(s),g(1)},page:t,totalPages:h==null?void 0:h.totalPages,total:h==null?void 0:h.totalCount,pageSize:l,onPageChange:g,onPageSizeChange:o,onRefresh:()=>R(),emptyVariant:"default",emptyTitle:a("empty.title"),emptyDescription:a("empty.description"),emptyAction:e.jsxs(p,{onClick:()=>j(!0),children:[e.jsx(F,{className:"me-2 h-4 w-4"}),a("addClient")]}),actions:e.jsxs(p,{onClick:()=>j(!0),children:[e.jsx(F,{className:"me-2 h-4 w-4"}),a("addClient")]}),bulkActions:e.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>{const k=((h==null?void 0:h.items)??[]).find(G=>u.includes(G.id));k&&y(k)},children:[e.jsx(D,{className:"me-2 h-4 w-4"}),a("actions.delete")]})}),e.jsx(Ie,{open:r,onOpenChange:j}),e.jsx(Se,{open:!!v,onOpenChange:s=>{s||S(null)},client:v}),e.jsx(ie,{open:!!A,onOpenChange:()=>y(null),children:e.jsxs(le,{children:[e.jsxs(de,{children:[e.jsx(re,{children:a("delete.title")}),e.jsx(ce,{children:a("delete.description")})]}),e.jsxs(oe,{children:[e.jsx(me,{children:a("common:cancel")}),e.jsx(he,{onClick:O,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:a("delete.confirm")})]})]})})]})}export{Me as ClientsPage};
//# sourceMappingURL=index-BQtNmRgh.js.map
