import{j as e,h as J,l as fe,A as Ke,q as Qe,m as ve,n as X,o as Q,t as Ge,v as Xe,d as z,r as y,B as _,a as ce,p as Je,P as ne,X as ie,w as me,x as xe,y as ye,z as Ne}from"./index-3LWobmh4.js";import{a as We,R as be,D as Ze}from"./DataTableAdvanced-BaepryHP.js";import{D as es,a as ss,E as as,b as ls,c as oe,k as ts,T as Se,A as Ce,d as we,e as Ee,f as Pe,g as Te,h as ke,i as Ae,j as Le}from"./alert-dialog-C58uG3WD.js";import{P as ge}from"./PermissionGate-DepzuOZr.js";import{S as R,b as U,c as O,d as B,e as L,I as A}from"./select-DSHg5FKg.js";import{a as ns,b as is,u as pe,g as re}from"./index-e_Is6BP0.js";import{B as W,L as u}from"./label-C6xqjT5A.js";import{B as rs}from"./ban-CAM-JbPt.js";import{C as cs,E as ds}from"./eye-CeiYeXqo.js";import{D as os,a as us,b as hs,c as ms,d as xs,e as ps}from"./dialog-dlmPZOCs.js";import{C as S,a as C,b as P,c as w}from"./card-zP3Z4qZO.js";import{S as $}from"./skeleton-CkBj2wMt.js";import{a as Ie}from"./hooks-cDJzJ6Ki.js";import{F as he}from"./file-text-Y4nid_gy.js";import{U as js}from"./upload-DY_JWs3d.js";import{T as gs,a as fs,b as ae,c as le}from"./tabs-CAZbEoeM.js";import{P as vs}from"./pencil-DyyNSMRS.js";import{I as ys,V as Ns}from"./video-off-VkDlexKR.js";function Fe({value:s,onChange:n,disabled:t,placeholder:a="Select job category",showCode:h=!1,className:d,error:j,id:c,name:o}){const{data:l,isLoading:T,isError:N}=ns(),I=b=>{const k=l==null?void 0:l.find(p=>p.id===b);n==null||n(b,k)},g=l==null?void 0:l.find(b=>b.id===s);return T?e.jsx($,{className:"h-10 w-full"}):N?e.jsx(R,{disabled:!0,children:e.jsx(U,{className:d,children:e.jsx(O,{placeholder:"Failed to load categories"})})}):e.jsxs(R,{value:s,onValueChange:I,disabled:t,name:o,children:[e.jsx(U,{id:c,className:`${d} ${j?"border-red-500":""}`,children:e.jsx(O,{placeholder:a,children:g&&e.jsxs("span",{children:[h&&e.jsx("span",{className:"font-mono text-muted-foreground me-2",children:g.moHRECode}),g.nameEn]})})}),e.jsx(B,{children:l==null?void 0:l.map(b=>e.jsxs(L,{value:b.id,children:[h&&e.jsx("span",{className:"font-mono text-muted-foreground me-2",children:b.moHRECode}),b.nameEn]},b.id))})]})}function De({value:s,onChange:n,disabled:t,placeholder:a="Select nationality",commonOnly:h=!1,showFlag:d=!0,valueType:j="id",className:c,error:o,id:l,name:T}){const N=is(),I=pe(),{data:g,isLoading:b,isError:k}=h?N:I,p=m=>j==="name"?m.nameEn:m.id,v=m=>{const E=g==null?void 0:g.find(r=>p(r)===m);n==null||n(m,E)},f=g==null?void 0:g.find(m=>p(m)===s);return b?e.jsx($,{className:"h-10 w-full"}):k?e.jsx(R,{disabled:!0,children:e.jsx(U,{className:c,children:e.jsx(O,{placeholder:"Failed to load nationalities"})})}):e.jsxs(R,{value:s,onValueChange:v,disabled:t,name:T,children:[e.jsx(U,{id:l,className:`${c} ${o?"border-red-500":""}`,children:e.jsx(O,{placeholder:a,children:f&&e.jsxs("span",{className:"flex items-center gap-2",children:[d&&e.jsx("span",{className:"text-lg",children:re(f.code)}),e.jsx("span",{children:f.nameEn})]})})}),e.jsx(B,{children:g==null?void 0:g.map(m=>e.jsx(L,{value:p(m),children:e.jsxs("span",{className:"flex items-center gap-2",children:[d&&e.jsx("span",{className:"text-lg",children:re(m.code)}),e.jsx("span",{children:m.nameEn})]})},m.id))})]})}function M(s){return`/tenants/${fe()}${s}`}function bs(s){return J.getPaged(M("/candidates"),s)}function Ss(s,n){return J.get(M(`/candidates/${s}`),n)}function Cs(s){return J.post(M("/candidates"),s)}function ws(s,n){return J.patch(M(`/candidates/${s}`),n)}function Es(s,n){return J.post(M(`/candidates/${s}/status`),n)}function Ps(s){return J.delete(M(`/candidates/${s}`))}async function de(s,n,t){const a=fe(),h=new FormData;h.append("file",n);const d=Qe(),j=await fetch(`${Ke}${s}`,{method:"POST",headers:{...d?{Authorization:`Bearer ${d}`}:{},"X-Tenant-ID":a||""},body:h});if(!j.ok){const o=await j.json().catch(()=>({}));throw new Error(o.error||t)}const c=await j.json();return c.data??c}function Ts(s,n){return de(M(`/candidates/${s}/photo`),n,"Photo upload failed")}function ks(s,n){return de(M(`/candidates/${s}/video`),n,"Video upload failed")}function As(s,n){return de(M(`/candidates/${s}/passport`),n,"Passport upload failed")}function Ls(s,n){return de(M(`/files?fileType=${n}`),s,"File upload failed")}const H="candidates";function Is(s){return ve({queryKey:[H,s],queryFn:()=>bs({...s,include:"supplier"})})}function Re(s){return ve({queryKey:[H,s],queryFn:()=>Ss(s,{include:"statusHistory,supplier"}),enabled:!!s})}function Fs(){const s=X();return Q({mutationFn:n=>Cs(n),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Ds(){const s=X();return Q({mutationFn:({id:n,data:t})=>ws(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Rs(){const s=X();return Q({mutationFn:({id:n,data:t})=>Es(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Ue(){const s=X();return Q({mutationFn:n=>Ps(n),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Us(){const s=X();return Q({mutationFn:({id:n,file:t})=>Ts(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Os(){const s=X();return Q({mutationFn:({id:n,file:t})=>ks(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function $s(){const s=X();return Q({mutationFn:({id:n,file:t})=>As(n,t),onSuccess:()=>{s.invalidateQueries({queryKey:[H]})}})}function Bs(){return Q({mutationFn:({file:s,fileType:n})=>Ls(s,n)})}const Oe={Received:{variant:"secondary",icon:cs},UnderReview:{variant:"warning",icon:We},Approved:{variant:"success",icon:Xe},Rejected:{variant:"destructive",icon:Ge},Cancelled:{variant:"secondary",icon:rs}},_s=["Received","UnderReview","Approved","Rejected","Cancelled"],je=["Supplier","Local"],$e={Received:["UnderReview","Cancelled"],UnderReview:["Approved","Rejected","Cancelled"]},te=["Cooking","Cleaning","Childcare","Eldercare","Laundry","Ironing","Driving"],ue=["Arabic","English","Hindi","Urdu","Tagalog","Sinhala","Bengali","Nepali","Indonesian","Amharic"],Vs=["Basic","Intermediate","Advanced","Expert"],Ys=["Basic","Conversational","Fluent","Native"],Be=["Islam","Christianity","Hinduism","Buddhism","Other"],_e=["Single","Married","Divorced","Widowed"],Ve=["None","Primary","Secondary","HighSchool","Diploma","Bachelor","Master","PhD"];function ee({status:s,showIcon:n=!0,className:t}){const{t:a}=z("candidates"),h=Oe[s];if(!h)return e.jsx(W,{variant:"outline",children:s});const d=h.icon;return e.jsxs(W,{variant:h.variant,className:t,children:[n&&e.jsx(d,{className:"me-1 h-3 w-3"}),a(`status.${s}`)]})}const qs=["Rejected","Cancelled"];function Ye({open:s,onOpenChange:n,candidateId:t,currentStatus:a}){const{t:h}=z("candidates"),[d,j]=y.useState(""),[c,o]=y.useState(""),[l,T]=y.useState(""),N=Rs(),I=qs.includes(d),g=d&&(!I||c.trim()),b=$e[a]??[],k=async()=>{g&&(await N.mutateAsync({id:t,data:{status:d,reason:c.trim()||void 0,notes:l.trim()||void 0}}),j(""),o(""),T(""),n(!1))},p=v=>{v||(j(""),o(""),T("")),n(v)};return e.jsx(os,{open:s,onOpenChange:p,children:e.jsxs(us,{children:[e.jsxs(hs,{children:[e.jsx(ms,{children:h("transition.title")}),e.jsx(xs,{children:h("transition.description")})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:h("transition.currentStatus")}),e.jsx("div",{children:e.jsx(ee,{status:a})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:h("transition.targetStatus")}),e.jsxs(R,{value:d,onValueChange:j,children:[e.jsx(U,{children:e.jsx(O,{placeholder:h("transition.targetStatusPlaceholder")})}),e.jsx(B,{children:b.map(v=>e.jsx(L,{value:v,children:e.jsx(ee,{status:v})},v))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{children:[h("transition.reason"),I&&e.jsx("span",{className:"text-destructive",children:" *"})]}),e.jsx("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:h("transition.reasonPlaceholder"),value:c,onChange:v=>o(v.target.value)}),I&&!c.trim()&&e.jsx("p",{className:"text-sm text-destructive",children:h("transition.reasonRequired")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:h("transition.notes")}),e.jsx("textarea",{className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:h("transition.notesPlaceholder"),value:l,onChange:v=>T(v.target.value)})]})]}),e.jsxs(ps,{children:[e.jsx(_,{variant:"outline",onClick:()=>p(!1),children:h("common:cancel")}),e.jsx(_,{onClick:k,disabled:!g||N.isPending,children:N.isPending?h("transition.submitting"):h("transition.submit")})]})]})})}function ua(){const{t:s}=z("candidates"),n=ce(),{hasPermission:t}=Je(),[a,h]=y.useState(""),[d,j]=y.useState(1),[c,o]=y.useState(20),[l,T]=y.useState([]),[N,I]=y.useState(),[g,b]=y.useState(),[k,p]=y.useState(null),[v,f]=y.useState(null),m=y.useMemo(()=>({page:d,pageSize:c,search:a||void 0,sort:"-createdAt","filter[status]":N,"filter[sourceType]":g}),[d,c,a,N,g]),{data:E,isLoading:r,refetch:F}=Is(m),{data:i}=pe(),V=Ue(),Y=x=>{if(!x)return"—";const q=i==null?void 0:i.find(He=>He.code===x);return(q==null?void 0:q.nameEn)??x},K=async()=>{k&&(await V.mutateAsync(k.id),p(null))},se=[{key:"status",label:s("filters.status"),options:_s.map(x=>({label:s(`status.${x}`),value:x})),value:N},{key:"sourceType",label:s("filters.sourceType"),options:je.map(x=>({label:s(`sourceType.${x}`),value:x})),value:g}],G=(x,q)=>{x==="status"&&I(q),x==="sourceType"&&b(q),j(1)},Me=[{key:"name",header:s("columns.name"),cell:x=>e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[x.photoUrl?e.jsx("img",{src:x.photoUrl,alt:"",className:"h-8 w-8 rounded-full object-cover border shrink-0"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-xs font-medium shrink-0",children:x.fullNameEn.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:x.fullNameEn}),x.fullNameAr&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:x.fullNameAr})]})]})},{key:"nationality",header:s("columns.nationality"),cell:x=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[x.nationality&&e.jsx("span",{className:"text-lg leading-none",children:re(x.nationality)}),e.jsx("span",{children:Y(x.nationality)})]})},{key:"sourceType",header:s("columns.sourceType"),cell:x=>s(`sourceType.${x.sourceType}`)},{key:"supplier",header:s("columns.supplier"),cell:x=>{var q;return((q=x.supplier)==null?void 0:q.name)??"—"}},{key:"jobCategory",header:s("columns.jobCategory"),cell:x=>{var q;return((q=x.jobCategory)==null?void 0:q.name)??"—"}},{key:"status",header:s("columns.status"),cell:x=>e.jsx(ee,{status:x.status})},{key:"createdAt",header:s("columns.createdAt"),cell:x=>new Date(x.createdAt).toLocaleDateString()},{key:"actions",header:s("columns.actions"),className:"w-[70px]",cell:x=>e.jsxs(es,{children:[e.jsx(ss,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(as,{className:"h-4 w-4"})})}),e.jsxs(ls,{align:"end",children:[e.jsxs(oe,{onClick:()=>n(`/candidates/${x.id}`),children:[e.jsx(ds,{className:"me-2 h-4 w-4"}),s("actions.view")]}),t("candidates.manage_status")&&e.jsxs(oe,{onClick:()=>f(x),children:[e.jsx(be,{className:"me-2 h-4 w-4"}),s("actions.changeStatus")]}),t("candidates.delete")&&e.jsxs(e.Fragment,{children:[e.jsx(ts,{}),e.jsxs(oe,{className:"text-destructive",onClick:()=>p(x),children:[e.jsx(Se,{className:"me-2 h-4 w-4"}),s("actions.delete")]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("title")}),e.jsx("p",{className:"text-muted-foreground",children:s("description")})]}),e.jsx(Ze,{columns:Me,data:(E==null?void 0:E.items)??[],isLoading:r,selectable:!0,selectedIds:l,onSelectionChange:T,searchPlaceholder:s("searchPlaceholder"),searchValue:a,onSearchChange:x=>{h(x),j(1)},filters:se,onFilterChange:G,page:d,totalPages:E==null?void 0:E.totalPages,total:E==null?void 0:E.totalCount,pageSize:c,onPageChange:j,onPageSizeChange:o,onRefresh:()=>F(),emptyVariant:"default",emptyTitle:s("empty.title"),emptyDescription:s("empty.description"),emptyAction:e.jsx(ge,{permission:"candidates.create",children:e.jsxs(_,{onClick:()=>n("/candidates/new"),children:[e.jsx(ne,{className:"me-2 h-4 w-4"}),s("addCandidate")]})}),actions:e.jsx(ge,{permission:"candidates.create",children:e.jsxs(_,{onClick:()=>n("/candidates/new"),children:[e.jsx(ne,{className:"me-2 h-4 w-4"}),s("addCandidate")]})})}),v&&e.jsx(Ye,{open:!!v,onOpenChange:x=>{x||f(null)},candidateId:v.id,currentStatus:v.status}),e.jsx(Ce,{open:!!k,onOpenChange:()=>p(null),children:e.jsxs(we,{children:[e.jsxs(Ee,{children:[e.jsx(Pe,{children:s("deleteDialog.title")}),e.jsx(Te,{children:s("deleteDialog.description")})]}),e.jsxs(ke,{children:[e.jsx(Ae,{children:s("common:cancel")}),e.jsx(Le,{onClick:K,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("deleteDialog.confirm")})]})]})})]})}function qe({skills:s,onChange:n}){const{t}=z("candidates"),a=()=>{n([...s,{skillName:"",proficiencyLevel:"Basic"}])},h=c=>{n(s.filter((o,l)=>l!==c))},d=(c,o,l)=>{const T=s.map((N,I)=>I===c?{...N,[o]:l}:N);n(T)},j=new Set(s.map(c=>c.skillName));return e.jsxs("div",{className:"space-y-3",children:[s.map((c,o)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(R,{value:te.includes(c.skillName)?c.skillName:"__custom",onValueChange:l=>{l==="__custom"?d(o,"skillName",""):d(o,"skillName",l)},children:[e.jsx(U,{children:e.jsx(O,{placeholder:t("skills.selectSkill")})}),e.jsxs(B,{children:[te.filter(l=>!j.has(l)||l===c.skillName).map(l=>e.jsx(L,{value:l,children:t(`skills.presets.${l}`,l)},l)),e.jsx(L,{value:"__custom",children:t("skills.custom")})]})]})}),!te.includes(c.skillName)&&c.skillName!==""&&e.jsx(A,{className:"flex-1",value:c.skillName,onChange:l=>d(o,"skillName",l.target.value),placeholder:t("skills.customPlaceholder")}),!te.includes(c.skillName)&&c.skillName===""&&e.jsx(A,{className:"flex-1",value:"",onChange:l=>d(o,"skillName",l.target.value),placeholder:t("skills.customPlaceholder")}),e.jsx("div",{className:"w-40",children:e.jsxs(R,{value:c.proficiencyLevel,onValueChange:l=>d(o,"proficiencyLevel",l),children:[e.jsx(U,{children:e.jsx(O,{})}),e.jsx(B,{children:Vs.map(l=>e.jsx(L,{value:l,children:t(`skills.proficiency.${l}`,l)},l))})]})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>h(o),children:e.jsx(ie,{className:"h-4 w-4"})})]},o)),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:a,children:[e.jsx(ne,{className:"me-1 h-4 w-4"}),t("skills.add")]})]})}function ze({languages:s,onChange:n}){const{t}=z("candidates"),a=()=>{n([...s,{language:"",proficiencyLevel:"Basic"}])},h=c=>{n(s.filter((o,l)=>l!==c))},d=(c,o,l)=>{const T=s.map((N,I)=>I===c?{...N,[o]:l}:N);n(T)},j=new Set(s.map(c=>c.language));return e.jsxs("div",{className:"space-y-3",children:[s.map((c,o)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(R,{value:ue.includes(c.language)?c.language:"__custom",onValueChange:l=>{l==="__custom"?d(o,"language",""):d(o,"language",l)},children:[e.jsx(U,{children:e.jsx(O,{placeholder:t("languages.selectLanguage")})}),e.jsxs(B,{children:[ue.filter(l=>!j.has(l)||l===c.language).map(l=>e.jsx(L,{value:l,children:t(`languages.presets.${l}`,l)},l)),e.jsx(L,{value:"__custom",children:t("languages.custom")})]})]})}),!ue.includes(c.language)&&e.jsx(A,{className:"flex-1",value:c.language,onChange:l=>d(o,"language",l.target.value),placeholder:t("languages.customPlaceholder")}),e.jsx("div",{className:"w-40",children:e.jsxs(R,{value:c.proficiencyLevel,onValueChange:l=>d(o,"proficiencyLevel",l),children:[e.jsx(U,{children:e.jsx(O,{})}),e.jsx(B,{children:Ys.map(l=>e.jsx(L,{value:l,children:t(`languages.proficiency.${l}`,l)},l))})]})}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>h(o),children:e.jsx(ie,{className:"h-4 w-4"})})]},o)),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:a,children:[e.jsx(ne,{className:"me-1 h-4 w-4"}),t("languages.add")]})]})}function Z({accept:s,maxSizeMB:n,currentUrl:t,onUpload:a,isPending:h,type:d,mode:j="immediate",onFileSelected:c}){const{t:o}=z("candidates"),l=y.useRef(null),[T,N]=y.useState(""),[I,g]=y.useState(null),[b,k]=y.useState(null),p=async m=>{var r;const E=(r=m.target.files)==null?void 0:r[0];if(E){if(N(""),E.size>n*1024*1024){N(o("fileUpload.tooLarge",{max:n}));return}if(d==="photo"?g(URL.createObjectURL(E)):d==="document"&&k(E.name),j==="deferred"&&c)c(E);else try{await a(E)}catch(F){N(F instanceof Error?F.message:o("fileUpload.failed"))}l.current&&(l.current.value="")}},v=()=>{g(null),k(null),j==="deferred"&&c&&c(void 0)},f=I||t;return e.jsxs("div",{className:"space-y-2",children:[f&&d==="photo"&&e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:f,alt:"Preview",className:"h-32 w-32 rounded-lg object-cover border"}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-background shadow",onClick:v,children:e.jsx(ie,{className:"h-3 w-3"})})]}),f&&d==="video"&&e.jsx("video",{src:f,controls:!0,className:"h-48 max-w-full rounded-lg border"}),d==="document"&&(t||b)&&e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border p-3",children:[e.jsx(he,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("span",{className:"text-sm truncate flex-1",children:b||o("fileUpload.documentUploaded")}),t&&!b&&e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary hover:underline",children:o("fileUpload.viewDocument")}),e.jsx(_,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6",onClick:v,children:e.jsx(ie,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:l,type:"file",accept:s,className:"hidden",onChange:p}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",disabled:h,onClick:()=>{var m;return(m=l.current)==null?void 0:m.click()},children:[e.jsx(js,{className:"me-1 h-4 w-4"}),o(h?"fileUpload.uploading":t||b?"fileUpload.replace":"fileUpload.upload")]})]}),T&&e.jsx("p",{className:"text-sm text-destructive",children:T})]})}const zs={fullNameEn:"",fullNameAr:"",nationality:"",dateOfBirth:"",gender:"",passportNumber:"",passportExpiry:"",phone:"",email:"",sourceType:"",tenantSupplierId:"",religion:"",maritalStatus:"",educationLevel:"",jobCategoryId:"",experienceYears:"",monthlySalary:"",notes:"",externalReference:""};function ha(){var E;const{t:s}=z("candidates"),n=ce(),[t,a]=y.useState(zs),[h,d]=y.useState([]),[j,c]=y.useState([]),[o,l]=y.useState(null),[T,N]=y.useState(null),I=Fs(),g=Bs(),b=t.sourceType==="Supplier",{data:k}=Ie({pageSize:100}),p=(r,F)=>{a(i=>({...i,[r]:F}))},[v,f]=y.useState(!1),m=async r=>{if(r.preventDefault(),!(!t.fullNameEn.trim()||!t.sourceType)){f(!0);try{const F=h.filter(Y=>Y.skillName.trim()),i=j.filter(Y=>Y.language.trim()),V=await I.mutateAsync({fullNameEn:t.fullNameEn.trim(),fullNameAr:t.fullNameAr.trim()||void 0,nationality:t.nationality||void 0,dateOfBirth:t.dateOfBirth||void 0,gender:t.gender||void 0,passportNumber:t.passportNumber.trim()||void 0,passportExpiry:t.passportExpiry||void 0,phone:t.phone.trim()||void 0,email:t.email.trim()||void 0,sourceType:t.sourceType,tenantSupplierId:b&&t.tenantSupplierId?t.tenantSupplierId:void 0,religion:t.religion||void 0,maritalStatus:t.maritalStatus||void 0,educationLevel:t.educationLevel||void 0,jobCategoryId:t.jobCategoryId||void 0,experienceYears:t.experienceYears?parseInt(t.experienceYears):void 0,monthlySalary:t.monthlySalary?parseFloat(t.monthlySalary):void 0,skills:F.length>0?F:void 0,languages:i.length>0?i:void 0,photoFileId:o||void 0,passportFileId:T||void 0,notes:t.notes.trim()||void 0,externalReference:t.externalReference.trim()||void 0});n(`/candidates/${V.id}`)}catch(F){const i=F instanceof Error?F.message:"Failed to create candidate";ye.error(i)}finally{f(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:"/candidates",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("create.backToList")]}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("create.title")})]}),e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.personal")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"fullNameEn",children:[s("create.fullNameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(A,{id:"fullNameEn",value:t.fullNameEn,onChange:r=>p("fullNameEn",r.target.value),placeholder:s("create.fullNameEnPlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fullNameAr",children:s("create.fullNameAr")}),e.jsx(A,{id:"fullNameAr",value:t.fullNameAr,onChange:r=>p("fullNameAr",r.target.value),placeholder:s("create.fullNameArPlaceholder"),dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.nationality")}),e.jsx(De,{value:t.nationality,onChange:r=>p("nationality",r),placeholder:s("create.nationalityPlaceholder"),valueType:"name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"dateOfBirth",children:s("create.dateOfBirth")}),e.jsx(A,{id:"dateOfBirth",type:"date",value:t.dateOfBirth,onChange:r=>p("dateOfBirth",r.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.gender")}),e.jsxs(R,{value:t.gender,onValueChange:r=>p("gender",r),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.genderPlaceholder")})}),e.jsxs(B,{children:[e.jsx(L,{value:"Male",children:s("create.genderOptions.Male")}),e.jsx(L,{value:"Female",children:s("create.genderOptions.Female")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"passportNumber",children:s("create.passportNumber")}),e.jsx(A,{id:"passportNumber",value:t.passportNumber,onChange:r=>p("passportNumber",r.target.value),placeholder:s("create.passportNumberPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"passportExpiry",children:s("create.passportExpiry")}),e.jsx(A,{id:"passportExpiry",type:"date",value:t.passportExpiry,onChange:r=>p("passportExpiry",r.target.value)})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.contact")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone",children:s("create.phone")}),e.jsx(A,{id:"phone",value:t.phone,onChange:r=>p("phone",r.target.value),placeholder:s("create.phonePlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:s("create.email")}),e.jsx(A,{id:"email",type:"email",value:t.email,onChange:r=>p("email",r.target.value),placeholder:s("create.emailPlaceholder")})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.sourcing")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{children:[s("create.sourceType")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(R,{value:t.sourceType,onValueChange:r=>{p("sourceType",r),r!=="Supplier"&&p("tenantSupplierId","")},children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.sourceTypePlaceholder")})}),e.jsx(B,{children:je.map(r=>e.jsx(L,{value:r,children:s(`sourceType.${r}`)},r))})]})]}),b&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.supplier")}),e.jsxs(R,{value:t.tenantSupplierId,onValueChange:r=>p("tenantSupplierId",r),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.supplierPlaceholder")})}),e.jsx(B,{children:(E=k==null?void 0:k.items)==null?void 0:E.map(r=>{var F;return e.jsx(L,{value:r.id,children:((F=r.supplier)==null?void 0:F.nameEn)??r.id},r.id)})})]})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.professional")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.religion")}),e.jsxs(R,{value:t.religion,onValueChange:r=>p("religion",r),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.religionPlaceholder")})}),e.jsx(B,{children:Be.map(r=>e.jsx(L,{value:r,children:s(`professional.religion.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.maritalStatus")}),e.jsxs(R,{value:t.maritalStatus,onValueChange:r=>p("maritalStatus",r),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.maritalStatusPlaceholder")})}),e.jsx(B,{children:_e.map(r=>e.jsx(L,{value:r,children:s(`professional.maritalStatus.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.educationLevel")}),e.jsxs(R,{value:t.educationLevel,onValueChange:r=>p("educationLevel",r),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.educationLevelPlaceholder")})}),e.jsx(B,{children:Ve.map(r=>e.jsx(L,{value:r,children:s(`professional.educationLevel.${r}`,r)},r))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.jobCategory")}),e.jsx(Fe,{value:t.jobCategoryId,onChange:r=>p("jobCategoryId",r),placeholder:s("create.jobCategoryPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"experienceYears",children:s("create.experienceYears")}),e.jsx(A,{id:"experienceYears",type:"number",min:"0",max:"50",value:t.experienceYears,onChange:r=>p("experienceYears",r.target.value),placeholder:s("create.experienceYearsPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"monthlySalary",children:s("create.monthlySalary")}),e.jsx(A,{id:"monthlySalary",type:"number",min:"0",step:"0.01",value:t.monthlySalary,onChange:r=>p("monthlySalary",r.target.value),placeholder:s("create.monthlySalaryPlaceholder")})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.skills")})}),e.jsx(w,{children:e.jsx(qe,{skills:h,onChange:d})})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.languages")})}),e.jsx(w,{children:e.jsx(ze,{languages:j,onChange:c})})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.media")})}),e.jsxs(w,{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.photo")}),e.jsx(Z,{accept:"image/jpeg,image/png,image/webp",maxSizeMB:5,type:"photo",isPending:g.isPending,onUpload:async r=>{const F=await g.mutateAsync({file:r,fileType:"photo"});l(F.id)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.passport")}),e.jsx(Z,{accept:"application/pdf,image/jpeg,image/png",maxSizeMB:10,type:"document",isPending:g.isPending,onUpload:async r=>{const F=await g.mutateAsync({file:r,fileType:"passport"});N(F.id)}})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.additional")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"externalReference",children:s("create.externalReference")}),e.jsx(A,{id:"externalReference",value:t.externalReference,onChange:r=>p("externalReference",r.target.value),placeholder:s("create.externalReferencePlaceholder")})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(u,{htmlFor:"notes",children:s("create.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:t.notes,onChange:r=>p("notes",r.target.value),placeholder:s("create.notesPlaceholder")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>n("/candidates"),children:s("common:cancel")}),e.jsx(_,{type:"submit",disabled:!t.fullNameEn.trim()||!t.sourceType||v,children:s(v?"create.submitting":"create.submit")})]})]})]})}function Ms({history:s}){const{t:n}=z("candidates");if(!s||s.length===0)return null;const t=[...s].sort((a,h)=>new Date(h.changedAt).getTime()-new Date(a.changedAt).getTime());return e.jsx("div",{className:"space-y-4",children:t.map((a,h)=>{const d=Oe[a.toStatus],j=d==null?void 0:d.icon,c=h===t.length-1;return e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full border-2 bg-background",children:j&&e.jsx(j,{className:"h-4 w-4 text-muted-foreground"})}),h<t.length-1&&e.jsx("div",{className:"w-px flex-1 bg-border"})]}),e.jsxs("div",{className:"pb-6 pt-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:c&&!a.fromStatus?e.jsx("p",{className:"text-sm font-medium",children:n("timeline.initialStatus")}):e.jsxs("p",{className:"text-sm font-medium",children:[n("timeline.changedTo")," ",e.jsx(ee,{status:a.toStatus})]})}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:new Date(a.changedAt).toLocaleString()}),a.reason&&e.jsxs("p",{className:"mt-1 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"font-medium",children:[n("timeline.reason"),":"]})," ",a.reason]}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:a.notes})]})]},a.id)})})}function D({label:s,value:n}){return e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s}),e.jsx("p",{className:"font-medium",children:n!=null&&n!==""?String(n):"—"})]})}function Hs(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx($,{className:"h-4 w-32 mb-4"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"h-8 w-64"}),e.jsx($,{className:"h-6 w-24"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-9 w-32"}),e.jsx($,{className:"h-9 w-32"})]})]})]}),e.jsx($,{className:"h-10 w-96"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(S,{children:[e.jsx(C,{children:e.jsx($,{className:"h-6 w-40"})}),e.jsx(w,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:6}).map((s,n)=>e.jsxs("div",{children:[e.jsx($,{className:"h-4 w-24 mb-1"}),e.jsx($,{className:"h-5 w-40"})]},n))})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx($,{className:"h-6 w-36"})}),e.jsx(w,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:2}).map((s,n)=>e.jsxs("div",{children:[e.jsx($,{className:"h-4 w-24 mb-1"}),e.jsx($,{className:"h-5 w-40"})]},n))})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx($,{className:"h-6 w-36"})}),e.jsx(w,{className:"grid gap-4 sm:grid-cols-2",children:Array.from({length:3}).map((s,n)=>e.jsxs("div",{children:[e.jsx($,{className:"h-4 w-24 mb-1"}),e.jsx($,{className:"h-5 w-40"})]},n))})]})]})]})}function ma(){var k,p,v;const{t:s}=z("candidates"),{id:n}=Ne(),t=ce(),{data:a,isLoading:h}=Re(n),{data:d}=pe(),j=Ue(),[c,o]=y.useState(!1),[l,T]=y.useState(!1),N=f=>{if(!f)return;const m=d==null?void 0:d.find(E=>E.code===f||E.nameEn===f);return m?`${re(m.code)} ${m.nameEn}`:f},I=async()=>{n&&(await j.mutateAsync(n),t("/candidates"))};if(h)return e.jsx(Hs,{});if(!a)return e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("common:noResults")})});const g=a.status==="Received"||a.status==="UnderReview",b=(((k=$e[a.status])==null?void 0:k.length)??0)>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:"/candidates",className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("detail.backToList")]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.photoUrl&&e.jsx("img",{src:a.photoUrl,alt:a.fullNameEn,className:"h-12 w-12 rounded-full object-cover border"}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:a.fullNameEn}),e.jsx(ee,{status:a.status})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&e.jsxs(_,{variant:"outline",onClick:()=>t(`/candidates/${n}/edit`),children:[e.jsx(vs,{className:"me-2 h-4 w-4"}),s("actions.edit")]}),b&&e.jsxs(_,{variant:"outline",onClick:()=>o(!0),children:[e.jsx(be,{className:"me-2 h-4 w-4"}),s("actions.changeStatus")]}),e.jsxs(_,{variant:"destructive",onClick:()=>T(!0),children:[e.jsx(Se,{className:"me-2 h-4 w-4"}),s("actions.delete")]})]})]})]}),e.jsxs(gs,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(fs,{children:[e.jsx(ae,{value:"overview",children:s("tabs.overview")}),e.jsx(ae,{value:"professional",children:s("tabs.professional")}),e.jsx(ae,{value:"documentsOperations",children:s("tabs.documentsOperations")}),e.jsxs(ae,{value:"statusHistory",children:[s("tabs.statusHistory"),a.statusHistory&&e.jsx(W,{variant:"secondary",className:"ms-2",children:a.statusHistory.length})]})]}),e.jsx(le,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.personal")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(D,{label:s("detail.fullNameEn"),value:a.fullNameEn}),e.jsx(D,{label:s("detail.fullNameAr"),value:a.fullNameAr}),e.jsx(D,{label:s("detail.nationality"),value:N(a.nationality)}),e.jsx(D,{label:s("detail.dateOfBirth"),value:a.dateOfBirth}),e.jsx(D,{label:s("detail.gender"),value:a.gender}),e.jsx(D,{label:s("detail.passportNumber"),value:a.passportNumber}),e.jsx(D,{label:s("detail.passportExpiry"),value:a.passportExpiry})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.contact")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(D,{label:s("detail.phone"),value:a.phone}),e.jsx(D,{label:s("detail.email"),value:a.email})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.sourcing")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(D,{label:s("detail.sourceType"),value:s(`sourceType.${a.sourceType}`)}),e.jsx(D,{label:s("detail.supplier"),value:(p=a.supplier)==null?void 0:p.name}),e.jsx(D,{label:s("detail.externalReference"),value:a.externalReference})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.media")})}),e.jsx(w,{children:e.jsxs("div",{className:"grid gap-6 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.photo")}),a.photoUrl?e.jsx("img",{src:a.photoUrl,alt:a.fullNameEn,className:"h-40 w-40 rounded-lg object-cover border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(ys,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.video")}),a.videoUrl?e.jsx("video",{src:a.videoUrl,controls:!0,className:"h-40 max-w-full rounded-lg border"}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(Ns,{className:"h-8 w-8 text-muted-foreground/50"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s("detail.passportDocument")}),a.passportDocumentUrl?e.jsxs("a",{href:a.passportDocumentUrl,target:"_blank",rel:"noopener noreferrer",className:"h-40 w-40 rounded-lg border flex flex-col items-center justify-center gap-2 hover:bg-muted/50 transition-colors",children:[e.jsx(he,{className:"h-10 w-10 text-primary"}),e.jsx("span",{className:"text-sm text-primary font-medium",children:s("detail.viewPassportDocument")})]}):e.jsx("div",{className:"h-40 w-40 rounded-lg border border-dashed flex items-center justify-center bg-muted/30",children:e.jsx(he,{className:"h-8 w-8 text-muted-foreground/50"})})]})]})})]})]})}),e.jsx(le,{value:"professional",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.professionalProfile")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(D,{label:s("detail.religion"),value:a.religion?s(`professional.religion.${a.religion}`,a.religion):void 0}),e.jsx(D,{label:s("detail.maritalStatus"),value:a.maritalStatus?s(`professional.maritalStatus.${a.maritalStatus}`,a.maritalStatus):void 0}),e.jsx(D,{label:s("detail.educationLevel"),value:a.educationLevel?s(`professional.educationLevel.${a.educationLevel}`,a.educationLevel):void 0}),e.jsx(D,{label:s("detail.jobCategory"),value:(v=a.jobCategory)==null?void 0:v.name}),e.jsx(D,{label:s("detail.experienceYears"),value:a.experienceYears}),e.jsx(D,{label:s("detail.monthlySalary"),value:a.monthlySalary?`${a.monthlySalary} AED`:void 0})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.skills")})}),e.jsx(w,{children:a.skills&&a.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.skills.map(f=>e.jsxs(W,{variant:"outline",children:[f.skillName," — ",s(`skills.proficiency.${f.proficiencyLevel}`,f.proficiencyLevel)]},f.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.languages")})}),e.jsx(w,{children:a.languages&&a.languages.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.languages.map(f=>e.jsxs(W,{variant:"outline",children:[f.language," — ",s(`languages.proficiency.${f.proficiencyLevel}`,f.proficiencyLevel)]},f.id))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"—"})})]})]})}),e.jsx(le,{value:"documentsOperations",className:"space-y-6",children:e.jsx("div",{className:"grid gap-6 md:grid-cols-2",children:e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.operational")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(D,{label:s("detail.createdAt"),value:new Date(a.createdAt).toLocaleString()}),e.jsx(D,{label:s("detail.updatedAt"),value:new Date(a.updatedAt).toLocaleString()}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(D,{label:s("detail.notes"),value:a.notes})})]})]})})}),e.jsx(le,{value:"statusHistory",className:"space-y-6",children:a.statusHistory&&a.statusHistory.length>0?e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("detail.statusHistory")})}),e.jsx(w,{children:e.jsx(Ms,{history:a.statusHistory})})]}):e.jsx("div",{className:"flex items-center justify-center min-h-[20vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("detail.notAvailable")})})})]}),e.jsx(Ye,{open:c,onOpenChange:o,candidateId:a.id,currentStatus:a.status}),e.jsx(Ce,{open:l,onOpenChange:T,children:e.jsxs(we,{children:[e.jsxs(Ee,{children:[e.jsx(Pe,{children:s("deleteDialog.title")}),e.jsx(Te,{children:s("deleteDialog.description")})]}),e.jsxs(ke,{children:[e.jsx(Ae,{children:s("common:cancel")}),e.jsx(Le,{onClick:I,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:s("deleteDialog.confirm")})]})]})})]})}function xa(){var F;const{t:s}=z("candidates"),{id:n}=Ne(),t=ce(),{data:a,isLoading:h}=Re(n),d=Ds(),j=Us(),c=Os(),o=$s(),[l,T]=y.useState({fullNameEn:"",fullNameAr:"",nationality:"",dateOfBirth:"",gender:"",passportNumber:"",passportExpiry:"",phone:"",email:"",sourceType:"",tenantSupplierId:"",religion:"",maritalStatus:"",educationLevel:"",jobCategoryId:"",experienceYears:"",monthlySalary:"",notes:"",externalReference:""}),[N,I]=y.useState([]),[g,b]=y.useState([]),[k,p]=y.useState(!1),v=l.sourceType==="Supplier",{data:f}=Ie({pageSize:100});y.useEffect(()=>{var i,V,Y,K,se;a&&!k&&(T({fullNameEn:a.fullNameEn||"",fullNameAr:a.fullNameAr||"",nationality:a.nationality||"",dateOfBirth:a.dateOfBirth||"",gender:a.gender||"",passportNumber:a.passportNumber||"",passportExpiry:a.passportExpiry||"",phone:a.phone||"",email:a.email||"",sourceType:a.sourceType||"",tenantSupplierId:a.tenantSupplierId||"",religion:a.religion||"",maritalStatus:a.maritalStatus||"",educationLevel:a.educationLevel||"",jobCategoryId:((i=a.jobCategory)==null?void 0:i.id)||a.jobCategoryId||"",experienceYears:((V=a.experienceYears)==null?void 0:V.toString())||"",monthlySalary:((Y=a.monthlySalary)==null?void 0:Y.toString())||"",notes:a.notes||"",externalReference:a.externalReference||""}),I(((K=a.skills)==null?void 0:K.map(G=>({skillName:G.skillName,proficiencyLevel:G.proficiencyLevel})))??[]),b(((se=a.languages)==null?void 0:se.map(G=>({language:G.language,proficiencyLevel:G.proficiencyLevel})))??[]),p(!0))},[a,k]);const m=(i,V)=>{T(Y=>({...Y,[i]:V}))},E=async i=>{if(i.preventDefault(),!(!n||!l.fullNameEn.trim()))try{const V=N.filter(K=>K.skillName.trim()),Y=g.filter(K=>K.language.trim());await d.mutateAsync({id:n,data:{fullNameEn:l.fullNameEn.trim(),fullNameAr:l.fullNameAr.trim()||void 0,nationality:l.nationality||void 0,dateOfBirth:l.dateOfBirth||void 0,gender:l.gender||void 0,passportNumber:l.passportNumber.trim()||void 0,passportExpiry:l.passportExpiry||void 0,phone:l.phone.trim()||void 0,email:l.email.trim()||void 0,sourceType:l.sourceType||void 0,tenantSupplierId:v&&l.tenantSupplierId?l.tenantSupplierId:void 0,religion:l.religion||void 0,maritalStatus:l.maritalStatus||void 0,educationLevel:l.educationLevel||void 0,jobCategoryId:l.jobCategoryId||void 0,experienceYears:l.experienceYears?parseInt(l.experienceYears):void 0,monthlySalary:l.monthlySalary?parseFloat(l.monthlySalary):void 0,skills:V,languages:Y,notes:l.notes.trim()||void 0,externalReference:l.externalReference.trim()||void 0}}),t(`/candidates/${n}`)}catch(V){const Y=V instanceof Error?V.message:"Failed to update candidate";ye.error(Y)}};return h||!k?e.jsxs("div",{className:"space-y-6",children:[e.jsx($,{className:"h-4 w-32 mb-4"}),e.jsx($,{className:"h-8 w-64"}),e.jsx($,{className:"h-64 w-full"})]}):a?a.status==="Received"||a.status==="UnderReview"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(me,{to:`/candidates/${n}`,className:"inline-flex items-center gap-1 text-sm text-muted-foreground hover:text-foreground mb-4",children:[e.jsx(xe,{className:"h-4 w-4"}),s("edit.backToDetail")]}),e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:s("edit.title")})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.personal")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{htmlFor:"fullNameEn",children:[s("create.fullNameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(A,{id:"fullNameEn",value:l.fullNameEn,onChange:i=>m("fullNameEn",i.target.value),placeholder:s("create.fullNameEnPlaceholder"),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"fullNameAr",children:s("create.fullNameAr")}),e.jsx(A,{id:"fullNameAr",value:l.fullNameAr,onChange:i=>m("fullNameAr",i.target.value),placeholder:s("create.fullNameArPlaceholder"),dir:"rtl"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.nationality")}),e.jsx(De,{value:l.nationality,onChange:i=>m("nationality",i),placeholder:s("create.nationalityPlaceholder"),valueType:"name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"dateOfBirth",children:s("create.dateOfBirth")}),e.jsx(A,{id:"dateOfBirth",type:"date",value:l.dateOfBirth,onChange:i=>m("dateOfBirth",i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.gender")}),e.jsxs(R,{value:l.gender,onValueChange:i=>m("gender",i),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.genderPlaceholder")})}),e.jsxs(B,{children:[e.jsx(L,{value:"Male",children:s("create.genderOptions.Male")}),e.jsx(L,{value:"Female",children:s("create.genderOptions.Female")})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"passportNumber",children:s("create.passportNumber")}),e.jsx(A,{id:"passportNumber",value:l.passportNumber,onChange:i=>m("passportNumber",i.target.value),placeholder:s("create.passportNumberPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"passportExpiry",children:s("create.passportExpiry")}),e.jsx(A,{id:"passportExpiry",type:"date",value:l.passportExpiry,onChange:i=>m("passportExpiry",i.target.value)})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.contact")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone",children:s("create.phone")}),e.jsx(A,{id:"phone",value:l.phone,onChange:i=>m("phone",i.target.value),placeholder:s("create.phonePlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:s("create.email")}),e.jsx(A,{id:"email",type:"email",value:l.email,onChange:i=>m("email",i.target.value),placeholder:s("create.emailPlaceholder")})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.sourcing")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.sourceType")}),e.jsxs(R,{value:l.sourceType,onValueChange:i=>{m("sourceType",i),i!=="Supplier"&&m("tenantSupplierId","")},children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.sourceTypePlaceholder")})}),e.jsx(B,{children:je.map(i=>e.jsx(L,{value:i,children:s(`sourceType.${i}`)},i))})]})]}),v&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.supplier")}),e.jsxs(R,{value:l.tenantSupplierId,onValueChange:i=>m("tenantSupplierId",i),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.supplierPlaceholder")})}),e.jsx(B,{children:(F=f==null?void 0:f.items)==null?void 0:F.map(i=>{var V;return e.jsx(L,{value:i.id,children:((V=i.supplier)==null?void 0:V.nameEn)??i.id},i.id)})})]})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.professional")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.religion")}),e.jsxs(R,{value:l.religion,onValueChange:i=>m("religion",i),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.religionPlaceholder")})}),e.jsx(B,{children:Be.map(i=>e.jsx(L,{value:i,children:s(`professional.religion.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.maritalStatus")}),e.jsxs(R,{value:l.maritalStatus,onValueChange:i=>m("maritalStatus",i),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.maritalStatusPlaceholder")})}),e.jsx(B,{children:_e.map(i=>e.jsx(L,{value:i,children:s(`professional.maritalStatus.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.educationLevel")}),e.jsxs(R,{value:l.educationLevel,onValueChange:i=>m("educationLevel",i),children:[e.jsx(U,{children:e.jsx(O,{placeholder:s("create.educationLevelPlaceholder")})}),e.jsx(B,{children:Ve.map(i=>e.jsx(L,{value:i,children:s(`professional.educationLevel.${i}`,i)},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("create.jobCategory")}),e.jsx(Fe,{value:l.jobCategoryId,onChange:i=>m("jobCategoryId",i),placeholder:s("create.jobCategoryPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"experienceYears",children:s("create.experienceYears")}),e.jsx(A,{id:"experienceYears",type:"number",min:"0",max:"50",value:l.experienceYears,onChange:i=>m("experienceYears",i.target.value),placeholder:s("create.experienceYearsPlaceholder")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"monthlySalary",children:s("create.monthlySalary")}),e.jsx(A,{id:"monthlySalary",type:"number",min:"0",step:"0.01",value:l.monthlySalary,onChange:i=>m("monthlySalary",i.target.value),placeholder:s("create.monthlySalaryPlaceholder")})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.skills")})}),e.jsx(w,{children:e.jsx(qe,{skills:N,onChange:I})})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.languages")})}),e.jsx(w,{children:e.jsx(ze,{languages:g,onChange:b})})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("edit.sections.media")})}),e.jsxs(w,{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("edit.photo")}),e.jsx(Z,{accept:"image/jpeg,image/png,image/webp",maxSizeMB:5,currentUrl:a.photoUrl,onUpload:async i=>{await j.mutateAsync({id:n,file:i})},isPending:j.isPending,type:"photo"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("edit.video")}),e.jsx(Z,{accept:"video/mp4,video/webm",maxSizeMB:50,currentUrl:a.videoUrl,onUpload:async i=>{await c.mutateAsync({id:n,file:i})},isPending:c.isPending,type:"video"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:s("edit.passport")}),e.jsx(Z,{accept:"application/pdf,image/jpeg,image/png",maxSizeMB:10,currentUrl:a.passportDocumentUrl,onUpload:async i=>{await o.mutateAsync({id:n,file:i})},isPending:o.isPending,type:"document"})]})]})]}),e.jsxs(S,{children:[e.jsx(C,{children:e.jsx(P,{children:s("create.sections.additional")})}),e.jsxs(w,{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"externalReference",children:s("create.externalReference")}),e.jsx(A,{id:"externalReference",value:l.externalReference,onChange:i=>m("externalReference",i.target.value),placeholder:s("create.externalReferencePlaceholder")})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(u,{htmlFor:"notes",children:s("create.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l.notes,onChange:i=>m("notes",i.target.value),placeholder:s("create.notesPlaceholder")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>t(`/candidates/${n}`),children:s("common:cancel")}),e.jsx(_,{type:"submit",disabled:!l.fullNameEn.trim()||d.isPending,children:d.isPending?s("edit.submitting"):s("edit.submit")})]})]})]}):(t(`/candidates/${n}`),null):e.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:e.jsx("p",{className:"text-muted-foreground",children:s("common:noResults")})})}export{ma as CandidateDetailPage,ua as CandidatesPage,ha as CreateCandidatePage,xa as EditCandidatePage};
//# sourceMappingURL=index-DSHVG84q.js.map
