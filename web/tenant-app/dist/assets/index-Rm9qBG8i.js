import{c as D,d as C,r as x,j as e,B as p,p as J,P as I}from"./index-3LWobmh4.js";import{D as K}from"./DataTableAdvanced-BaepryHP.js";import{L as c,B as Q}from"./label-C6xqjT5A.js";import{D as W,a as X,E as Y,b as Z,c as N,k as ee,T as S,A as ae,d as se,e as te,f as ne,g as ie,h as le,i as de,j as re}from"./alert-dialog-C58uG3WD.js";import{P as A}from"./PermissionGate-DepzuOZr.js";import{u as ce,a as F,b as oe,c as me}from"./hooks-CGY2_KMm.js";import{S as w,a as T,b as M,c as z,d as L,e as B,P as he}from"./sheet-DYSTWhzn.js";import{I as o}from"./select-DSHg5FKg.js";import{M as xe}from"./mail-D_lj3mZN.js";import{P as ue}from"./pencil-DyyNSMRS.js";import"./skeleton-CkBj2wMt.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],pe=D("toggle-left",ge);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],ve=D("toggle-right",je),k={nameEn:"",nameAr:"",nationalId:"",phone:"",email:"",address:"",city:"",notes:""};function fe({open:n,onOpenChange:h}){const{t:s}=C("clients"),[a,u]=x.useState(k),l=ce(),r=(i,d)=>u(j=>({...j,[i]:d})),g=async i=>{i.preventDefault(),a.nameEn.trim()&&(await l.mutateAsync({nameEn:a.nameEn.trim(),nameAr:a.nameAr.trim()||void 0,nationalId:a.nationalId.trim()||void 0,phone:a.phone.trim()||void 0,email:a.email.trim()||void 0,address:a.address.trim()||void 0,city:a.city.trim()||void 0,notes:a.notes.trim()||void 0}),u(k),h(!1))};return e.jsx(w,{open:n,onOpenChange:h,children:e.jsx(T,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:g,className:"flex flex-col h-full",children:[e.jsxs(M,{children:[e.jsx(z,{children:s("add.title")}),e.jsx(L,{children:s("add.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(c,{htmlFor:"nameEn",children:[s("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{id:"nameEn",placeholder:s("add.nameEnPlaceholder"),value:a.nameEn,onChange:i=>r("nameEn",i.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"nameAr",children:s("add.nameAr")}),e.jsx(o,{id:"nameAr",placeholder:s("add.nameArPlaceholder"),value:a.nameAr,onChange:i=>r("nameAr",i.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"nationalId",children:s("add.nationalId")}),e.jsx(o,{id:"nationalId",placeholder:s("add.nationalIdPlaceholder"),value:a.nationalId,onChange:i=>r("nationalId",i.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"phone",children:s("add.phone")}),e.jsx(o,{id:"phone",type:"tel",placeholder:s("add.phonePlaceholder"),value:a.phone,onChange:i=>r("phone",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"email",children:s("add.email")}),e.jsx(o,{id:"email",type:"email",placeholder:s("add.emailPlaceholder"),value:a.email,onChange:i=>r("email",i.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"address",children:s("add.address")}),e.jsx(o,{id:"address",placeholder:s("add.addressPlaceholder"),value:a.address,onChange:i=>r("address",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"city",children:s("add.city")}),e.jsx(o,{id:"city",placeholder:s("add.cityPlaceholder"),value:a.city,onChange:i=>r("city",i.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"notes",children:s("add.notes")}),e.jsx("textarea",{id:"notes",className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:s("add.notesPlaceholder"),value:a.notes,onChange:i=>r("notes",i.target.value),rows:3})]})]}),e.jsxs(B,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>h(!1),children:s("common:cancel")}),e.jsx(p,{type:"submit",disabled:l.isPending||!a.nameEn.trim(),children:l.isPending?s("add.submitting"):s("add.submit")})]})]})})})}function ye({open:n,onOpenChange:h,client:s}){const{t:a}=C("clients"),u=F(),[l,r]=x.useState({nameEn:"",nameAr:"",nationalId:"",phone:"",email:"",city:""});x.useEffect(()=>{s&&r({nameEn:s.nameEn||"",nameAr:s.nameAr||"",nationalId:s.nationalId||"",phone:s.phone||"",email:s.email||"",city:s.city||""})},[s]);const g=(d,j)=>r(v=>({...v,[d]:j})),i=async d=>{d.preventDefault(),!(!s||!l.nameEn.trim())&&(await u.mutateAsync({id:s.id,data:{nameEn:l.nameEn.trim(),nameAr:l.nameAr.trim()||void 0,nationalId:l.nationalId.trim()||void 0,phone:l.phone.trim()||void 0,email:l.email.trim()||void 0,city:l.city.trim()||void 0}}),h(!1))};return e.jsx(w,{open:n,onOpenChange:h,children:e.jsx(T,{side:"right",className:"overflow-y-auto",children:e.jsxs("form",{onSubmit:i,className:"flex flex-col h-full",children:[e.jsxs(M,{children:[e.jsx(z,{children:a("edit.title")}),e.jsx(L,{children:a("edit.description")})]}),e.jsxs("div",{className:"grid gap-4 py-6 flex-1",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(c,{htmlFor:"editNameEn",children:[a("add.nameEn")," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{id:"editNameEn",placeholder:a("add.nameEnPlaceholder"),value:l.nameEn,onChange:d=>g("nameEn",d.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editNameAr",children:a("add.nameAr")}),e.jsx(o,{id:"editNameAr",placeholder:a("add.nameArPlaceholder"),value:l.nameAr,onChange:d=>g("nameAr",d.target.value),dir:"rtl"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editNationalId",children:a("add.nationalId")}),e.jsx(o,{id:"editNationalId",placeholder:a("add.nationalIdPlaceholder"),value:l.nationalId,onChange:d=>g("nationalId",d.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editPhone",children:a("add.phone")}),e.jsx(o,{id:"editPhone",type:"tel",placeholder:a("add.phonePlaceholder"),value:l.phone,onChange:d=>g("phone",d.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editEmail",children:a("add.email")}),e.jsx(o,{id:"editEmail",type:"email",placeholder:a("add.emailPlaceholder"),value:l.email,onChange:d=>g("email",d.target.value)})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"editCity",children:a("add.city")}),e.jsx(o,{id:"editCity",placeholder:a("add.cityPlaceholder"),value:l.city,onChange:d=>g("city",d.target.value)})]})]}),e.jsxs(B,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>h(!1),children:a("common:cancel")}),e.jsx(p,{type:"submit",disabled:u.isPending||!l.nameEn.trim(),children:u.isPending?a("edit.submitting"):a("edit.submit")})]})]})})})}function we(){const{t:n}=C("clients"),{hasPermission:h}=J(),[s,a]=x.useState(""),[u,l]=x.useState(1),[r,g]=x.useState(20),[i,d]=x.useState([]),[j,v]=x.useState(!1),[P,b]=x.useState(null),[y,f]=x.useState(null),_=x.useMemo(()=>({page:u,pageSize:r,search:s||void 0,sort:"-createdAt"}),[u,r,s]),{data:m,isLoading:q,refetch:R}=oe(_),H=F(),V=me(),$=async()=>{y&&(await V.mutateAsync(y.id),f(null))},G=async t=>{await H.mutateAsync({id:t.id,data:{isActive:!t.isActive}})},O=[{key:"name",header:n("columns.name"),cell:t=>e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:t.nameEn}),t.nameAr&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",dir:"rtl",children:t.nameAr})]})},{key:"nationalId",header:n("columns.nationalId"),cell:t=>e.jsx("span",{className:"text-sm",children:t.nationalId||"—"})},{key:"contact",header:n("columns.contact"),cell:t=>e.jsxs("div",{className:"flex flex-col gap-0.5 text-sm",children:[t.email?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate max-w-[180px]",children:t.email})]}):null,t.phone?e.jsxs("span",{className:"flex items-center gap-1.5 text-muted-foreground",children:[e.jsx(he,{className:"h-3 w-3"}),t.phone]}):null,!t.email&&!t.phone&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})]})},{key:"city",header:n("columns.city"),cell:t=>e.jsx("span",{className:"text-sm",children:t.city||"—"})},{key:"status",header:n("columns.status"),cell:t=>e.jsx(Q,{variant:t.isActive?"default":"secondary",children:n(`status.${t.isActive?"Active":"Inactive"}`)})},{key:"actions",header:n("columns.actions"),className:"w-[70px]",cell:t=>e.jsxs(W,{children:[e.jsx(X,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs(Z,{align:"end",children:[h("clients.edit")&&e.jsxs(N,{onClick:()=>b(t),children:[e.jsx(ue,{className:"me-2 h-4 w-4"}),n("actions.edit")]}),h("clients.edit")&&e.jsx(N,{onClick:()=>G(t),children:t.isActive?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"me-2 h-4 w-4"}),n("actions.deactivate")]}):e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"me-2 h-4 w-4"}),n("actions.activate")]})}),h("clients.delete")&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsxs(N,{className:"text-destructive",onClick:()=>f(t),children:[e.jsx(S,{className:"me-2 h-4 w-4"}),n("actions.delete")]})]})]})]})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:n("title")}),e.jsx("p",{className:"text-muted-foreground",children:n("description")})]}),e.jsx(K,{columns:O,data:(m==null?void 0:m.items)??[],isLoading:q,selectable:!0,selectedIds:i,onSelectionChange:d,searchPlaceholder:n("searchPlaceholder"),searchValue:s,onSearchChange:t=>{a(t),l(1)},page:u,totalPages:m==null?void 0:m.totalPages,total:m==null?void 0:m.totalCount,pageSize:r,onPageChange:l,onPageSizeChange:g,onRefresh:()=>R(),emptyVariant:"default",emptyTitle:n("empty.title"),emptyDescription:n("empty.description"),emptyAction:e.jsx(A,{permission:"clients.create",children:e.jsxs(p,{onClick:()=>v(!0),children:[e.jsx(I,{className:"me-2 h-4 w-4"}),n("addClient")]})}),actions:e.jsx(A,{permission:"clients.create",children:e.jsxs(p,{onClick:()=>v(!0),children:[e.jsx(I,{className:"me-2 h-4 w-4"}),n("addClient")]})}),bulkActions:e.jsx(A,{permission:"clients.delete",children:e.jsxs(p,{variant:"destructive",size:"sm",onClick:()=>{const E=((m==null?void 0:m.items)??[]).find(U=>i.includes(U.id));E&&f(E)},children:[e.jsx(S,{className:"me-2 h-4 w-4"}),n("actions.delete")]})})}),e.jsx(fe,{open:j,onOpenChange:v}),e.jsx(ye,{open:!!P,onOpenChange:t=>{t||b(null)},client:P}),e.jsx(ae,{open:!!y,onOpenChange:()=>f(null),children:e.jsxs(se,{children:[e.jsxs(te,{children:[e.jsx(ne,{children:n("delete.title")}),e.jsx(ie,{children:n("delete.description")})]}),e.jsxs(le,{children:[e.jsx(de,{children:n("common:cancel")}),e.jsx(re,{onClick:$,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:n("delete.confirm")})]})]})})]})}export{we as ClientsPage};
//# sourceMappingURL=index-Rm9qBG8i.js.map
